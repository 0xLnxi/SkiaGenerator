name: ç¼–è¯‘ Skia å¤šå¹³å°åŠ¨æ€åº“æ„å»ºåŒ…

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´ä¸Šåˆ8ç‚¹ï¼ˆUTCæ—¶é—´0ç‚¹ï¼‰æ‰§è¡Œä¸€æ¬¡
    - cron: '0 0 * * *'

# è®¾ç½®å·¥ä½œæµæƒé™
permissions:
  contents: write
  packages: write
  actions: read

jobs:
  build-skia:
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        include:
          # Windows x64æ¶æ„
          - os: windows-latest
            platform: x64_windows
            arch: x64
            target_os: win
            target_cpu: x64
            
          # Windows ARM64æ¶æ„
          - os: windows-latest
            platform: arm64_windows
            arch: arm64
            target_os: win
            target_cpu: arm64
            
          # macOS x64æ¶æ„
          - os: macos-latest
            platform: x64_macos
            arch: x64
            target_os: mac
            target_cpu: x64
            
          # macOS ARM64æ¶æ„
          - os: macos-latest
            platform: arm64_macos
            arch: arm64
            target_os: mac
            target_cpu: arm64
            
          # Linux x64æ¶æ„
          - os: ubuntu-latest
            platform: x64_linux
            arch: x64
            target_os: linux
            target_cpu: x64
            
          # Linux ARM64æ¶æ„
          - os: ubuntu-latest
            platform: arm64_linux
            arch: arm64
            target_os: linux
            target_cpu: arm64
            
          # Android x64æ¶æ„
          - os: ubuntu-latest
            platform: x64_android
            arch: x64
            target_os: android
            target_cpu: x64
            
          # Android ARM64æ¶æ„
          - os: ubuntu-latest
            platform: arm64_android
            arch: arm64
            target_os: android
            target_cpu: arm64

    steps:
    # æ£€å‡ºä»£ç ä»“åº“
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # è®¾ç½®Pythonè¿è¡Œç¯å¢ƒ
    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
        
    # å®‰è£…Linuxç³»ç»Ÿä¾èµ–åŒ…
    - name: å®‰è£…Linuxç³»ç»Ÿä¾èµ–
      if: runner.os == 'Linux'
      run: |
        sudo apt-get update
        # å®‰è£…åŸºç¡€æ„å»ºå·¥å…·
        sudo apt-get install -y build-essential ninja-build
        # å®‰è£…å›¾å½¢å’Œå­—ä½“ç›¸å…³ä¾èµ–
        sudo apt-get install -y libfontconfig1-dev libfreetype6-dev libgl1-mesa-dev
        # å®‰è£…Vulkanå¼€å‘åº“
        sudo apt-get install -y libvulkan-dev vulkan-tools
        # å®‰è£…å…¶ä»–å›¾å½¢åº“
        sudo apt-get install -y libxrandr-dev libxinerama-dev libxcursor-dev libxi-dev
        # å®‰è£…ICUå’ŒHarfBuzz
        sudo apt-get install -y libicu-dev libharfbuzz-dev
        # å¦‚æœæ˜¯ARM64å¹³å°ï¼Œå®‰è£…äº¤å‰ç¼–è¯‘å·¥å…·é“¾
        if [ "${{ matrix.target_cpu }}" = "arm64" ] && [ "${{ matrix.target_os }}" = "linux" ]; then
          sudo apt-get install -y gcc-aarch64-linux-gnu g++-aarch64-linux-gnu
        fi
        
    # å®‰è£…macOSç³»ç»Ÿä¾èµ–
    - name: å®‰è£…macOSç³»ç»Ÿä¾èµ–
      if: runner.os == 'macOS'
      run: |
        # å®‰è£…Xcodeå‘½ä»¤è¡Œå·¥å…·
        xcode-select --install 2>/dev/null || true
        # å®‰è£…ninjaæ„å»ºå·¥å…·
        brew install ninja || true
        echo "ä½¿ç”¨Skiaå†…ç½®çš„ä¾èµ–åº“"
        
    # å®‰è£…Windowsç³»ç»Ÿä¾èµ–
    - name: å®‰è£…Windowsç³»ç»Ÿä¾èµ–
      if: runner.os == 'Windows'
      run: |
        # å®‰è£…ninjaæ„å»ºå·¥å…·
        choco install ninja -y
        
    # è®¾ç½®Android NDKç¯å¢ƒï¼ˆä»…é™Androidå¹³å°ï¼‰
    - name: è®¾ç½®Android NDK
      if: matrix.target_os == 'android'
      uses: nttld/setup-ndk@v1
      with:
        ndk-version: r25c
        
    # è·å–Googleçš„depot_toolså·¥å…·é›†
    - name: è·å–depot_tools
      run: |
        git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git
        echo "${{ github.workspace }}/depot_tools" >> $GITHUB_PATH
      shell: bash
      
    # è®¾ç½®Windowsç³»ç»Ÿçš„depot_toolsç¯å¢ƒå˜é‡
    - name: è®¾ç½®depot_toolsç¯å¢ƒå˜é‡
      if: runner.os == 'Windows'
      run: |
        echo "${{ github.workspace }}\depot_tools" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append
        # ç¦ç”¨depot_toolsè‡ªåŠ¨ä¸‹è½½å·¥å…·é“¾
        echo "DEPOT_TOOLS_WIN_TOOLCHAIN=0" | Out-File -FilePath $env:GITHUB_ENV -Encoding utf8 -Append
        
    # è·å–Skiaæºä»£ç å¹¶åŒæ­¥ä¾èµ–
    - name: è·å–Skiaæºä»£ç 
      run: |
        git clone https://skia.googlesource.com/skia.git
        cd skia
        python tools/git-sync-deps
      shell: bash
      
    # é…ç½®å„å¹³å°çš„æ„å»ºå‚æ•°
    - name: é…ç½®æ„å»ºå‚æ•°
      run: |
        cd skia
        
        # åŸºç¡€æ„å»ºå‚æ•°è®¾ç½® - å¯ç”¨å…¨é‡åŠŸèƒ½å¹¶ç”ŸæˆåŠ¨æ€åº“
        args="is_official_build=true"
        args="$args is_component_build=true"
        args="$args skia_use_system_expat=false"
        args="$args skia_use_system_icu=false"
        args="$args skia_use_system_libjpeg_turbo=false"
        args="$args skia_use_system_libpng=false"
        args="$args skia_use_system_libwebp=false"
        args="$args skia_use_system_zlib=false"
        
        # å¯ç”¨æ ¸å¿ƒåŠŸèƒ½æ”¯æŒï¼Œä½¿ç”¨å†…ç½®ä¾èµ–åº“
        args="$args skia_enable_pdf=true"
        args="$args skia_enable_skshaper=true"
        args="$args skia_enable_svg=true"
        args="$args skia_use_icu=true"
        
        # å¯ç”¨GPUåç«¯æ”¯æŒ
        args="$args skia_enable_gpu=true"
        args="$args skia_use_gl=true"
        args="$args skia_use_vulkan=true"
        args="$args skia_enable_spirv_validation=false"
        
        # ç¦ç”¨å·¥å…·æ„å»ºä»¥é¿å…æµ‹è¯•å·¥å…·APIé—®é¢˜
        args="$args skia_enable_tools=false"
        
        # è®¾ç½®ç›®æ ‡å¹³å°å’Œæ¶æ„
        args="$args target_os=\"${{ matrix.target_os }}\""
        args="$args target_cpu=\"${{ matrix.target_cpu }}\""
        
        # æ ¹æ®ä¸åŒå¹³å°è®¾ç½®ç‰¹å®šå‚æ•°
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°ç‰¹å®šé…ç½® - ç¦ç”¨æœ‰é—®é¢˜çš„æ¨¡å—
            args="$args skia_use_angle=true"
            args="$args skia_use_direct3d=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=false"
            args="$args skia_use_piex=false"
            args="$args skia_enable_skottie=true"
            if [ "${{ matrix.target_cpu }}" = "arm64" ]; then
              args="$args target_cpu=\"arm64\""
            fi
            ;;
          "mac")
            # macOSå¹³å°ç‰¹å®šé…ç½® - ç¦ç”¨Skottieä»¥é¿å…é“¾æ¥é—®é¢˜
            args="$args skia_use_metal=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_fontconfig=false"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_pdf_subset_harfbuzz=true"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            # åœ¨macOSä¸Šæš‚æ—¶ç¦ç”¨Skottieé¿å…é“¾æ¥é—®é¢˜
            args="$args skia_enable_skottie=false"
            if [ "${{ matrix.target_cpu }}" = "arm64" ]; then
              args="$args target_cpu=\"arm64\""
            fi
            ;;
          "linux")
            # Linuxå¹³å°ç‰¹å®šé…ç½®
            args="$args skia_use_x11=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_fontconfig=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            args="$args skia_enable_skottie=true"
            if [ "${{ matrix.target_cpu }}" = "arm64" ]; then
              args="$args cc=\"aarch64-linux-gnu-gcc\""
              args="$args cxx=\"aarch64-linux-gnu-g++\""
              args="$args ar=\"aarch64-linux-gnu-ar\""
              args="$args skia_use_system_freetype2=false"
              args="$args skia_use_system_harfbuzz=false"
            else
              args="$args skia_use_system_freetype2=true"
              args="$args skia_use_system_harfbuzz=true"
            fi
            ;;
          "android")
            # Androidå¹³å°ç‰¹å®šé…ç½®
            args="$args ndk=\"$ANDROID_NDK_ROOT\""
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_freetype=true"
            args="$args skia_enable_fontmgr_android=true"
            args="$args skia_use_vulkan=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            args="$args skia_enable_skottie=true"
            ;;
        esac
        
        echo "æ„å»ºå‚æ•°: $args"
        echo "BUILD_ARGS=$args" >> $GITHUB_ENV
      shell: bash
      
    # ä½¿ç”¨GNç”Ÿæˆæ„å»ºæ–‡ä»¶
    - name: ç”Ÿæˆæ„å»ºæ–‡ä»¶
      run: |
        cd skia
        bin/gn gen out/Release --args="$BUILD_ARGS"
      shell: bash
      
    # ä½¿ç”¨Ninjaç¼–è¯‘Skia
    - name: ç¼–è¯‘Skia
      run: |
        cd skia
        ninja -C out/Release
      shell: bash
      
    # åˆ›å»ºå‘å¸ƒåŒ…å¹¶æ•´ç†æ–‡ä»¶
    - name: åˆ›å»ºå‘å¸ƒåŒ…
      run: |
        cd skia
        
        # åˆ›å»ºè¾“å‡ºç›®å½•ç»“æ„
        mkdir -p package/include
        mkdir -p package/lib
        mkdir -p package/bin
        mkdir -p package/docs
        mkdir -p package/examples
        
        # å¤åˆ¶å¤´æ–‡ä»¶åˆ°åŒ…ç›®å½•
        cp -r include/* package/include/
        
        # å¤åˆ¶æ¨¡å—ç›¸å…³å¤´æ–‡ä»¶
        if [ -d "modules" ]; then
          mkdir -p package/include/modules
          cp -r modules/*/include/* package/include/modules/ 2>/dev/null || true
        fi
        
        # æ ¹æ®ä¸åŒå¹³å°å¤åˆ¶ç›¸åº”çš„åº“æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°æ–‡ä»¶å¤åˆ¶ - é™æ€åº“åˆ°libï¼ŒåŠ¨æ€åº“åˆ°bin
            find out/Release -name "*.lib" -exec cp {} package/lib/ \; 2>/dev/null || true
            find out/Release -name "*.dll" -exec cp {} package/bin/ \; 2>/dev/null || true
            find out/Release -name "*.exe" -exec cp {} package/bin/ \; 2>/dev/null || true
            ;;
          "mac")
            # macOSå¹³å°æ–‡ä»¶å¤åˆ¶ - é™æ€åº“åˆ°libï¼ŒåŠ¨æ€åº“åˆ°bin
            find out/Release -name "*.a" -exec cp {} package/lib/ \; 2>/dev/null || true
            find out/Release -name "*.dylib" -exec cp {} package/bin/ \; 2>/dev/null || true
            find out/Release -type f -perm +111 -name "*" -not -name "*.so" -not -name "*.dylib" -exec cp {} package/bin/ \; 2>/dev/null || true
            ;;
          "linux"|"android")
            # Linuxå’ŒAndroidå¹³å°æ–‡ä»¶å¤åˆ¶ - é™æ€åº“åˆ°libï¼ŒåŠ¨æ€åº“åˆ°bin
            find out/Release -name "*.a" -exec cp {} package/lib/ \; 2>/dev/null || true
            find out/Release -name "*.so" -exec cp {} package/bin/ \; 2>/dev/null || true
            find out/Release -type f -perm +111 -name "*" -not -name "*.so" -exec cp {} package/bin/ \; 2>/dev/null || true
            ;;
        esac
        
        # å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
        if [ -d "resources" ]; then
          cp -r resources/* package/examples/ 2>/dev/null || true
        fi
        
        # åˆ›å»ºæ„å»ºä¿¡æ¯æ–‡ä»¶
        cat > package/BUILD_INFO.txt << EOF
        Skia åŠ¨æ€åº“æ„å»ºä¿¡æ¯
        ==================
        å¹³å°: ${{ matrix.target_os }}
        æ¶æ„: ${{ matrix.target_cpu }}
        åŒ…å: ${{ matrix.platform }}
        æ„å»ºæ¨¡å¼: Release (å®˜æ–¹åŠ¨æ€åº“æ„å»º)
        
        æ”¯æŒçš„åŠŸèƒ½:
        - GPUæ¸²æŸ“ (OpenGL + Vulkan)
        - PDFå¯¼å‡º (å†…ç½®HarfBuzz)
        - SVGæ”¯æŒ
        - æ–‡æœ¬æ•´å½¢ (å†…ç½®HarfBuzz)
        - å­—ä½“ç®¡ç† (å†…ç½®FreeType)
        - å›¾åƒç¼–è§£ç 
        
        å›¾å½¢åç«¯:
        - OpenGL/OpenGL ES
        - Vulkan
        - Metal (ä»…macOS)
        - Direct3D (ä»…Windows)
        
        åŠ¨æ€åº“è¯´æ˜:
        - åŠ¨æ€åº“ä½äº bin/ ç›®å½•
        - é™æ€åº“ä½äº lib/ ç›®å½•
        - CMakeé»˜è®¤é“¾æ¥åŠ¨æ€åº“
        - ä½¿ç”¨å†…ç½®ä¾èµ–é¿å…ç³»ç»Ÿåº“å†²çª
        
        å¹³å°ç‰¹æ®Šè¯´æ˜:
        - macOSå¹³å°ä¸ºé¿å…é“¾æ¥é—®é¢˜æš‚æ—¶ç¦ç”¨äº†Skottieæ¨¡å—
        - å…¶ä»–å¹³å°æ”¯æŒå®Œæ•´åŠŸèƒ½åŒ…æ‹¬SkottieåŠ¨ç”»
        - æ‰€æœ‰å¹³å°éƒ½æ”¯æŒæ ¸å¿ƒ2Dæ¸²æŸ“å’ŒGPUåŠ é€Ÿ
        EOF
        
        # åˆ›å»ºä½¿ç”¨è¯´æ˜æ–‡ä»¶
        cat > package/README.md << EOF
        # Skia åŠ¨æ€åº“æ„å»ºåŒ… - ${{ matrix.platform }}

        è¿™æ˜¯Skiaå›¾å½¢åº“çš„åŠ¨æ€åº“é¢„ç¼–è¯‘æ„å»ºåŒ…ï¼ŒåŒ…å«æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ã€‚

        ## åŒ…å«å†…å®¹

        - include/ - å®Œæ•´çš„Skia C++ APIå¤´æ–‡ä»¶
        - lib/ - é™æ€åº“æ–‡ä»¶ï¼ˆå¤‡ç”¨ï¼‰
        - bin/ - åŠ¨æ€åº“æ–‡ä»¶ï¼ˆä¸»è¦ä½¿ç”¨ï¼‰
        - examples/ - ç¤ºä¾‹èµ„æºæ–‡ä»¶
        - BUILD_INFO.txt - è¯¦ç»†æ„å»ºä¿¡æ¯
        - CMakeLists.txt - CMakeé…ç½®æ–‡ä»¶ï¼Œé»˜è®¤é“¾æ¥åŠ¨æ€åº“

        ## åŠ¨æ€åº“ç‰¹æ€§

        ### åŠ¨æ€åº“ä½ç½®
        - Windows: bin/*.dll
        - macOS: bin/*.dylib  
        - Linux: bin/*.so
        - Android: bin/*.so

        ### ä¼˜åŠ¿
        - æ›´å°çš„å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯
        - ä¾¿äºåº“æ›´æ–°å’Œç»´æŠ¤
        - æ”¯æŒå¤šä¸ªç¨‹åºå…±äº«åŒä¸€åº“
        - å‡å°‘å†…å­˜å ç”¨

        ## æ”¯æŒçš„åŠŸèƒ½

        æ­¤åŠ¨æ€åº“æ„å»ºåŒ…å«Skiaçš„æ ¸å¿ƒåŠŸèƒ½ï¼š
        
        ### æ ¸å¿ƒæ¸²æŸ“åŠŸèƒ½
        - 2Dç»˜å›¾å’Œè·¯å¾„æ¸²æŸ“
        - å›¾åƒå¤„ç†å’Œæ»¤é•œæ•ˆæœ
        - GPUåŠ é€Ÿæ¸²æŸ“
        - å¤šçº¿ç¨‹æ¸²æŸ“æ”¯æŒ
        
        ### å›¾å½¢åç«¯
        - OpenGL/OpenGL ES
        - Vulkan
        - Metal (macOS)
        - Direct3D (Windows)
        
        ### é«˜çº§åŠŸèƒ½
        - PDFæ–‡æ¡£ç”Ÿæˆå’Œå¯¼å‡º
        - SVGçŸ¢é‡å›¾å½¢æ”¯æŒ
        - å¤æ‚æ–‡æœ¬å¸ƒå±€å’Œæ•´å½¢
        - å¤šç§å­—ä½“æ ¼å¼æ”¯æŒ
        - å®Œæ•´çš„å›¾åƒç¼–è§£ç å™¨
        
        ### åŠ¨ç”»åŠŸèƒ½
        - Skottie LottieåŠ¨ç”»ï¼ˆé™¤macOSå¤–ï¼‰
        - macOSå¹³å°æš‚æ—¶ä¸æ”¯æŒSkottieä»¥ç¡®ä¿æ„å»ºç¨³å®šæ€§

        ## CMakeä½¿ç”¨æ–¹æ³•

        1. å°†æ­¤åŒ…è§£å‹åˆ°ä½ çš„é¡¹ç›®ç›®å½•ä¸­
        2. åœ¨ä½ çš„CMakeLists.txtä¸­æ·»åŠ ï¼š
           \`\`\`cmake
           add_subdirectory(path/to/skia)
           target_link_libraries(your_target skia::skia)
           \`\`\`

        ### CMakeè‡ªåŠ¨é…ç½®
        - è‡ªåŠ¨é“¾æ¥binç›®å½•ä¸­çš„åŠ¨æ€åº“
        - è‡ªåŠ¨è®¾ç½®è¿è¡Œæ—¶åº“è·¯å¾„
        - è·¨å¹³å°åº“æ–‡ä»¶æ ¼å¼è‡ªåŠ¨é€‚é…

        ## å¹³å°ç‰¹æ®Šè¯´æ˜

        ### macOSå¹³å°
        - ä¸ºç¡®ä¿æ„å»ºç¨³å®šæ€§ï¼Œæš‚æ—¶ç¦ç”¨äº†SkottieåŠ¨ç”»æ¨¡å—
        - æ”¯æŒæ‰€æœ‰å…¶ä»–åŠŸèƒ½åŒ…æ‹¬Metal GPUæ¸²æŸ“
        - å¦‚éœ€Skottieæ”¯æŒï¼Œè¯·ä½¿ç”¨å…¶ä»–å¹³å°æˆ–è‡ªè¡Œç¼–è¯‘

        ### å…¶ä»–å¹³å°
        - æ”¯æŒå®Œæ•´åŠŸèƒ½åŒ…æ‹¬SkottieåŠ¨ç”»
        - æä¾›æœ€ä½³çš„åŠŸèƒ½å®Œæ•´æ€§

        ## å¹³å°ä¿¡æ¯

        - ç›®æ ‡æ“ä½œç³»ç»Ÿ: ${{ matrix.target_os }}
        - ç›®æ ‡æ¶æ„: ${{ matrix.target_cpu }}
        - å›¾å½¢API: OpenGL + Vulkan
        - åº“ç±»å‹: åŠ¨æ€åº“ï¼ˆé¦–é€‰ï¼‰+ é™æ€åº“ï¼ˆå¤‡ç”¨ï¼‰
        
        ## éƒ¨ç½²å»ºè®®
        
        ### å¼€å‘é˜¶æ®µ
        - ä½¿ç”¨åŠ¨æ€åº“ä¾¿äºè°ƒè¯•å’Œå¿«é€Ÿè¿­ä»£
        - ç¡®ä¿åŠ¨æ€åº“è·¯å¾„æ­£ç¡®é…ç½®
        
        ### ç”Ÿäº§éƒ¨ç½²
        - å°†åŠ¨æ€åº“ä¸åº”ç”¨ç¨‹åºä¸€èµ·åˆ†å‘
        - é…ç½®æ­£ç¡®çš„åº“æœç´¢è·¯å¾„
        - è€ƒè™‘ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜
        EOF
        
      shell: bash
      
    # ç”ŸæˆCMakeLists.txtæ–‡ä»¶
    - name: ç”ŸæˆCMakeLists.txt
      run: |
        cd skia/package
        
        # ç”ŸæˆCMakeLists.txtæ–‡ä»¶
        cat > CMakeLists.txt << 'EOF'
        # SkiaåŠ¨æ€åº“çš„CMakeé…ç½®æ–‡ä»¶
        cmake_minimum_required(VERSION 3.15)
        
        # è®¾ç½®é¡¹ç›®ä¿¡æ¯
        project(SkiaPrebuilt
            VERSION 1.0.0
            DESCRIPTION "SkiaåŠ¨æ€åº“é¢„ç¼–è¯‘åŒ…"
            LANGUAGES CXX C
        )
        
        # è®¾ç½®C++æ ‡å‡†
        set(CMAKE_CXX_STANDARD 17)
        set(CMAKE_CXX_STANDARD_REQUIRED ON)
        
        # è·å–å½“å‰ç›®å½•
        get_filename_component(SKIA_ROOT_DIR "${CMAKE_CURRENT_LIST_DIR}" ABSOLUTE)
        
        # åˆ›å»ºskia::skiaæ¥å£åº“
        add_library(skia INTERFACE)
        add_library(skia::skia ALIAS skia)
        
        # è®¾ç½®åŒ…å«ç›®å½•
        target_include_directories(skia INTERFACE
            $<BUILD_INTERFACE:${SKIA_ROOT_DIR}/include>
            $<BUILD_INTERFACE:${SKIA_ROOT_DIR}/include/modules>
            $<INSTALL_INTERFACE:include>
            $<INSTALL_INTERFACE:include/modules>
        )
        
        # æŸ¥æ‰¾åŠ¨æ€åº“æ–‡ä»¶ï¼ˆä¼˜å…ˆä½¿ç”¨ï¼‰
        if(WIN32)
            file(GLOB SKIA_DYNAMIC_LIBRARIES "${SKIA_ROOT_DIR}/bin/*.dll")
            file(GLOB SKIA_IMPORT_LIBRARIES "${SKIA_ROOT_DIR}/lib/*.lib")
        elseif(APPLE)
            file(GLOB SKIA_DYNAMIC_LIBRARIES "${SKIA_ROOT_DIR}/bin/*.dylib")
        else()
            file(GLOB SKIA_DYNAMIC_LIBRARIES "${SKIA_ROOT_DIR}/bin/*.so")
        endif()
        
        # æŸ¥æ‰¾é™æ€åº“æ–‡ä»¶ï¼ˆå¤‡ç”¨ï¼‰
        file(GLOB SKIA_STATIC_LIBRARIES "${SKIA_ROOT_DIR}/lib/*")
        
        # æ ¹æ®å¹³å°è®¾ç½®ç‰¹å®šçš„é“¾æ¥åº“å’Œç¼–è¯‘é€‰é¡¹
        if(WIN32)
            # Windowså¹³å°é…ç½®
            target_compile_definitions(skia INTERFACE
                SK_GANESH=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_WIN=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                UNICODE
                _UNICODE
            )
            
            # Windowsä¼˜å…ˆä½¿ç”¨åŠ¨æ€åº“ï¼ˆDLL + å¯¼å…¥åº“ï¼‰
            if(SKIA_DYNAMIC_LIBRARIES AND SKIA_IMPORT_LIBRARIES)
                target_link_libraries(skia INTERFACE ${SKIA_IMPORT_LIBRARIES})
                set_target_properties(skia PROPERTIES
                    INTERFACE_LINK_DIRECTORIES "${SKIA_ROOT_DIR}/bin"
                )
                message(STATUS "ä½¿ç”¨SkiaåŠ¨æ€åº“: ${SKIA_DYNAMIC_LIBRARIES}")
            else()
                target_link_libraries(skia INTERFACE ${SKIA_STATIC_LIBRARIES})
                message(STATUS "ä½¿ç”¨Skiaé™æ€åº“: ${SKIA_STATIC_LIBRARIES}")
            endif()
            
            # æ·»åŠ Windowsç³»ç»Ÿåº“
            target_link_libraries(skia INTERFACE
                OpenGL32 d3d11 dxgi d3dcompiler
                Gdi32 User32 Kernel32 Ole32 OleAut32 Uuid Advapi32 Shell32 Usp10 Ws2_32
            )
            
        elseif(APPLE)
            # macOSå¹³å°é…ç½®
            target_compile_definitions(skia INTERFACE
                SK_GANESH=1
                SK_METAL=1
                SK_GL=1
                SK_VULKAN=1
                SK_BUILD_FOR_MAC=1
                SK_ENABLE_SVG=1
                # æ³¨æ„ï¼šmacOSç‰ˆæœ¬æš‚ä¸æ”¯æŒSkottie
            )
            
            # macOSä¼˜å…ˆä½¿ç”¨åŠ¨æ€åº“
            if(SKIA_DYNAMIC_LIBRARIES)
                target_link_libraries(skia INTERFACE ${SKIA_DYNAMIC_LIBRARIES})
                target_link_options(skia INTERFACE 
                    "-Wl,-rpath,${SKIA_ROOT_DIR}/bin"
                    "-Wl,-rpath,@loader_path"
                )
                message(STATUS "ä½¿ç”¨SkiaåŠ¨æ€åº“: ${SKIA_DYNAMIC_LIBRARIES}")
            else()
                target_link_libraries(skia INTERFACE ${SKIA_STATIC_LIBRARIES})
                message(STATUS "ä½¿ç”¨Skiaé™æ€åº“: ${SKIA_STATIC_LIBRARIES}")
            endif()
            
            # æŸ¥æ‰¾macOSç³»ç»Ÿæ¡†æ¶
            find_library(FOUNDATION_FRAMEWORK Foundation)
            find_library(COREGRAPHICS_FRAMEWORK CoreGraphics)
            find_library(CORETEXT_FRAMEWORK CoreText)
            find_library(COREFOUNDATION_FRAMEWORK CoreFoundation)
            find_library(COCOA_FRAMEWORK Cocoa)
            find_library(METAL_FRAMEWORK Metal)
            find_library(METALKIT_FRAMEWORK MetalKit)
            find_library(OPENGL_FRAMEWORK OpenGL)
            find_library(QUARTZCORE_FRAMEWORK QuartzCore)
            find_library(IOSURFACE_FRAMEWORK IOSurface)
            
            target_link_libraries(skia INTERFACE
                ${FOUNDATION_FRAMEWORK} ${COREGRAPHICS_FRAMEWORK} ${CORETEXT_FRAMEWORK}
                ${COREFOUNDATION_FRAMEWORK} ${COCOA_FRAMEWORK} ${METAL_FRAMEWORK}
                ${METALKIT_FRAMEWORK} ${OPENGL_FRAMEWORK} ${QUARTZCORE_FRAMEWORK} ${IOSURFACE_FRAMEWORK}
            )
            
        elseif(ANDROID)
            # Androidå¹³å°é…ç½®
            target_compile_definitions(skia INTERFACE
                SK_GANESH=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_ANDROID=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
            )
            
            # Androidä¼˜å…ˆä½¿ç”¨åŠ¨æ€åº“
            if(SKIA_DYNAMIC_LIBRARIES)
                target_link_libraries(skia INTERFACE ${SKIA_DYNAMIC_LIBRARIES})
                message(STATUS "ä½¿ç”¨SkiaåŠ¨æ€åº“: ${SKIA_DYNAMIC_LIBRARIES}")
            else()
                target_link_libraries(skia INTERFACE ${SKIA_STATIC_LIBRARIES})
                message(STATUS "ä½¿ç”¨Skiaé™æ€åº“: ${SKIA_STATIC_LIBRARIES}")
            endif()
            
            target_link_libraries(skia INTERFACE
                GLESv2 EGL vulkan android log jnigraphics mediandk
            )
            
        else()
            # Linuxå¹³å°é…ç½®
            target_compile_definitions(skia INTERFACE
                SK_GANESH=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_UNIX=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
            )
            
            # Linuxä¼˜å…ˆä½¿ç”¨åŠ¨æ€åº“
            if(SKIA_DYNAMIC_LIBRARIES)
                target_link_libraries(skia INTERFACE ${SKIA_DYNAMIC_LIBRARIES})
                target_link_options(skia INTERFACE 
                    "-Wl,-rpath,${SKIA_ROOT_DIR}/bin"
                    "-Wl,-rpath,$ORIGIN"
                )
                message(STATUS "ä½¿ç”¨SkiaåŠ¨æ€åº“: ${SKIA_DYNAMIC_LIBRARIES}")
            else()
                target_link_libraries(skia INTERFACE ${SKIA_STATIC_LIBRARIES})
                message(STATUS "ä½¿ç”¨Skiaé™æ€åº“: ${SKIA_STATIC_LIBRARIES}")
            endif()
            
            # æŸ¥æ‰¾å¿…è¦çš„ç³»ç»Ÿåº“
            find_package(PkgConfig QUIET)
            if(PKG_CONFIG_FOUND)
                pkg_check_modules(FONTCONFIG QUIET fontconfig)
                pkg_check_modules(HARFBUZZ QUIET harfbuzz)
            endif()
            
            find_package(Vulkan QUIET)
            find_package(X11 QUIET)
            
            target_link_libraries(skia INTERFACE GL pthread dl m)
            
            if(FONTCONFIG_FOUND)
                target_link_libraries(skia INTERFACE ${FONTCONFIG_LIBRARIES})
                target_include_directories(skia INTERFACE ${FONTCONFIG_INCLUDE_DIRS})
            endif()
            
            if(HARFBUZZ_FOUND)
                target_link_libraries(skia INTERFACE ${HARFBUZZ_LIBRARIES})
                target_include_directories(skia INTERFACE ${HARFBUZZ_INCLUDE_DIRS})
            endif()
            
            if(Vulkan_FOUND)
                target_link_libraries(skia INTERFACE ${Vulkan_LIBRARIES})
                target_include_directories(skia INTERFACE ${Vulkan_INCLUDE_DIRS})
            endif()
            
            if(X11_FOUND)
                target_link_libraries(skia INTERFACE
                    ${X11_LIBRARIES} ${X11_Xrandr_LIB} ${X11_Xinerama_LIB} 
                    ${X11_Xcursor_LIB} ${X11_Xi_LIB}
                )
                target_include_directories(skia INTERFACE ${X11_INCLUDE_DIR})
            endif()
        endif()
        
        # è®¾ç½®ç¼–è¯‘é€‰é¡¹
        target_compile_features(skia INTERFACE cxx_std_17)
        
        # ä¼˜åŒ–è®¾ç½®
        target_compile_options(skia INTERFACE
            $<$<CONFIG:Debug>:-g -O0>
            $<$<CONFIG:Release>:-O3 -DNDEBUG>
            $<$<CONFIG:RelWithDebInfo>:-O2 -g -DNDEBUG>
        )
        
        # è®¾ç½®é¢„å¤„ç†å™¨å®šä¹‰
        target_compile_definitions(skia INTERFACE
            $<$<CONFIG:Debug>:SK_DEBUG>
            $<$<CONFIG:Release>:SK_RELEASE>
        )
        
        # æ˜¾ç¤ºé…ç½®ä¿¡æ¯
        message(STATUS "SkiaåŠ¨æ€åº“é¢„ç¼–è¯‘åŒ…é…ç½®å®Œæˆ")
        message(STATUS "  - åŒ…å«ç›®å½•: ${SKIA_ROOT_DIR}/include")
        message(STATUS "  - æ¨¡å—åŒ…å«ç›®å½•: ${SKIA_ROOT_DIR}/include/modules")
        message(STATUS "  - åŠ¨æ€åº“ç›®å½•: ${SKIA_ROOT_DIR}/bin")
        message(STATUS "  - é™æ€åº“ç›®å½•: ${SKIA_ROOT_DIR}/lib")
        message(STATUS "  - æ”¯æŒGPUæ¸²æŸ“: OpenGL + Vulkan")
        message(STATUS "  - æ”¯æŒæ ¸å¿ƒåŠŸèƒ½: PDF, SVG")
        message(STATUS "  - å­—ä½“å’Œæ–‡æœ¬: å†…ç½®FreeType + HarfBuzz")
        message(STATUS "  - åº“ç±»å‹: åŠ¨æ€åº“ä¼˜å…ˆï¼Œé™æ€åº“å¤‡ç”¨")
        if(APPLE)
            message(STATUS "  - æ³¨æ„: macOSç‰ˆæœ¬æš‚ä¸åŒ…å«Skottieæ¨¡å—")
        else()
            message(STATUS "  - åŠ¨ç”»æ”¯æŒ: Skottie LottieåŠ¨ç”»")
        endif()
        
        # åˆ›å»ºä¾¿æ·çš„é…ç½®æ£€æŸ¥å‡½æ•°
        function(check_skia_features)
            message(STATUS "SkiaåŠ¨æ€åº“åŠŸèƒ½æ£€æŸ¥:")
            message(STATUS "  âœ“ 2Dæ¸²æŸ“å’Œç»˜å›¾")
            message(STATUS "  âœ“ GPUåŠ é€Ÿ (OpenGL/Vulkan)")
            message(STATUS "  âœ“ PDFæ–‡æ¡£ç”Ÿæˆ")
            message(STATUS "  âœ“ SVGçŸ¢é‡å›¾å½¢")
            message(STATUS "  âœ“ é«˜çº§æ–‡æœ¬å¤„ç†")
            message(STATUS "  âœ“ å›¾åƒç¼–è§£ç ")
            message(STATUS "  âœ“ åŠ¨æ€åº“é“¾æ¥")
            message(STATUS "  âœ“ è¿è¡Œæ—¶è·¯å¾„é…ç½®")
            if(NOT APPLE)
                message(STATUS "  âœ“ SkottieåŠ¨ç”»æ”¯æŒ")
            else()
                message(STATUS "  âš  SkottieåŠ¨ç”» (æš‚ä¸æ”¯æŒ)")
            endif()
        endfunction()
        
        # è‡ªåŠ¨è°ƒç”¨åŠŸèƒ½æ£€æŸ¥
        check_skia_features()
        
        # è¾…åŠ©å‡½æ•°ï¼šå¤åˆ¶åŠ¨æ€åº“åˆ°è¾“å‡ºç›®å½•ï¼ˆå¯é€‰ï¼‰
        function(copy_skia_dlls TARGET_NAME)
            if(WIN32 AND SKIA_DYNAMIC_LIBRARIES)
                add_custom_command(TARGET ${TARGET_NAME} POST_BUILD
                    COMMAND ${CMAKE_COMMAND} -E copy_if_different
                    ${SKIA_DYNAMIC_LIBRARIES}
                    $<TARGET_FILE_DIR:${TARGET_NAME}>
                    COMMENT "æ­£åœ¨å¤åˆ¶SkiaåŠ¨æ€åº“åˆ°è¾“å‡ºç›®å½•"
                )
            endif()
        endfunction()
        
        # ä½¿ç”¨è¯´æ˜
        message(STATUS "")
        message(STATUS "ä½¿ç”¨æ–¹æ³•:")
        message(STATUS "  target_link_libraries(your_target skia::skia)")
        message(STATUS "  # Windowsä¸‹å¯é€‰æ‹©å¤åˆ¶DLL:")
        message(STATUS "  # copy_skia_dlls(your_target)")
        EOF
        
      shell: bash
      
    # æ‰“åŒ…æ„å»ºäº§ç‰©ä¸ºZIPæ–‡ä»¶
    - name: æ‰“åŒ…æ„å»ºäº§ç‰©
      run: |
        cd skia/package
        
        # æ ¹æ®è¿è¡Œå¹³å°é€‰æ‹©åˆé€‚çš„æ‰“åŒ…æ–¹å¼
        if [ "${{ runner.os }}" = "Windows" ]; then
          # Windowsç³»ç»Ÿä½¿ç”¨PowerShellçš„Compress-Archive
          powershell "Compress-Archive -Path * -DestinationPath ../${{ matrix.platform }}.zip"
        else
          # Unixç³»ç»Ÿä½¿ç”¨zipå‘½ä»¤æ‰“åŒ…
          zip -r "../${{ matrix.platform }}.zip" *
        fi
        
        # éªŒè¯ZIPæ–‡ä»¶æ˜¯å¦åˆ›å»ºæˆåŠŸ
        if [ -f "../${{ matrix.platform }}.zip" ]; then
          echo "æ„å»ºåŒ…åˆ›å»ºæˆåŠŸ: ${{ matrix.platform }}.zip"
          ls -lh "../${{ matrix.platform }}.zip" 2>/dev/null || dir "../${{ matrix.platform }}.zip"
        else
          echo "æ„å»ºåŒ…åˆ›å»ºå¤±è´¥"
          exit 1
        fi
      shell: bash
      
    # ä¸Šä¼ æ„å»ºäº§ç‰©åˆ°GitHub Actions
    - name: ä¸Šä¼ æ„å»ºäº§ç‰©
      uses: actions/upload-artifact@v4
      with:
        name: ${{ matrix.platform }}
        path: skia/${{ matrix.platform }}.zip
        retention-days: 30
        compression-level: 0
        
  # åˆ›å»ºGitHub Releaseå‘å¸ƒï¼ˆä»…åœ¨æ¨é€åˆ°ä¸»åˆ†æ”¯æˆ–å®šæ—¶ä»»åŠ¡æ—¶ï¼‰
  create-release:
    needs: build-skia
    runs-on: ubuntu-latest
    # åœ¨æ¨é€åˆ°ä¸»åˆ†æ”¯æˆ–å®šæ—¶ä»»åŠ¡ä¸”æ‰€æœ‰æ„å»ºæˆåŠŸæ—¶æ‰åˆ›å»ºRelease
    if: |
      (github.event_name == 'push' && (github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master')) ||
      github.event_name == 'schedule'
    
    # ä¸ºæ­¤ä½œä¸šè®¾ç½®å¿…è¦çš„æƒé™
    permissions:
      contents: write
      packages: write
    
    steps:
    # æ£€å‡ºä»£ç ä»¥è®¿é—®ä»“åº“ä¿¡æ¯
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # ä¸‹è½½æ‰€æœ‰æ„å»ºäº§ç‰©
    - name: ä¸‹è½½æ‰€æœ‰æ„å»ºäº§ç‰©
      uses: actions/download-artifact@v4
      with:
        path: artifacts
        
    # éªŒè¯æ‰€æœ‰æ„å»ºäº§ç‰©çš„å®Œæ•´æ€§
    - name: éªŒè¯æ‰€æœ‰æ„å»ºäº§ç‰©
      run: |
        echo "æ­£åœ¨éªŒè¯æ„å»ºäº§ç‰©..."
        total_size=0
        success_count=0
        
        for dir in artifacts/*/; do
          if [ -d "$dir" ]; then
            platform=$(basename "$dir")
            zip_file="$dir$platform.zip"
            if [ -f "$zip_file" ]; then
              size=$(stat -c%s "$zip_file")
              echo "âœ… æ„å»ºåŒ…: $platform.zip - $(numfmt --to=iec $size)"
              total_size=$((total_size + size))
              success_count=$((success_count + 1))
            else
              echo "âŒ ç¼ºå°‘æ„å»ºåŒ…: $platform.zip"
            fi
          fi
        done
        
        echo "ğŸ“Š æˆåŠŸæ„å»º: $success_count ä¸ªå¹³å°"
        echo "ğŸ“Š æ‰€æœ‰æ„å»ºåŒ…æ€»å¤§å°: $(numfmt --to=iec $total_size)"
        
        # å¦‚æœæ²¡æœ‰ä»»ä½•æˆåŠŸçš„æ„å»ºåŒ…ï¼Œåˆ™é€€å‡º
        if [ $success_count -eq 0 ]; then
          echo "âŒ æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æ„å»ºåŒ…ï¼Œè·³è¿‡Releaseåˆ›å»º"
          exit 1
        fi
        
    # åˆ›å»ºå‘å¸ƒè¯´æ˜æ–‡æ¡£
    - name: åˆ›å»ºå‘å¸ƒè¯´æ˜
      run: |
        cat > RELEASE_NOTES.md << 'EOF'
        # Skia åŠ¨æ€åº“å¤šå¹³å°æ„å»ºåŒ…

        è¿™ä¸ªå‘å¸ƒåŒ…åŒ…å«äº†Skiaå›¾å½¢åº“åœ¨å¤šä¸ªå¹³å°å’Œæ¶æ„ä¸Šçš„åŠ¨æ€åº“é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼Œé’ˆå¯¹ç¨³å®šæ€§å’Œå…¼å®¹æ€§è¿›è¡Œäº†ä¼˜åŒ–ã€‚

        ## åŒ…å«çš„å¹³å°

        ### Windows
        - x64_windows.zip - Windows x64æ¶æ„
        - arm64_windows.zip - Windows ARM64æ¶æ„

        ### macOS  
        - x64_macos.zip - macOS Intelæ¶æ„
        - arm64_macos.zip - macOS Apple Siliconæ¶æ„

        ### Linux
        - x64_linux.zip - Linux x64æ¶æ„  
        - arm64_linux.zip - Linux ARM64æ¶æ„

        ### Android
        - x64_android.zip - Android x64æ¶æ„
        - arm64_android.zip - Android ARM64æ¶æ„

        ## æ¯ä¸ªåŒ…éƒ½åŒ…å«

        - include/ - å®Œæ•´çš„Skia C++ APIå¤´æ–‡ä»¶å’Œæ¨¡å—å¤´æ–‡ä»¶
        - lib/ - é™æ€åº“æ–‡ä»¶ï¼ˆå¤‡ç”¨ï¼‰
        - **bin/ - åŠ¨æ€åº“æ–‡ä»¶ï¼ˆä¸»è¦ä½¿ç”¨ï¼‰**
        - examples/ - ç¤ºä¾‹èµ„æºæ–‡ä»¶
        - BUILD_INFO.txt - è¯¦ç»†çš„æ„å»ºä¿¡æ¯
        - README.md - ä½¿ç”¨è¯´æ˜
        - CMakeLists.txt - CMakeé…ç½®æ–‡ä»¶ï¼Œé»˜è®¤é“¾æ¥åŠ¨æ€åº“

        ## åŠ¨æ€åº“ç‰¹æ€§

        ### åŠ¨æ€åº“æ ¼å¼
        - **Windows**: bin/*.dll + lib/*.libï¼ˆå¯¼å…¥åº“ï¼‰
        - **macOS**: bin/*.dylib
        - **Linux**: bin/*.so
        - **Android**: bin/*.so

        ### åŠ¨æ€åº“ä¼˜åŠ¿
        - âœ… **æ›´å°çš„å¯æ‰§è¡Œæ–‡ä»¶** - ä¸»ç¨‹åºä½“ç§¯æ˜¾è‘—å‡å°
        - âœ… **ä¾¿äºæ›´æ–°ç»´æŠ¤** - å¯å•ç‹¬æ›´æ–°åº“æ–‡ä»¶
        - âœ… **å¤šç¨‹åºå…±äº«** - å¤šä¸ªç¨‹åºå¯å…±äº«åŒä¸€åº“å®ä¾‹
        - âœ… **å‡å°‘å†…å­˜å ç”¨** - ç³»ç»Ÿçº§åˆ«çš„åº“å…±äº«
        - âœ… **æ¨¡å—åŒ–éƒ¨ç½²** - å¯é€‰æ‹©æ€§éƒ¨ç½²æ‰€éœ€åŠŸèƒ½

        ## æ ¸å¿ƒåŠŸèƒ½æ”¯æŒ

        ### é«˜æ€§èƒ½æ¸²æŸ“
        - é«˜æ€§èƒ½2DçŸ¢é‡å›¾å½¢æ¸²æŸ“
        - ä½å›¾å’Œåƒç´ æ“ä½œ
        - è·¯å¾„ç»˜åˆ¶å’Œå¡«å……
        - æ¸å˜å’Œå›¾æ¡ˆå¡«å……
        - å›¾åƒæ»¤é•œå’Œæ•ˆæœ

        ### GPUåŠ é€Ÿæ¸²æŸ“
        - **OpenGL/OpenGL ES** - è·¨å¹³å°GPUæ¸²æŸ“
        - **Vulkan** - ç°ä»£ä½å¼€é”€GPU API  
        - **Metal** - macOS/iOSåŸç”ŸGPU API
        - **Direct3D** - WindowsåŸç”ŸGPU API

        ### é«˜çº§åŠŸèƒ½
        - **PDFæ–‡æ¡£ç”Ÿæˆ** - å®Œæ•´çš„PDFå¯¼å‡ºåŠŸèƒ½ï¼Œæ”¯æŒå­—ä½“å­é›†
        - **SVGçŸ¢é‡å›¾å½¢** - SVGæ–‡ä»¶è§£æå’Œæ¸²æŸ“
        - **å¤æ‚æ–‡æœ¬å¸ƒå±€** - å†…ç½®HarfBuzzæ–‡æœ¬æ•´å½¢å¼•æ“
        - **å¤šè¯­è¨€å­—ä½“** - å†…ç½®FreeTypeå­—ä½“æ¸²æŸ“å¼•æ“
        - **å›¾åƒç¼–è§£ç ** - æ”¯æŒå¤šç§å›¾åƒæ ¼å¼
        - **DNG RAWå›¾åƒ** - RAWå›¾åƒå¤„ç†ï¼ˆé™¤Windowså¹³å°å¤–ï¼‰

        ### å¹³å°ç‰¹æ®ŠåŠŸèƒ½æ”¯æŒ

        #### SkottieåŠ¨ç”»æ”¯æŒ
        - **Windows**: âœ… å®Œæ•´æ”¯æŒSkottie LottieåŠ¨ç”»
        - **Linux**: âœ… å®Œæ•´æ”¯æŒSkottie LottieåŠ¨ç”»  
        - **Android**: âœ… å®Œæ•´æ”¯æŒSkottie LottieåŠ¨ç”»
        - **macOS**: âŒ æš‚æ—¶ç¦ç”¨ï¼ˆä¸ºç¡®ä¿æ„å»ºç¨³å®šæ€§ï¼‰

        ## CMakeé›†æˆï¼ˆæ¨èæ–¹å¼ï¼‰

        ### åŸºæœ¬ç”¨æ³•
        ```cmake
        # æ·»åŠ Skiaå­ç›®å½•
        add_subdirectory(path/to/skia)

        # é“¾æ¥åˆ°ä½ çš„ç›®æ ‡ï¼ˆè‡ªåŠ¨ä½¿ç”¨åŠ¨æ€åº“ï¼‰
        target_link_libraries(your_target skia::skia)
        ```

        ### CMakeè‡ªåŠ¨ç‰¹æ€§
        - âœ… **ä¼˜å…ˆé“¾æ¥åŠ¨æ€åº“** - è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨binç›®å½•ä¸­çš„åŠ¨æ€åº“
        - âœ… **è‡ªåŠ¨è®¾ç½®è¿è¡Œæ—¶è·¯å¾„** - é…ç½®rpath/runpath
        - âœ… **è·¨å¹³å°é€‚é…** - è‡ªåŠ¨é€‚é…ä¸åŒå¹³å°çš„åº“æ ¼å¼
        - âœ… **ä¾èµ–ç®¡ç†** - è‡ªåŠ¨é“¾æ¥æ‰€éœ€çš„ç³»ç»Ÿåº“
        - âœ… **å¤‡ç”¨é™æ€åº“** - åŠ¨æ€åº“ä¸å¯ç”¨æ—¶è‡ªåŠ¨å›é€€åˆ°é™æ€åº“

        ## å¹³å°ç‰¹æ®Šè¯´æ˜

        ### macOSå¹³å°é™åˆ¶
        ç”±äºSkottieæ¨¡å—åœ¨macOSå¹³å°å­˜åœ¨é“¾æ¥å™¨ç¬¦å·å†²çªé—®é¢˜ï¼Œå½“å‰ç‰ˆæœ¬å·²ç¦ç”¨Skottieæ”¯æŒä»¥ç¡®ä¿æ„å»ºç¨³å®šæ€§ã€‚

        **macOSå¹³å°æ”¯æŒçš„åŠŸèƒ½ï¼š**
        - âœ… å®Œæ•´çš„2Dæ¸²æŸ“å’ŒGPUåŠ é€Ÿ
        - âœ… PDFæ–‡æ¡£ç”Ÿæˆ
        - âœ… SVGçŸ¢é‡å›¾å½¢
        - âœ… Metal GPUæ¸²æŸ“
        - âœ… é«˜çº§æ–‡æœ¬å¤„ç†
        - âŒ SkottieåŠ¨ç”»ï¼ˆæš‚æ—¶ç¦ç”¨ï¼‰

        **è§£å†³æ–¹æ¡ˆï¼š**
        - ä½¿ç”¨å…¶ä»–å¹³å°çš„æ„å»ºåŒ…ä»¥è·å¾—Skottieæ”¯æŒ
        - æˆ–è€…ç­‰å¾…æœªæ¥ç‰ˆæœ¬çš„ä¿®å¤

        ### å…¶ä»–å¹³å°
        Windowsã€Linuxå’ŒAndroidå¹³å°æ”¯æŒå®Œæ•´åŠŸèƒ½ï¼ŒåŒ…æ‹¬SkottieåŠ¨ç”»æ”¯æŒã€‚

        ## éƒ¨ç½²æŒ‡å—

        ### å¼€å‘ç¯å¢ƒ
        1. è§£å‹æ„å»ºåŒ…åˆ°é¡¹ç›®ç›®å½•
        2. ä½¿ç”¨CMakeè‡ªåŠ¨é…ç½®
        3. ç¡®ä¿åŠ¨æ€åº“è·¯å¾„æ­£ç¡®

        ### ç”Ÿäº§ç¯å¢ƒ
        1. **Windows**: å°†DLLæ–‡ä»¶ä¸å¯æ‰§è¡Œæ–‡ä»¶ä¸€èµ·åˆ†å‘
        2. **macOS**: ä½¿ç”¨`install_name_tool`é…ç½®rpathæˆ–bundleåº“æ–‡ä»¶
        3. **Linux**: é…ç½®LD_LIBRARY_PATHæˆ–ä½¿ç”¨rpath
        4. **Android**: å°†.soæ–‡ä»¶æ‰“åŒ…åˆ°APKçš„libç›®å½•

        ## æ€§èƒ½ç‰¹æ€§

        - **GPUåŠ é€Ÿ**: æ”¯æŒç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“
        - **å¤šçº¿ç¨‹**: æ”¯æŒå¹¶è¡Œæ¸²æŸ“å’Œå¤„ç†  
        - **å†…å­˜ä¼˜åŒ–**: åŠ¨æ€åº“å…±äº«å‡å°‘å†…å­˜å ç”¨
        - **å¯åŠ¨ä¼˜åŒ–**: å»¶è¿ŸåŠ è½½å’ŒæŒ‰éœ€åŠ è½½
        - **ç¼“å­˜æœºåˆ¶**: æ™ºèƒ½çš„èµ„æºç¼“å­˜
        - **æ–‡æœ¬ä¼˜åŒ–**: å†…ç½®æ–‡æœ¬å¼•æ“æä¾›æœ€ä½³æ€§èƒ½

        ## ä½¿ç”¨å»ºè®®

        ### æœ€ä½³å®è·µ
        1. **ä¼˜å…ˆä½¿ç”¨CMake** - è‡ªåŠ¨å¤„ç†å¤æ‚çš„é“¾æ¥é…ç½®
        2. **æµ‹è¯•è¿è¡Œæ—¶è·¯å¾„** - ç¡®ä¿ç¨‹åºèƒ½æ‰¾åˆ°åŠ¨æ€åº“
        3. **ç‰ˆæœ¬ç®¡ç†** - æ³¨æ„åŠ¨æ€åº“ç‰ˆæœ¬å…¼å®¹æ€§
        4. **åŠŸèƒ½é€‰æ‹©** - æ ¹æ®å¹³å°é€‰æ‹©åˆé€‚çš„åŠŸèƒ½
        5. **å¤‡ç”¨æ–¹æ¡ˆ** - å‡†å¤‡é™æ€åº“ä½œä¸ºå¤‡é€‰

        ### åŠ¨ç”»åŠŸèƒ½å»ºè®®
        - **éœ€è¦Skottie**: ä¼˜å…ˆé€‰æ‹©Windowsã€Linuxæˆ–Androidå¹³å°
        - **macOSå¼€å‘**: è€ƒè™‘ä½¿ç”¨å…¶ä»–åŠ¨ç”»åº“æˆ–ç­‰å¾…åç»­ç‰ˆæœ¬

        ## å…¼å®¹æ€§

        - **æœ€ä½ç³»ç»Ÿè¦æ±‚**: 
          - Windows 10+
          - macOS 10.15+  
          - Linux kernel 4.4+
          - Android API 21+
        - **GPUè¦æ±‚**: æ”¯æŒOpenGL 3.3+æˆ–Vulkan 1.0+çš„æ˜¾å¡
        - **è¿è¡Œæ—¶**: ç¡®ä¿åŠ¨æ€åº“è·¯å¾„æ­£ç¡®é…ç½®

        ## è‡ªåŠ¨æ›´æ–°

        æ­¤æ„å»ºåŒ…æ¯å¤©è‡ªåŠ¨æ›´æ–°ï¼Œç¡®ä¿åŒ…å«æœ€æ–°çš„ç¨³å®šSkiaä»£ç ã€‚æˆ‘ä»¬ä¼šæŒç»­ç›‘æ§macOSå¹³å°çš„Skottieé—®é¢˜å¹¶åœ¨åç»­ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚

        ## æŠ€æœ¯æ”¯æŒ

        å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹åŒ…å†…çš„README.mdæ–‡ä»¶ã€‚macOSå¹³å°çš„Skottieé—®é¢˜å°†åœ¨åç»­ç‰ˆæœ¬ä¸­è§£å†³ã€‚
        EOF
        
    # è·å–å‘å¸ƒæ ‡ç­¾
    - name: è·å–å‘å¸ƒæ ‡ç­¾
      id: get_tag
      run: |
        if [ "${{ github.event_name }}" = "schedule" ]; then
          # å®šæ—¶ä»»åŠ¡ä½¿ç”¨æ—¥æœŸä½œä¸ºæ ‡ç­¾
          echo "tag=daily-$(date +%Y%m%d)" >> $GITHUB_OUTPUT
          echo "name=SkiaåŠ¨æ€åº“æ¯æ—¥æ„å»ºåŒ… $(date +%Y-%m-%d)" >> $GITHUB_OUTPUT
        else
          # æ‰‹åŠ¨è§¦å‘ä½¿ç”¨æ„å»ºç¼–å·
          echo "tag=skia-dynamic-build-${{ github.run_number }}" >> $GITHUB_OUTPUT
          echo "name=SkiaåŠ¨æ€åº“æ„å»ºåŒ… v${{ github.run_number }}" >> $GITHUB_OUTPUT
        fi
        
    # åˆ›å»ºGitHub Releaseå‘å¸ƒç‰ˆæœ¬
    - name: åˆ›å»ºGitHub Release
      uses: softprops/action-gh-release@v2
      with:
        tag_name: ${{ steps.get_tag.outputs.tag }}
        name: ${{ steps.get_tag.outputs.name }}
        body_path: RELEASE_NOTES.md
        files: |
          artifacts/*/**.zip
        draft: false
        prerelease: false
        generate_release_notes: false
        make_latest: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    # æ„å»ºå®Œæˆé€šçŸ¥
    - name: æ„å»ºå®Œæˆé€šçŸ¥
      run: |
        echo "ğŸ‰ SkiaåŠ¨æ€åº“å¤šå¹³å°æ„å»ºå®Œæˆï¼"
        echo "ğŸ“¦ å·²ç”Ÿæˆä»¥ä¸‹å¹³å°çš„åŠ¨æ€åº“æ„å»ºåŒ…ï¼š"
        echo "   â€¢ Windows: x64, ARM64 (å®Œæ•´åŠŸèƒ½åŒ…æ‹¬Skottie)"  
        echo "   â€¢ macOS: x64, ARM64 (é™¤Skottieå¤–çš„å®Œæ•´åŠŸèƒ½)"
        echo "   â€¢ Linux: x64, ARM64 (å®Œæ•´åŠŸèƒ½åŒ…æ‹¬Skottie)"
        echo "   â€¢ Android: x64, ARM64 (å®Œæ•´åŠŸèƒ½åŒ…æ‹¬Skottie)"
        echo "ğŸ”— å¯åœ¨Actionsé¡µé¢ä¸‹è½½ï¼Œæˆ–åœ¨Releasesä¸­è·å–"
        echo "ğŸ“‹ æ¯ä¸ªåŒ…éƒ½åŒ…å«åŠ¨æ€åº“ä¼˜å…ˆçš„CMakeLists.txté…ç½®"
        echo "ğŸ® æ”¯æŒOpenGLå’ŒVulkan GPUåç«¯"
        echo "âœ¨ åŒ…å«PDFã€SVGç­‰æ ¸å¿ƒåŠŸèƒ½"
        echo "ğŸ”¤ ä½¿ç”¨å†…ç½®å­—ä½“å’Œæ–‡æœ¬å¼•æ“ï¼Œæ— ç³»ç»Ÿä¾èµ–"
        echo "ğŸ“„ PDFå¯¼å‡ºæ”¯æŒå­—ä½“å­é›†åŠŸèƒ½"
        echo "ğŸš€ åŠ¨æ€åº“ä¼˜åŒ–ï¼Œä¾¿äºéƒ¨ç½²å’Œç»´æŠ¤"
        echo "ğŸ“ åŠ¨æ€åº“ä½äºbinç›®å½•ï¼ŒCMakeè‡ªåŠ¨é“¾æ¥"
        echo "âš ï¸  macOSå¹³å°æš‚æ—¶ç¦ç”¨Skottieä»¥ç¡®ä¿æ„å»ºç¨³å®šæ€§"
