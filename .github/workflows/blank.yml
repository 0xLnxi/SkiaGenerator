# Skia å…¨å¹³å°ç»Ÿä¸€æ„å»ºå·¥ä½œæµï¼ˆç¡®ä¿æ”¶é›†Dawn WebGPUç”Ÿæˆçš„å¤´æ–‡ä»¶ï¼‰
name: ç¼–è¯‘ Skia å…¨å¹³å°ç»Ÿä¸€æ„å»ºåŒ…

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´ä¸Šåˆ8ç‚¹ï¼ˆUTCæ—¶é—´0ç‚¹ï¼‰æ‰§è¡Œä¸€æ¬¡
    - cron: '0 0 * * *'

# è®¾ç½®å·¥ä½œæµæƒé™
permissions:
  contents: write
  packages: write
  actions: read

jobs:
  build-skia:
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        include:
          # Windows x64æ¶æ„ - MSVC 2022
          - os: windows-latest
            platform: Win
            arch: x64
            target_os: win
            target_cpu: x64
            compiler: msvc2022
            
          # Linux x64æ¶æ„ - GCC 13
          - os: ubuntu-latest
            platform: Linux
            arch: x64
            target_os: linux
            target_cpu: x64
            compiler: gcc13
            
          # Android x64æ¶æ„ - Clang 18
          - os: ubuntu-latest
            platform: Android
            arch: x64
            target_os: android
            target_cpu: x64
            android_api: 21
            compiler: clang18
            
          # Android ARM64æ¶æ„ - Clang 18
          - os: ubuntu-latest
            platform: Android
            arch: arm64
            target_os: android
            target_cpu: arm64
            android_api: 21
            compiler: clang18

    steps:
    # æ£€å‡ºä»£ç ä»“åº“
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # è®¾ç½®Pythonè¿è¡Œç¯å¢ƒ
    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
        
    # å®‰è£…å¹¶é…ç½®GCC 13ï¼ˆä»…Linuxå¹³å°ï¼‰
    - name: å®‰è£…é…ç½®GCC 13
      if: runner.os == 'Linux' && matrix.compiler == 'gcc13'
      run: |
        # æ·»åŠ Ubuntuå·¥å…·é“¾PPAæº
        sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
        sudo apt-get update
        
        # å®‰è£…GCC 13ç¼–è¯‘å™¨å¥—ä»¶
        sudo apt-get install -y gcc-13 g++-13
        
        # è®¾ç½®GCC 13ä¸ºé»˜è®¤ç¼–è¯‘å™¨
        sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-13 100
        sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-13 100
        
        # éªŒè¯ç¼–è¯‘å™¨ç‰ˆæœ¬
        gcc --version
        g++ --version
        
        # è®¾ç½®ç¯å¢ƒå˜é‡
        echo "CC=gcc-13" >> $GITHUB_ENV
        echo "CXX=g++-13" >> $GITHUB_ENV
        
    # å®‰è£…å¹¶é…ç½®Clang 18ï¼ˆä»…Linuxå’ŒAndroidå¹³å°ï¼‰
    - name: å®‰è£…é…ç½®Clang 18
      if: runner.os == 'Linux' && matrix.compiler == 'clang18'
      run: |
        # æ·»åŠ LLVMå®˜æ–¹APTæº
        wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key | sudo apt-key add -
        sudo add-apt-repository "deb http://apt.llvm.org/jammy/ llvm-toolchain-jammy-18 main" -y
        sudo apt-get update
        
        # å®‰è£…Clang 18ç¼–è¯‘å™¨å¥—ä»¶
        sudo apt-get install -y clang-18 clang++-18 libc++-18-dev libc++abi-18-dev
        
        # è®¾ç½®Clang 18ä¸ºé»˜è®¤ç¼–è¯‘å™¨
        sudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-18 100
        sudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-18 100
        
        # éªŒè¯ç¼–è¯‘å™¨ç‰ˆæœ¬
        clang --version
        clang++ --version
        
        # è®¾ç½®ç¯å¢ƒå˜é‡
        echo "CC=clang-18" >> $GITHUB_ENV
        echo "CXX=clang++-18" >> $GITHUB_ENV
        
    # å®‰è£…Linuxç³»ç»Ÿä¾èµ–åŒ…ï¼ˆLinuxå’ŒAndroidæ„å»ºéœ€è¦ï¼‰
    - name: å®‰è£…Linuxç³»ç»Ÿä¾èµ–
      if: runner.os == 'Linux'
      run: |
        sudo apt-get update
        # å®‰è£…åŸºç¡€æ„å»ºå·¥å…·
        sudo apt-get install -y build-essential ninja-build
        # å®‰è£…å›¾å½¢å’Œå­—ä½“ç›¸å…³ä¾èµ–
        sudo apt-get install -y libfontconfig1-dev libfreetype6-dev libgl1-mesa-dev
        # å®‰è£…Vulkanå¼€å‘åº“
        sudo apt-get install -y libvulkan-dev vulkan-tools
        # å®‰è£…å®Œæ•´çš„X11å¼€å‘åº“
        sudo apt-get install -y libx11-dev libx11-xcb-dev libxcb1-dev libxrandr-dev libxinerama-dev libxcursor-dev libxi-dev libxext-dev libxfixes-dev
        # å®‰è£…ICUå’ŒHarfBuzz
        sudo apt-get install -y libicu-dev libharfbuzz-dev
        # å®‰è£…Javaå¼€å‘ç¯å¢ƒï¼ˆAndroidæ„å»ºéœ€è¦ï¼‰
        sudo apt-get install -y openjdk-11-jdk
        # å®‰è£…Dawn WebGPUä¾èµ–
        sudo apt-get install -y libwayland-dev libxkbcommon-dev libwayland-egl1-mesa
        
    # é…ç½®Windows MSVC 2022ç¯å¢ƒ
    - name: é…ç½®Windows MSVC 2022ç¯å¢ƒ
      if: runner.os == 'Windows'
      run: |
        # å®‰è£…ninjaæ„å»ºå·¥å…·
        choco install ninja -y
        
        # è®¾ç½®MSVC 2022ç¯å¢ƒå˜é‡
        echo "ä½¿ç”¨Visual Studio 2022æ„å»ºå·¥å…·é“¾"
        
    # è®¾ç½®Android NDKç¯å¢ƒï¼ˆä»…é™Androidå¹³å°ï¼‰
    - name: è®¾ç½®Android NDK
      if: matrix.target_os == 'android'
      uses: nttld/setup-ndk@v1
      with:
        ndk-version: r25c
        
    # è·å–Googleçš„depot_toolså·¥å…·é›†
    - name: è·å–depot_tools
      run: |
        git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git
        echo "${{ github.workspace }}/depot_tools" >> $GITHUB_PATH
      shell: bash
      
    # è®¾ç½®Windowsç³»ç»Ÿçš„depot_toolsç¯å¢ƒå˜é‡
    - name: è®¾ç½®depot_toolsç¯å¢ƒå˜é‡
      if: runner.os == 'Windows'
      run: |
        echo "${{ github.workspace }}\depot_tools" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append
        # ç¦ç”¨depot_toolsè‡ªåŠ¨ä¸‹è½½å·¥å…·é“¾
        echo "DEPOT_TOOLS_WIN_TOOLCHAIN=0" | Out-File -FilePath $env:GITHUB_ENV -Encoding utf8 -Append
        
    # è·å–Skiaæºä»£ç å¹¶åŒæ­¥ä¾èµ–
    - name: è·å–Skiaæºä»£ç 
      run: |
        git clone https://skia.googlesource.com/skia.git
        cd skia
        python tools/git-sync-deps
      shell: bash
      
    # é…ç½®Skiaæ„å»ºå‚æ•°
    - name: é…ç½®Skiaæ„å»ºå‚æ•°
      run: |
        cd skia
        
        # åŸºç¡€æ„å»ºå‚æ•°è®¾ç½® - å¯ç”¨å…¨é‡åŠŸèƒ½åŒ…æ‹¬Ganeshå’ŒGraphite
        args="is_official_build=true"
        args="$args skia_use_system_expat=false"
        args="$args skia_use_system_icu=false"
        args="$args skia_use_system_libjpeg_turbo=false"
        args="$args skia_use_system_libpng=false"
        args="$args skia_use_system_libwebp=false"
        args="$args skia_use_system_zlib=false"
        
        # å¯ç”¨å…¨é‡åŠŸèƒ½æ”¯æŒï¼Œä½†ä½¿ç”¨å†…ç½®ä¾èµ–åº“
        args="$args skia_enable_pdf=true"
        args="$args skia_enable_skottie=true"
        args="$args skia_enable_skshaper=true"
        args="$args skia_enable_svg=true"
        args="$args skia_use_icu=true"
        
        # å¯ç”¨åŒGPUåç«¯æ”¯æŒ - Ganeshå’ŒGraphite
        args="$args skia_enable_gpu=true"
        args="$args skia_use_gl=true"
        args="$args skia_use_vulkan=true"
        args="$args skia_enable_spirv_validation=false"
        
        # å¯ç”¨Graphiteåç«¯åŠDawn WebGPUæ”¯æŒ
        args="$args skia_enable_graphite=true"
        args="$args skia_use_dawn=true"
        args="$args skia_use_wgpu=true"
        
        # ç¦ç”¨å·¥å…·æ„å»ºä»¥é¿å…æµ‹è¯•å·¥å…·APIé—®é¢˜
        args="$args skia_enable_tools=false"
        
        # è®¾ç½®ç›®æ ‡å¹³å°å’Œæ¶æ„
        args="$args target_os=\"${{ matrix.target_os }}\""
        args="$args target_cpu=\"${{ matrix.target_cpu }}\""
        
        # æ ¹æ®ä¸åŒå¹³å°å’Œç¼–è¯‘å™¨è®¾ç½®ç‰¹å®šå‚æ•°
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°ç‰¹å®šé…ç½® - ä½¿ç”¨MSVC 2022å’Œ/MDè¿è¡Œæ—¶
            args="$args skia_use_angle=true"
            args="$args skia_use_direct3d=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=false"
            args="$args skia_use_piex=false"
            # Dawn WebGPU Windowsç‰¹å®šé…ç½®
            args="$args dawn_enable_d3d11=true"
            args="$args dawn_enable_d3d12=true"
            args="$args dawn_enable_vulkan=true"
            args="$args dawn_enable_desktop_gl=true"
            # è®¾ç½®Windowsç¼–è¯‘å‚æ•°ï¼ˆåˆ†åˆ«è®¾ç½®Cå’ŒC++æ ‡å‡†ï¼‰
            args="$args extra_cflags=[\"/MD\"]"
            args="$args extra_cflags_c=[\"/MD\"]"
            args="$args extra_cflags_cc=[\"/MD\", \"/std:c++latest\"]"
            ;;
          "linux")
            # Linuxå¹³å°ç‰¹å®šé…ç½® - ä½¿ç”¨GCC 13æˆ–Clang 18
            args="$args skia_use_x11=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_fontconfig=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            args="$args skia_use_system_freetype2=true"
            args="$args skia_use_system_harfbuzz=true"
            # Dawn WebGPU Linuxç‰¹å®šé…ç½®
            args="$args dawn_enable_vulkan=true"
            args="$args dawn_enable_desktop_gl=true"
            args="$args dawn_use_wayland=true"
            args="$args dawn_use_x11=true"
            # æ ¹æ®ç¼–è¯‘å™¨è®¾ç½®Linuxç¼–è¯‘å‚æ•°
            if [ "${{ matrix.compiler }}" = "gcc13" ]; then
              args="$args extra_cflags_c=[]"
              args="$args extra_cflags_cc=[\"-std=c++20\"]"
            else
              args="$args extra_cflags_c=[\"-stdlib=libc++\"]"
              args="$args extra_cflags_cc=[\"-std=c++20\", \"-stdlib=libc++\"]"
            fi
            # å¼ºåˆ¶è¦†ç›–Dawnçš„C++æ ‡å‡†è®¾ç½®
            args="$args dawn_cxx_standard=\"c++20\""
            ;;
          "android")
            # Androidå¹³å°ç‰¹å®šé…ç½® - ä½¿ç”¨Clang 18
            args="$args ndk=\"$ANDROID_NDK_ROOT\""
            args="$args android_api_level=${{ matrix.android_api }}"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_freetype=true"
            args="$args skia_enable_fontmgr_android=true"
            args="$args skia_use_vulkan=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            # Dawn WebGPU Androidç‰¹å®šé…ç½®
            args="$args dawn_enable_vulkan=true"
            args="$args dawn_enable_opengles=true"
            # è®¾ç½®Androidç¼–è¯‘å‚æ•°
            args="$args extra_cflags_c=[]"
            args="$args extra_cflags_cc=[\"-std=c++20\"]"
            # å¼ºåˆ¶è¦†ç›–Dawnçš„C++æ ‡å‡†è®¾ç½®
            args="$args dawn_cxx_standard=\"c++20\""
            ;;
        esac
        
        echo "BUILD_ARGS=$args" >> $GITHUB_ENV
      shell: bash
      
    # ä½¿ç”¨GNç”Ÿæˆæ„å»ºæ–‡ä»¶
    - name: ç”ŸæˆSkiaæ„å»ºæ–‡ä»¶
      run: |
        cd skia
        echo "æ­£åœ¨ä¸º ${{ matrix.target_os }} å¹³å°ä½¿ç”¨ ${{ matrix.compiler }} ç¼–è¯‘å™¨ç”Ÿæˆæ„å»ºæ–‡ä»¶..."
        echo "æ„å»ºå‚æ•°: $BUILD_ARGS"
        bin/gn gen out/Release --args="$BUILD_ARGS"
        echo "æ„å»ºé…ç½®å®Œæˆ"
      shell: bash
      
    # ä½¿ç”¨Ninjaç¼–è¯‘Skia
    - name: ç¼–è¯‘Skia
      run: |
        cd skia
        echo "å¼€å§‹ç¼–è¯‘ ${{ matrix.target_os }} å¹³å°çš„Skia (ä½¿ç”¨ ${{ matrix.compiler }} ç¼–è¯‘å™¨)..."
        if [ "${{ matrix.target_os }}" = "android" ]; then
          ninja -C out/Release -j8
        else
          ninja -C out/Release -j6
        fi
        echo "âœ… ${{ matrix.target_os }} å¹³å°Skiaç¼–è¯‘å®Œæˆ (ç¼–è¯‘å™¨: ${{ matrix.compiler }})"
      shell: bash
      
    # åˆ›å»ºå¹³å°ç‰¹å®šçš„æ„å»ºäº§ç‰©ç›®å½•
    - name: åˆ›å»ºå¹³å°æ„å»ºäº§ç‰©
      run: |
        cd skia
        
        # åˆ›å»ºæ–°çš„ç›®å½•ç»“æ„ï¼šbin/å¹³å°/æ¶æ„ å’Œ lib/å¹³å°/æ¶æ„
        mkdir -p artifacts/bin/${{ matrix.platform }}/${{ matrix.arch }}
        mkdir -p artifacts/lib/${{ matrix.platform }}/${{ matrix.arch }}
        
        # æ ¹æ®ä¸åŒå¹³å°å¤åˆ¶ç›¸åº”çš„åº“æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°æ–‡ä»¶å¤åˆ¶
            echo "å¤åˆ¶Windowsåº“æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶..."
            find out/Release -name "*.lib" -exec cp {} artifacts/lib/${{ matrix.platform }}/${{ matrix.arch }}/ \; 2>/dev/null || true
            find out/Release -name "*.dll" -exec cp {} artifacts/bin/${{ matrix.platform }}/${{ matrix.arch }}/ \; 2>/dev/null || true
            find out/Release -name "*.exe" -exec cp {} artifacts/bin/${{ matrix.platform }}/${{ matrix.arch }}/ \; 2>/dev/null || true
            ;;
          "linux"|"android")
            # Linuxå’ŒAndroidå¹³å°æ–‡ä»¶å¤åˆ¶
            echo "å¤åˆ¶Linux/Androidåº“æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶..."
            find out/Release -name "*.a" -exec cp {} artifacts/lib/${{ matrix.platform }}/${{ matrix.arch }}/ \; 2>/dev/null || true
            find out/Release -name "*.so" -exec cp {} artifacts/lib/${{ matrix.platform }}/${{ matrix.arch }}/ \; 2>/dev/null || true
            find out/Release -type f -perm +111 -name "*" -not -name "*.so" -exec cp {} artifacts/bin/${{ matrix.platform }}/${{ matrix.arch }}/ \; 2>/dev/null || true
            ;;
        esac
        
        echo "âœ… ${{ matrix.platform }}/${{ matrix.arch }} æ„å»ºäº§ç‰©å·²å‡†å¤‡å®Œæˆ"
      shell: bash
      
    # ä¸Šä¼ å¹³å°ç‰¹å®šæ„å»ºäº§ç‰©
    - name: ä¸Šä¼ å¹³å°æ„å»ºäº§ç‰©
      uses: actions/upload-artifact@v4
      with:
        name: ${{ matrix.platform }}-${{ matrix.arch }}
        path: skia/artifacts/
        retention-days: 30

  # æ”¶é›†å…±äº«å¤´æ–‡ä»¶ï¼ˆåªéœ€è¦æ‰§è¡Œä¸€æ¬¡ï¼‰
  collect-headers:
    runs-on: ubuntu-latest
    
    steps:
    # æ£€å‡ºä»£ç ä»“åº“
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # è®¾ç½®Pythonç¯å¢ƒ
    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
        
    # å®‰è£…Linuxä¾èµ–ï¼ˆç”¨äºç¼–è¯‘ç”ŸæˆDawnå¤´æ–‡ä»¶ï¼‰
    - name: å®‰è£…Linuxä¾èµ–
      run: |
        sudo apt-get update
        sudo apt-get install -y build-essential ninja-build
        sudo apt-get install -y libfontconfig1-dev libfreetype6-dev libgl1-mesa-dev
        sudo apt-get install -y libvulkan-dev vulkan-tools
        sudo apt-get install -y libx11-dev libx11-xcb-dev libxcb1-dev
        sudo apt-get install -y libwayland-dev libxkbcommon-dev libwayland-egl1-mesa
        
    # è·å–depot_toolså·¥å…·é›†
    - name: è·å–depot_tools
      run: |
        git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git
        echo "${{ github.workspace }}/depot_tools" >> $GITHUB_PATH
        
    # è·å–Skiaæºä»£ç ï¼ˆç”¨äºç”ŸæˆDawnå¤´æ–‡ä»¶ï¼‰
    - name: è·å–Skiaæºä»£ç 
      run: |
        git clone https://skia.googlesource.com/skia.git
        cd skia
        python tools/git-sync-deps
        
    # é¢„ç¼–è¯‘ç”ŸæˆDawnå¤´æ–‡ä»¶ï¼ˆå…³é”®æ­¥éª¤ï¼‰
    - name: é¢„ç¼–è¯‘ç”ŸæˆDawnå¤´æ–‡ä»¶
      run: |
        cd skia
        
        echo "å¼€å§‹é¢„ç¼–è¯‘ç”ŸæˆDawn WebGPUå¤´æ–‡ä»¶..."
        
        # é…ç½®æœ€å°åŒ–æ„å»ºå‚æ•°ä»¥ç”ŸæˆDawnå¤´æ–‡ä»¶
        basic_args="is_debug=false"
        basic_args="$basic_args is_official_build=false"
        basic_args="$basic_args skia_enable_gpu=true"
        basic_args="$basic_args skia_enable_graphite=true"
        basic_args="$basic_args skia_use_dawn=true"
        basic_args="$basic_args skia_use_wgpu=true"
        basic_args="$basic_args skia_enable_tools=false"
        basic_args="$basic_args target_os=\"linux\""
        basic_args="$basic_args target_cpu=\"x64\""
        basic_args="$basic_args dawn_enable_vulkan=true"
        basic_args="$basic_args dawn_enable_desktop_gl=true"
        basic_args="$basic_args extra_cflags_cc=[\"-std=c++20\"]"
        basic_args="$basic_args dawn_cxx_standard=\"c++20\""
        
        echo "ç”ŸæˆGNæ„å»ºæ–‡ä»¶..."
        bin/gn gen out/HeaderGen --args="$basic_args"
        
        echo "ç¼–è¯‘Dawnå¤´æ–‡ä»¶ç”Ÿæˆç›®æ ‡..."
        # ç¼–è¯‘Dawn WebGPUç›¸å…³ç›®æ ‡ä»¥ç”Ÿæˆæ‰€æœ‰å¿…è¦çš„å¤´æ–‡ä»¶
        ninja -C out/HeaderGen third_party/externals/dawn:webgpu_headers || echo "webgpu_headersç›®æ ‡ç¼–è¯‘å®Œæˆæˆ–è·³è¿‡"
        ninja -C out/HeaderGen third_party/externals/dawn:webgpu_cpp || echo "webgpu_cppç›®æ ‡ç¼–è¯‘å®Œæˆæˆ–è·³è¿‡"
        ninja -C out/HeaderGen third_party/externals/dawn:dawncpp || echo "dawncppç›®æ ‡ç¼–è¯‘å®Œæˆæˆ–è·³è¿‡"
        ninja -C out/HeaderGen third_party/externals/dawn/src/dawn:cpp || echo "dawn_cppç›®æ ‡ç¼–è¯‘å®Œæˆæˆ–è·³è¿‡"
        ninja -C out/HeaderGen third_party/externals/dawn/src/dawn:proc || echo "dawn_procç›®æ ‡ç¼–è¯‘å®Œæˆæˆ–è·³è¿‡"
        ninja -C out/HeaderGen third_party/externals/dawn/src/dawn/native:webgpu_dawn || echo "webgpu_dawnç›®æ ‡ç¼–è¯‘å®Œæˆæˆ–è·³è¿‡"
        
        echo "Dawnå¤´æ–‡ä»¶ç”Ÿæˆå®Œæˆ"
        
    # æ”¶é›†æ‰€æœ‰å¤´æ–‡ä»¶
    - name: æ”¶é›†å…±äº«å¤´æ–‡ä»¶
      run: |
        cd skia
        
        # åˆ›å»ºå¤´æ–‡ä»¶ç›®å½•ç»“æ„
        mkdir -p artifacts/include/include  # Skiaå¤´æ–‡ä»¶ç›®å½•
        mkdir -p artifacts/include/dawn     # Dawn WebGPUå¤´æ–‡ä»¶ç›®å½•
        mkdir -p artifacts/include/modules  # Skiaæ¨¡å—å¤´æ–‡ä»¶ç›®å½•
        
        echo "æ”¶é›†Skiaå¤´æ–‡ä»¶..."
        # å¤åˆ¶Skiaå¤´æ–‡ä»¶åˆ°include/includeç›®å½•ï¼ˆä¿æŒåŸæœ‰çš„includeç›®å½•åï¼‰
        cp -r include/* artifacts/include/include/
        
        echo "æ”¶é›†Dawn WebGPUåŸå§‹å¤´æ–‡ä»¶..."
        # å¤åˆ¶Dawn WebGPUåŸå§‹å¤´æ–‡ä»¶
        if [ -d "third_party/externals/dawn/include" ]; then
          echo "å¤åˆ¶DawnåŸå§‹å¤´æ–‡ä»¶..."
          cp -r third_party/externals/dawn/include/* artifacts/include/dawn/ 2>/dev/null || true
        fi
        
        echo "æ”¶é›†ç”Ÿæˆçš„Dawnå¤´æ–‡ä»¶..."
        # å¤åˆ¶ç”Ÿæˆçš„Dawnå¤´æ–‡ä»¶ï¼ˆè¿™äº›æ˜¯ç¼–è¯‘æ—¶ç”Ÿæˆçš„é‡è¦å¤´æ–‡ä»¶ï¼‰
        if [ -d "out/HeaderGen/gen" ]; then
          echo "æ‰¾åˆ°genç›®å½•ï¼Œå¼€å§‹æ”¶é›†ç”Ÿæˆçš„å¤´æ–‡ä»¶..."
          
          # é€’å½’æ”¶é›†æ‰€æœ‰ç”Ÿæˆçš„å¤´æ–‡ä»¶
          find out/HeaderGen/gen -name "*.h" -type f | while read header_file; do
            # è·å–ç›¸å¯¹è·¯å¾„
            relative_path=$(echo "$header_file" | sed 's|out/HeaderGen/gen/||')
            target_dir="artifacts/include/dawn/$(dirname "$relative_path")"
            
            # åˆ›å»ºç›®æ ‡ç›®å½•
            mkdir -p "$target_dir"
            
            # å¤åˆ¶å¤´æ–‡ä»¶
            cp "$header_file" "$target_dir/" 2>/dev/null || true
            echo "å¤åˆ¶ç”Ÿæˆå¤´æ–‡ä»¶: $relative_path"
          done
          
          # ç‰¹åˆ«å¤„ç†é‡è¦çš„Dawnç”Ÿæˆå¤´æ–‡ä»¶
          echo "ç‰¹åˆ«å¤„ç†å…³é”®çš„Dawnç”Ÿæˆå¤´æ–‡ä»¶..."
          find out/HeaderGen/gen -name "webgpu_cpp.h" -exec cp {} artifacts/include/dawn/ \; 2>/dev/null && echo "æ‰¾åˆ°å¹¶å¤åˆ¶ webgpu_cpp.h" || true
          find out/HeaderGen/gen -name "webgpu.h" -exec cp {} artifacts/include/dawn/ \; 2>/dev/null && echo "æ‰¾åˆ°å¹¶å¤åˆ¶ webgpu.h" || true
          find out/HeaderGen/gen -name "dawn_proc.h" -exec cp {} artifacts/include/dawn/ \; 2>/dev/null && echo "æ‰¾åˆ°å¹¶å¤åˆ¶ dawn_proc.h" || true
          find out/HeaderGen/gen -name "dawn_thread_dispatch_proc.h" -exec cp {} artifacts/include/dawn/ \; 2>/dev/null && echo "æ‰¾åˆ°å¹¶å¤åˆ¶ dawn_thread_dispatch_proc.h" || true
          find out/HeaderGen/gen -name "dawn_proc_table.h" -exec cp {} artifacts/include/dawn/ \; 2>/dev/null && echo "æ‰¾åˆ°å¹¶å¤åˆ¶ dawn_proc_table.h" || true
          
          # æ”¶é›†webgpuç›®å½•ä¸‹çš„ç”Ÿæˆå¤´æ–‡ä»¶
          if [ -d "out/HeaderGen/gen/include/webgpu" ]; then
            echo "å¤åˆ¶webgpuç›®å½•ä¸‹çš„ç”Ÿæˆå¤´æ–‡ä»¶..."
            mkdir -p artifacts/include/dawn/webgpu
            cp -r out/HeaderGen/gen/include/webgpu/* artifacts/include/dawn/webgpu/ 2>/dev/null || true
          fi
          
          # æ”¶é›†dawnç›®å½•ä¸‹çš„ç”Ÿæˆå¤´æ–‡ä»¶
          if [ -d "out/HeaderGen/gen/include/dawn" ]; then
            echo "å¤åˆ¶dawnç›®å½•ä¸‹çš„ç”Ÿæˆå¤´æ–‡ä»¶..."
            mkdir -p artifacts/include/dawn/dawn
            cp -r out/HeaderGen/gen/include/dawn/* artifacts/include/dawn/dawn/ 2>/dev/null || true
          fi
        else
          echo "è­¦å‘Šï¼šæœªæ‰¾åˆ°genç›®å½•ï¼Œå¯èƒ½Dawnå¤´æ–‡ä»¶ç”Ÿæˆå¤±è´¥"
        fi
        
        echo "æ”¶é›†Skiaæ¨¡å—å¤´æ–‡ä»¶..."
        # å¤åˆ¶modulesç›®å½•
        if [ -d "modules" ]; then
          cp -r modules/* artifacts/include/modules/ 2>/dev/null || true
        fi
        
        # æ˜¾ç¤ºæ”¶é›†åˆ°çš„Dawnå¤´æ–‡ä»¶ç»Ÿè®¡
        echo "=== æ”¶é›†åˆ°çš„Dawnå¤´æ–‡ä»¶ç»Ÿè®¡ ==="
        dawn_header_count=$(find artifacts/include/dawn -name "*.h" | wc -l)
        echo "Dawnå¤´æ–‡ä»¶æ€»æ•°: $dawn_header_count"
        
        echo "å…³é”®Dawnå¤´æ–‡ä»¶æ£€æŸ¥:"
        [ -f "artifacts/include/dawn/webgpu_cpp.h" ] && echo "âœ… webgpu_cpp.h å­˜åœ¨" || echo "âŒ webgpu_cpp.h ç¼ºå¤±"
        [ -f "artifacts/include/dawn/webgpu.h" ] && echo "âœ… webgpu.h å­˜åœ¨" || echo "âŒ webgpu.h ç¼ºå¤±"
        [ -f "artifacts/include/dawn/dawn_proc.h" ] && echo "âœ… dawn_proc.h å­˜åœ¨" || echo "âŒ dawn_proc.h ç¼ºå¤±"
        
        echo "Dawnå¤´æ–‡ä»¶ç›®å½•ç»“æ„:"
        find artifacts/include/dawn -type d | head -20
        
        echo "âœ… å…±äº«å¤´æ–‡ä»¶æ”¶é›†å®Œæˆ"
        
    # ä¸Šä¼ å…±äº«å¤´æ–‡ä»¶
    - name: ä¸Šä¼ å…±äº«å¤´æ–‡ä»¶
      uses: actions/upload-artifact@v4
      with:
        name: shared-headers
        path: skia/artifacts/
        retention-days: 30

  # åˆ›å»ºç»Ÿä¸€çš„Skiaæ„å»ºåŒ…
  create-unified-package:
    needs: [build-skia, collect-headers]
    runs-on: ubuntu-latest
    
    steps:
    # æ£€å‡ºä»£ç ä»“åº“
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # ä¸‹è½½æ‰€æœ‰å¹³å°çš„æ„å»ºäº§ç‰©
    - name: ä¸‹è½½æ‰€æœ‰æ„å»ºäº§ç‰©
      uses: actions/download-artifact@v4
      with:
        path: artifacts
        
    # åˆ›å»ºç»Ÿä¸€çš„SkiaåŒ…ç»“æ„
    - name: åˆ›å»ºç»Ÿä¸€SkdnåŒ…
      run: |
        # åˆ›å»ºSkdnåŒ…çš„æ ¹ç›®å½•ç»“æ„
        mkdir -p Skdn
        
        # åˆå¹¶æ‰€æœ‰å¹³å°çš„æ„å»ºäº§ç‰©
        echo "åˆå¹¶å¹³å°æ„å»ºäº§ç‰©..."
        for artifact_dir in artifacts/*/; do
          if [ -d "$artifact_dir" ] && [[ ! "$artifact_dir" =~ shared-headers ]]; then
            echo "å¤„ç†æ„å»ºäº§ç‰©: $artifact_dir"
            if [ -d "$artifact_dir/bin" ]; then
              cp -r "$artifact_dir/bin" Skdn/ 2>/dev/null || true
            fi
            if [ -d "$artifact_dir/lib" ]; then
              cp -r "$artifact_dir/lib" Skdn/ 2>/dev/null || true
            fi
          fi
        done
        
        # å¤åˆ¶å…±äº«å¤´æ–‡ä»¶
        echo "å¤åˆ¶å…±äº«å¤´æ–‡ä»¶..."
        if [ -d "artifacts/shared-headers/include" ]; then
          cp -r artifacts/shared-headers/include Skdn/
        fi
        
        # åˆ›å»ºç¤ºä¾‹ç›®å½•
        mkdir -p Skdn/examples
        
        echo "âœ… ç»Ÿä¸€SkdnåŒ…ç»“æ„åˆ›å»ºå®Œæˆ"
        
        # æ˜¾ç¤ºæœ€ç»ˆçš„ç›®å½•ç»“æ„
        echo "æœ€ç»ˆç›®å½•ç»“æ„:"
        find Skdn -type d | head -20
        
        # éªŒè¯Dawnå¤´æ–‡ä»¶æ˜¯å¦æ­£ç¡®å¤åˆ¶
        echo "Dawnå¤´æ–‡ä»¶éªŒè¯:"
        dawn_header_count=$(find Skdn/include/dawn -name "*.h" 2>/dev/null | wc -l)
        echo "Dawnå¤´æ–‡ä»¶æ€»æ•°: $dawn_header_count"
        
        echo "å…³é”®Dawnå¤´æ–‡ä»¶æ£€æŸ¥:"
        [ -f "Skdn/include/dawn/webgpu_cpp.h" ] && echo "âœ… webgpu_cpp.h å­˜åœ¨" || echo "âŒ webgpu_cpp.h ç¼ºå¤±"
        [ -f "Skdn/include/dawn/webgpu.h" ] && echo "âœ… webgpu.h å­˜åœ¨" || echo "âŒ webgpu.h ç¼ºå¤±"
        [ -f "Skdn/include/dawn/dawn_proc.h" ] && echo "âœ… dawn_proc.h å­˜åœ¨" || echo "âŒ dawn_proc.h ç¼ºå¤±"
        
    # ç”Ÿæˆç»Ÿä¸€çš„CMakeLists.txtæ–‡ä»¶
    - name: ç”Ÿæˆç»Ÿä¸€CMakeLists.txt
      run: |
        cat > Skdn/CMakeLists.txt << 'EOF'
        # Skia + Dawn WebGPU é¢„ç¼–è¯‘åº“çš„CMakeé…ç½®æ–‡ä»¶
        cmake_minimum_required(VERSION 3.20)
        
        # è®¾ç½®é¡¹ç›®ä¿¡æ¯
        project(SkdnPrebuilt
            VERSION 1.0.0
            DESCRIPTION "å®Œæ•´é¢„ç¼–è¯‘çš„Skiaå›¾å½¢åº“é›†æˆDawn WebGPUæ”¯æŒ"
            LANGUAGES CXX C
        )
        
        # è®¾ç½®C++æ ‡å‡†ä¸ºC++20ï¼ˆDawn WebGPUéœ€è¦C++20ç‰¹æ€§ï¼‰
        set(CMAKE_CXX_STANDARD 20)
        set(CMAKE_CXX_STANDARD_REQUIRED ON)
        set(CMAKE_CXX_EXTENSIONS OFF)
        
        # è·å–å½“å‰ç›®å½•
        get_filename_component(SKDN_ROOT_DIR "${CMAKE_CURRENT_LIST_DIR}" ABSOLUTE)
        
        # åˆ›å»ºSkdn::Skdnæ¥å£åº“
        add_library(Skdn INTERFACE)
        add_library(Skdn::Skdn ALIAS Skdn)
        
        # è®¾ç½®å…±äº«å¤´æ–‡ä»¶åŒ…å«ç›®å½•
        target_include_directories(Skdn INTERFACE
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}/include>
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}/include/include>   # Skiaå¤´æ–‡ä»¶
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}/include/dawn>      # Dawn WebGPUå¤´æ–‡ä»¶
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}/include/modules>   # Skiaæ¨¡å—å¤´æ–‡ä»¶
            $<INSTALL_INTERFACE:include>
            $<INSTALL_INTERFACE:include/include>
            $<INSTALL_INTERFACE:include/dawn>
            $<INSTALL_INTERFACE:include/modules>
        )
        
        # æ£€æµ‹å½“å‰å¹³å°å’Œæ¶æ„
        if(WIN32)
            set(SKDN_PLATFORM "Win")
            if(CMAKE_SIZEOF_VOID_P EQUAL 8)
                set(SKDN_ARCH "x64")
            else()
                set(SKDN_ARCH "x86")
            endif()
        elseif(APPLE)
            # macOSæš‚æ—¶ä¸æ”¯æŒï¼Œæ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
            message(WARNING "macOSå¹³å°æš‚æ—¶ä¸è¢«æ”¯æŒï¼Œæ­£åœ¨è§£å†³C++20å…¼å®¹æ€§é—®é¢˜")
            message(WARNING "è¯·ä½¿ç”¨Windowsã€Linuxæˆ–Androidç‰ˆæœ¬")
            return()
        elseif(ANDROID)
            set(SKDN_PLATFORM "Android")
            if(CMAKE_ANDROID_ARCH_ABI STREQUAL "arm64-v8a")
                set(SKDN_ARCH "arm64")
            elseif(CMAKE_ANDROID_ARCH_ABI STREQUAL "x86_64")
                set(SKDN_ARCH "x64")
            else()
                set(SKDN_ARCH "x64")
            endif()
        else()
            set(SKDN_PLATFORM "Linux")
            if(CMAKE_SIZEOF_VOID_P EQUAL 8)
                set(SKDN_ARCH "x64")
            else()
                set(SKDN_ARCH "x86")
            endif()
        endif()
        
        # è®¾ç½®å¹³å°ç‰¹å®šçš„åº“å’ŒäºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„
        set(SKDN_LIB_DIR "${SKDN_ROOT_DIR}/lib/${SKDN_PLATFORM}/${SKDN_ARCH}")
        set(SKDN_BIN_DIR "${SKDN_ROOT_DIR}/bin/${SKDN_PLATFORM}/${SKDN_ARCH}")
        
        # æ£€æŸ¥åº“ç›®å½•æ˜¯å¦å­˜åœ¨
        if(NOT EXISTS "${SKDN_LIB_DIR}")
            message(WARNING "Skdnåº“ç›®å½•ä¸å­˜åœ¨: ${SKDN_LIB_DIR}")
            message(STATUS "å½“å‰å¹³å°: ${SKDN_PLATFORM}, æ¶æ„: ${SKDN_ARCH}")
            # å°è¯•æŸ¥æ‰¾å¯ç”¨çš„å¹³å°ç›®å½•
            file(GLOB AVAILABLE_PLATFORMS "${SKDN_ROOT_DIR}/lib/*")
            if(AVAILABLE_PLATFORMS)
                message(STATUS "å¯ç”¨çš„å¹³å°ç›®å½•:")
                foreach(platform_dir ${AVAILABLE_PLATFORMS})
                    get_filename_component(platform_name "${platform_dir}" NAME)
                    file(GLOB AVAILABLE_ARCHS "${platform_dir}/*")
                    foreach(arch_dir ${AVAILABLE_ARCHS})
                        get_filename_component(arch_name "${arch_dir}" NAME)
                        message(STATUS "  - ${platform_name}/${arch_name}")
                    endforeach()
                endforeach()
            endif()
        endif()
        
        # æŸ¥æ‰¾æ‰€æœ‰åº“æ–‡ä»¶ï¼ˆæŒ‰é‡è¦æ€§æ’åºï¼‰
        file(GLOB SKDN_SKIA_LIBRARIES 
            "${SKDN_LIB_DIR}/skia*.lib" 
            "${SKDN_LIB_DIR}/skia*.a"
            "${SKDN_LIB_DIR}/libskia*.lib" 
            "${SKDN_LIB_DIR}/libskia*.a"
        )
        file(GLOB SKDN_GRAPHITE_LIBRARIES 
            "${SKDN_LIB_DIR}/*graphite*.lib" 
            "${SKDN_LIB_DIR}/*graphite*.a"
        )
        file(GLOB SKDN_DAWN_LIBRARIES 
            "${SKDN_LIB_DIR}/dawn*.lib" 
            "${SKDN_LIB_DIR}/dawn*.a"
            "${SKDN_LIB_DIR}/*dawn*.lib" 
            "${SKDN_LIB_DIR}/*dawn*.a"
            "${SKDN_LIB_DIR}/webgpu*.lib" 
            "${SKDN_LIB_DIR}/webgpu*.a"
        )
        file(GLOB SKDN_OTHER_LIBRARIES "${SKDN_LIB_DIR}/*.lib" "${SKDN_LIB_DIR}/*.a")
        
        # åˆå¹¶æ‰€æœ‰åº“æ–‡ä»¶
        set(SKDN_LIBRARIES ${SKDN_SKIA_LIBRARIES} ${SKDN_GRAPHITE_LIBRARIES} ${SKDN_DAWN_LIBRARIES})
        # æ·»åŠ å…¶ä»–åº“æ–‡ä»¶ï¼Œé¿å…é‡å¤
        foreach(lib ${SKDN_OTHER_LIBRARIES})
            list(FIND SKDN_LIBRARIES ${lib} found_index)
            if(found_index EQUAL -1)
                list(APPEND SKDN_LIBRARIES ${lib})
            endif()
        endforeach()
        
        if(NOT SKDN_LIBRARIES)
            message(WARNING "åœ¨ ${SKDN_LIB_DIR} ä¸­æœªæ‰¾åˆ°åº“æ–‡ä»¶")
            # åˆ—å‡ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ç”¨äºè°ƒè¯•
            file(GLOB DEBUG_FILES "${SKDN_LIB_DIR}/*")
            message(STATUS "ç›®å½•ä¸­çš„æ–‡ä»¶:")
            foreach(debug_file ${DEBUG_FILES})
                get_filename_component(debug_filename "${debug_file}" NAME)
                message(STATUS "  - ${debug_filename}")
            endforeach()
        endif()
        
        # æ ¹æ®å¹³å°è®¾ç½®ç‰¹å®šçš„é“¾æ¥åº“å’Œç¼–è¯‘é€‰é¡¹
        if(WIN32)
            # Windowså¹³å°é…ç½® - å¯ç”¨DirectXã€Vulkanã€OpenGLæ”¯æŒ
            target_compile_definitions(Skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_DAWN=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_WIN=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                UNICODE
                _UNICODE
                WEBGPU_IMPLEMENTATION_DAWN=1
            )
            
            # è®¾ç½®MSVCç‰¹å®šçš„ç¼–è¯‘é€‰é¡¹
            target_compile_options(Skdn INTERFACE
                $<$<CXX_COMPILER_ID:MSVC>:/utf-8>        # ä½¿ç”¨UTF-8ç¼–ç 
                $<$<CXX_COMPILER_ID:MSVC>:/permissive->  # ä¸¥æ ¼C++æ ‡å‡†ç¬¦åˆæ€§
                $<$<CXX_COMPILER_ID:MSVC>:/Zc:__cplusplus> # æ­£ç¡®è®¾ç½®__cpluspluså®
                $<$<CONFIG:Debug>:/MDd>
                $<$<CONFIG:Release>:/MD>
                $<$<CONFIG:RelWithDebInfo>:/MD>
                $<$<CONFIG:MinSizeRel>:/MD>
            )
            
            # ç§»é™¤MSVCä¸æ”¯æŒçš„LTOé€‰é¡¹ï¼Œè®¾ç½®é€‚å½“çš„ä¼˜åŒ–
            target_compile_options(Skdn INTERFACE
                $<$<CONFIG:Debug>:/Od>
                $<$<CONFIG:Release>:/O2 /DNDEBUG>
                $<$<CONFIG:RelWithDebInfo>:/O2 /DNDEBUG>
            )
            
            # æ·»åŠ Windowsç³»ç»Ÿåº“ï¼ˆåŒ…å«DirectXå’Œå…¶ä»–å›¾å½¢APIï¼‰
            target_link_libraries(Skdn INTERFACE
                ${SKDN_LIBRARIES}
                # OpenGLç›¸å…³
                OpenGL32
                # DirectXç›¸å…³
                d3d11
                d3d12
                dxgi
                d3dcompiler
                dxguid
                dxcore
                # ç³»ç»Ÿåº“
                Gdi32
                User32
                Kernel32
                Ole32
                OleAut32
                Uuid
                Advapi32
                Shell32
                # å­—ä½“å’Œæ–‡æœ¬
                Usp10
                # ç½‘ç»œ
                Ws2_32
                # å¤šåª’ä½“
                winmm
                # é¢å¤–çš„ç³»ç»Ÿåº“
                Imm32
                Version
                Bcrypt
            )
            
        elseif(ANDROID)
            # Androidå¹³å°é…ç½® - å¯ç”¨Vulkanã€OpenGL ESæ”¯æŒ
            target_compile_definitions(Skdn INTERFACE
                ANDROID
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_DAWN=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_ANDROID=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                __ANDROID_API__=21
                WEBGPU_IMPLEMENTATION_DAWN=1
            )
            
            target_compile_options(Skdn INTERFACE
                -fPIC
                -fno-rtti
                -fno-exceptions
                $<$<CXX_COMPILER_ID:Clang>:-fcolor-diagnostics>
            )
            
            target_link_libraries(Skdn INTERFACE
                ${SKDN_LIBRARIES}
                # OpenGL ESç›¸å…³
                GLESv2
                GLESv3
                EGL
                # Vulkanç›¸å…³
                vulkan
                # Androidç³»ç»Ÿåº“
                android
                log
                jnigraphics
                # åª’ä½“ç›¸å…³
                mediandk
                # ç³»ç»Ÿåº“
                dl
                m
                z
            )
            
            # Androidç‰¹å®šçš„é“¾æ¥é€‰é¡¹
            target_link_options(Skdn INTERFACE
                -Wl,--gc-sections
                -Wl,--as-needed
            )
            
        else()
            # Linuxå¹³å°é…ç½® - å¯ç”¨Vulkanã€OpenGLã€X11ã€Waylandæ”¯æŒ
            target_compile_definitions(Skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_DAWN=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_UNIX=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                WEBGPU_IMPLEMENTATION_DAWN=1
            )
            
            # è®¾ç½®GCCå’ŒClangç‰¹å®šçš„ç¼–è¯‘é€‰é¡¹
            target_compile_options(Skdn INTERFACE
                $<$<CXX_COMPILER_ID:GNU>:-fdiagnostics-color=always>
                $<$<CXX_COMPILER_ID:Clang>:-fcolor-diagnostics>
                $<$<CXX_COMPILER_ID:Clang>:-stdlib=libc++>
            )
            
            # Linuxå¹³å°çš„LTOæ”¯æŒ
            target_compile_options(Skdn INTERFACE
                $<$<CONFIG:Debug>:-g -O0>
                $<$<CONFIG:Release>:-O3 -DNDEBUG -flto>
                $<$<CONFIG:RelWithDebInfo>:-O2 -g -DNDEBUG -flto>
            )
            
            target_link_options(Skdn INTERFACE
                $<$<CONFIG:Release>:-flto>
                $<$<CONFIG:RelWithDebInfo>:-flto>
            )
            
            # æŸ¥æ‰¾å¿…è¦çš„ç³»ç»Ÿåº“
            find_package(PkgConfig QUIET)
            if(PKG_CONFIG_FOUND)
                pkg_check_modules(FONTCONFIG QUIET fontconfig)
                pkg_check_modules(HARFBUZZ QUIET harfbuzz)
                pkg_check_modules(WAYLAND QUIET wayland-client wayland-server wayland-egl)
            endif()
            
            # æŸ¥æ‰¾Vulkan
            find_package(Vulkan QUIET)
            
            # æŸ¥æ‰¾X11ç›¸å…³åº“
            find_package(X11 QUIET)
            
            target_link_libraries(Skdn INTERFACE
                ${SKDN_LIBRARIES}
                # OpenGL
                GL
                # ç³»ç»Ÿåº“
                pthread
                dl
                m
                # Clangä½¿ç”¨libc++æ—¶éœ€è¦çš„åº“
                $<$<CXX_COMPILER_ID:Clang>:c++>
                $<$<CXX_COMPILER_ID:Clang>:c++abi>
            )
            
            # FontConfigæ”¯æŒ
            if(FONTCONFIG_FOUND)
                target_link_libraries(Skdn INTERFACE ${FONTCONFIG_LIBRARIES})
                target_include_directories(Skdn INTERFACE ${FONTCONFIG_INCLUDE_DIRS})
            endif()
            
            # HarfBuzzæ”¯æŒ
            if(HARFBUZZ_FOUND)
                target_link_libraries(Skdn INTERFACE ${HARFBUZZ_LIBRARIES})
                target_include_directories(Skdn INTERFACE ${HARFBUZZ_INCLUDE_DIRS})
            endif()
            
            # æ·»åŠ Vulkanæ”¯æŒ
            if(Vulkan_FOUND)
                target_link_libraries(Skdn INTERFACE ${Vulkan_LIBRARIES})
                target_include_directories(Skdn INTERFACE ${Vulkan_INCLUDE_DIRS})
            endif()
            
            # æ·»åŠ X11æ”¯æŒ
            if(X11_FOUND)
                target_link_libraries(Skdn INTERFACE
                    ${X11_LIBRARIES}
                    ${X11_Xrandr_LIB}
                    ${X11_Xinerama_LIB}
                    ${X11_Xcursor_LIB}
                    ${X11_Xi_LIB}
                )
                target_include_directories(Skdn INTERFACE ${X11_INCLUDE_DIR})
            endif()
            
            # æ·»åŠ Waylandæ”¯æŒ
            if(WAYLAND_FOUND)
                target_link_libraries(Skdn INTERFACE ${WAYLAND_LIBRARIES})
                target_include_directories(Skdn INTERFACE ${WAYLAND_INCLUDE_DIRS})
            endif()
        endif()
        
        # è®¾ç½®ç¼–è¯‘é€‰é¡¹
        target_compile_features(Skdn INTERFACE cxx_std_20)
        
        # è®¾ç½®é¢„å¤„ç†å™¨å®šä¹‰
        target_compile_definitions(Skdn INTERFACE
            $<$<CONFIG:Debug>:SK_DEBUG>
            $<$<CONFIG:Release>:SK_RELEASE>
        )
        
        # è¾“å‡ºè¯¦ç»†é…ç½®ä¿¡æ¯
        message(STATUS "Skdné…ç½®ä¿¡æ¯:")
        message(STATUS "  å¹³å°: ${SKDN_PLATFORM}")
        message(STATUS "  æ¶æ„: ${SKDN_ARCH}")
        message(STATUS "  C++æ ‡å‡†: C++20ï¼ˆDawn WebGPUè¦æ±‚ï¼‰")
        message(STATUS "  ç¼–è¯‘å™¨: ${CMAKE_CXX_COMPILER_ID} ${CMAKE_CXX_COMPILER_VERSION}")
        message(STATUS "  åº“ç›®å½•: ${SKDN_LIB_DIR}")
        message(STATUS "  äºŒè¿›åˆ¶ç›®å½•: ${SKDN_BIN_DIR}")
        message(STATUS "  å¤´æ–‡ä»¶ç›®å½•: ${SKDN_ROOT_DIR}/include")
        message(STATUS "  GPUåç«¯: Ganesh + Graphite + Dawn WebGPU")
        
        if(SKDN_LIBRARIES)
            list(LENGTH SKDN_LIBRARIES lib_count)
            message(STATUS "  æ‰¾åˆ°çš„åº“æ–‡ä»¶æ•°é‡: ${lib_count}")
            message(STATUS "  æ ¸å¿ƒåº“æ–‡ä»¶:")
            foreach(lib ${SKDN_SKIA_LIBRARIES})
                get_filename_component(lib_name "${lib}" NAME)
                message(STATUS "    Skia - ${lib_name}")
            endforeach()
            foreach(lib ${SKDN_GRAPHITE_LIBRARIES})
                get_filename_component(lib_name "${lib}" NAME)
                message(STATUS "    Graphite - ${lib_name}")
            endforeach()
            foreach(lib ${SKDN_DAWN_LIBRARIES})
                get_filename_component(lib_name "${lib}" NAME)
                message(STATUS "    Dawn - ${lib_name}")
            endforeach()
        else()
            message(WARNING "  æœªæ‰¾åˆ°ä»»ä½•åº“æ–‡ä»¶!")
        endif()
        EOF
        
    # åˆ›å»ºæ„å»ºä¿¡æ¯æ–‡ä»¶
    - name: åˆ›å»ºæ„å»ºä¿¡æ¯æ–‡ä»¶
      run: |
        cat > Skdn/BUILD_INFO.txt << EOF
        Skia + Dawn WebGPU å…¨å¹³å°é¢„ç¼–è¯‘åº“ï¼ˆå®Œæ•´ç”Ÿæˆå¤´æ–‡ä»¶æ”¯æŒï¼‰
        ==========================================================
        
        é‡è¦æ›´æ–°:
        =========
        âœ… ä¿®å¤äº†Dawnç¼–è¯‘ç”Ÿæˆå¤´æ–‡ä»¶æ”¶é›†é—®é¢˜
        âœ… å®Œæ•´çš„webgpu_cpp.hç­‰å…³é”®ç”Ÿæˆå¤´æ–‡ä»¶ç°å·²åŒ…å«
        âœ… é€’å½’æ”¶é›†æ‰€æœ‰genç›®å½•ä¸‹çš„ç”Ÿæˆå¤´æ–‡ä»¶
        âœ… è¯¦ç»†çš„å¤´æ–‡ä»¶éªŒè¯å’Œç»Ÿè®¡ä¿¡æ¯
        
        ç›®å½•ç»“æ„:
        =========
        Skdn/
        â”œâ”€â”€ bin/                   # äºŒè¿›åˆ¶æ–‡ä»¶ç›®å½•ï¼ˆæŒ‰å¹³å°ç»„ç»‡ï¼‰
        â”‚   â”œâ”€â”€ Win/x64/          # Windows x64 äºŒè¿›åˆ¶æ–‡ä»¶
        â”‚   â”œâ”€â”€ Linux/x64/        # Linux x64 äºŒè¿›åˆ¶æ–‡ä»¶
        â”‚   â””â”€â”€ Android/          # Android äºŒè¿›åˆ¶æ–‡ä»¶
        â”‚       â”œâ”€â”€ x64/
        â”‚       â””â”€â”€ arm64/
        â”œâ”€â”€ lib/                   # åº“æ–‡ä»¶ç›®å½•ï¼ˆæŒ‰å¹³å°ç»„ç»‡ï¼‰
        â”‚   â”œâ”€â”€ Win/x64/          # Windows x64 åº“æ–‡ä»¶
        â”‚   â”œâ”€â”€ Linux/x64/        # Linux x64 åº“æ–‡ä»¶
        â”‚   â””â”€â”€ Android/          # Android åº“æ–‡ä»¶
        â”‚       â”œâ”€â”€ x64/
        â”‚       â””â”€â”€ arm64/
        â”œâ”€â”€ include/               # å…±äº«å¤´æ–‡ä»¶ç›®å½•
        â”‚   â”œâ”€â”€ include/          # Skiaå¤´æ–‡ä»¶ï¼ˆä¿æŒåŸæœ‰includeç›®å½•åï¼‰
        â”‚   â”œâ”€â”€ dawn/             # Dawn WebGPUå¤´æ–‡ä»¶ï¼ˆåŒ…å«æ‰€æœ‰ç”Ÿæˆæ–‡ä»¶ï¼‰
        â”‚   â””â”€â”€ modules/          # Skiaæ¨¡å—å¤´æ–‡ä»¶
        â”œâ”€â”€ CMakeLists.txt         # æ™ºèƒ½CMakeé…ç½®
        â””â”€â”€ BUILD_INFO.txt         # æ„å»ºä¿¡æ¯æ–‡æ¡£
        
        Dawnå¤´æ–‡ä»¶å®Œæ•´è¯´æ˜:
        ===================
        ç°åœ¨åŒ…å«å®Œæ•´çš„Dawn WebGPUå¤´æ–‡ä»¶ï¼š
        
        åŸå§‹å¤´æ–‡ä»¶:
        - ä»third_party/externals/dawn/includeå¤åˆ¶çš„æºç å¤´æ–‡ä»¶
        
        ç”Ÿæˆå¤´æ–‡ä»¶ï¼ˆå…³é”®ä¿®å¤ï¼‰:
        - webgpu_cpp.h           # C++ WebGPU APIç»‘å®šï¼ˆä¿®å¤ç¼ºå¤±é—®é¢˜ï¼‰
        - webgpu.h               # C WebGPU API
        - dawn_proc.h            # Dawnè¿‡ç¨‹è¡¨
        - dawn_thread_dispatch_proc.h  # çº¿ç¨‹åˆ†å‘è¿‡ç¨‹è¡¨
        - dawn_proc_table.h      # è¿‡ç¨‹è¡¨å®šä¹‰
        - ä»¥åŠæ‰€æœ‰å…¶ä»–ç”Ÿæˆçš„ç»‘å®šå¤´æ–‡ä»¶
        
        ç›®å½•ç»„ç»‡:
        - include/dawn/          # æ‰å¹³åŒ–çš„æ‰€æœ‰Dawnå¤´æ–‡ä»¶
        - include/dawn/webgpu/   # WebGPUç›¸å…³ç”Ÿæˆå¤´æ–‡ä»¶
        - include/dawn/dawn/     # Dawnç›¸å…³ç”Ÿæˆå¤´æ–‡ä»¶
        
        æ„å»ºä¿¡æ¯:
        =========
        âœ… Windows x64 - å®Œå…¨æ”¯æŒï¼ˆDirectX 11/12 + Vulkan + OpenGLï¼‰
        âœ… Linux x64 - å®Œå…¨æ”¯æŒï¼ˆVulkan + OpenGL + X11 + Waylandï¼‰
        âœ… Android x64/ARM64 - å®Œå…¨æ”¯æŒï¼ˆVulkan + OpenGL ESï¼‰
        
        CMakeä½¿ç”¨æ–¹æ³•:
        =============
        
        åŸºç¡€é›†æˆï¼š
        \`\`\`cmake
        cmake_minimum_required(VERSION 3.20)
        
        set(CMAKE_CXX_STANDARD 20)
        set(CMAKE_CXX_STANDARD_REQUIRED ON)
        
        # æ·»åŠ Skdné¢„ç¼–è¯‘åº“
        add_subdirectory(path/to/Skdn)
        
        # åˆ›å»ºä½ çš„é¡¹ç›®
        add_executable(MyApp main.cpp)
        
        # é“¾æ¥Skdnåº“ï¼ˆè‡ªåŠ¨åŒ…å«æ‰€æœ‰å¿…è¦çš„ä¾èµ–ï¼‰
        target_link_libraries(MyApp PRIVATE Skdn::Skdn)
        \`\`\`
        
        å¤´æ–‡ä»¶ä½¿ç”¨ç¤ºä¾‹ï¼ˆç°åœ¨å®Œå…¨å¯ç”¨ï¼‰:
        ================================
        \`\`\`cpp
        // Skiaæ ¸å¿ƒå¤´æ–‡ä»¶
        #include <include/core/SkCanvas.h>
        #include <include/core/SkSurface.h>
        #include <include/gpu/GrDirectContext.h>
        #include <include/gpu/graphite/Context.h>
        #include <include/gpu/graphite/Recorder.h>
        
        // Dawn WebGPUå¤´æ–‡ä»¶ï¼ˆç°åœ¨å®Œå…¨å¯ç”¨ï¼‰
        #include <webgpu/webgpu_cpp.h>    // ç”Ÿæˆçš„C++ API - ç°å·²ä¿®å¤
        #include <webgpu/webgpu.h>        // ç”Ÿæˆçš„C API
        #include <dawn/dawn_proc.h>       // ç”Ÿæˆçš„è¿‡ç¨‹è¡¨
        
        // Skiaæ¨¡å—å¤´æ–‡ä»¶
        #include <modules/skottie/include/Skottie.h>
        #include <modules/svg/include/SkSVGDOM.h>
        
        int main() {
            // éªŒè¯å®å®šä¹‰
            static_assert(SK_GANESH == 1);
            static_assert(SK_GRAPHITE == 1);
            static_assert(SK_DAWN == 1);
            static_assert(WEBGPU_IMPLEMENTATION_DAWN == 1);
            
            // åˆå§‹åŒ–Dawnè¿‡ç¨‹è¡¨ï¼ˆç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œï¼‰
            dawnProcSetProcs(&dawn::native::GetProcs());
            
            // åˆ›å»ºWebGPUå®ä¾‹ï¼ˆC++ APIç°åœ¨å®Œå…¨å¯ç”¨ï¼‰
            wgpu::InstanceDescriptor instanceDesc = {};
            wgpu::Instance instance = wgpu::CreateInstance(&instanceDesc);
            
            // ä½ çš„Skia + Dawnä»£ç ...
            return 0;
        }
        \`\`\`
        
        ç”Ÿæˆå¤´æ–‡ä»¶æ”¶é›†æµç¨‹:
        ===================
        1. é¢„ç¼–è¯‘Dawn WebGPUç›®æ ‡ä»¥ç”Ÿæˆæ‰€æœ‰å¿…è¦å¤´æ–‡ä»¶
        2. é€’å½’æ”¶é›†out/HeaderGen/genç›®å½•ä¸‹çš„æ‰€æœ‰.hæ–‡ä»¶
        3. ç‰¹åˆ«å¤„ç†å…³é”®å¤´æ–‡ä»¶ï¼ˆwebgpu_cpp.hç­‰ï¼‰
        4. ä¿æŒæ­£ç¡®çš„ç›®å½•ç»“æ„å’ŒåŒ…å«è·¯å¾„
        5. è¯¦ç»†éªŒè¯æ”¶é›†ç»“æœ
        
        è‡ªåŠ¨å¯ç”¨çš„åŠŸèƒ½:
        ===============
        \`\`\`cpp
        // GPUåç«¯å®å®šä¹‰
        #define SK_GANESH 1          // ä¼ ç»ŸGPUåç«¯
        #define SK_GRAPHITE 1        // ç°ä»£GPUåç«¯  
        #define SK_DAWN 1            // Dawn WebGPUåç«¯
        #define SK_VULKAN 1          // Vulkanæ”¯æŒ
        #define SK_GL 1              // OpenGLæ”¯æŒ
        #define WEBGPU_IMPLEMENTATION_DAWN 1  // Dawn WebGPUå®ç°
        \`\`\`
        
        ç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯:
        - Windows: MSVC 2022 + C++20æ ‡å‡†
        - Linux: GCC 13 + C++20æ ‡å‡†
        - Android: Clang 18 (NDK r25c) + C++20æ ‡å‡†
        
        åº“æ–‡ä»¶ç»„ç»‡:
        ===========
        CMakeé…ç½®ä¼šè‡ªåŠ¨æŸ¥æ‰¾å’Œé“¾æ¥ä»¥ä¸‹ç±»å‹çš„åº“æ–‡ä»¶ï¼š
        1. Skiaæ ¸å¿ƒåº“ï¼ˆskia*.lib, libskia*.aï¼‰
        2. Skia Graphiteåº“ï¼ˆ*graphite*.lib, *graphite*.aï¼‰
        3. Dawn WebGPUåº“ï¼ˆdawn*.lib, webgpu*.libç­‰ï¼‰
        4. å…¶ä»–ä¾èµ–åº“ï¼ˆè‡ªåŠ¨åŒ…å«ï¼‰
        
        ç‰¹æ®Šè¯´æ˜:
        =========
        - ç°åœ¨åŒ…å«äº†å®Œæ•´çš„ç¼–è¯‘æ—¶ç”Ÿæˆçš„Dawn WebGPUå¤´æ–‡ä»¶
        - webgpu_cpp.hç­‰å…³é”®å¤´æ–‡ä»¶ç¼ºå¤±é—®é¢˜å·²å½»åº•è§£å†³
        - è‡ªåŠ¨æ£€æµ‹å¹³å°å¹¶é“¾æ¥ç›¸åº”çš„å›¾å½¢APIåº“
        - C++20æ ‡å‡†è¦æ±‚ï¼ˆDawn WebGPUéœ€è¦ï¼‰
        - å¤´æ–‡ä»¶æ‰€æœ‰å¹³å°å…±äº«ï¼Œæ— éœ€å¹³å°ç‰¹å®šé…ç½®
        - è·¨å¹³å°ç»Ÿä¸€æ¥å£ï¼Œä¸€æ¬¡ç¼–å†™åˆ°å¤„è¿è¡Œ
        - ç”Ÿäº§ç¯å¢ƒå°±ç»ªï¼Œæ€§èƒ½ä¼˜åŒ–
        - å®Œæ•´çš„Dawn WebGPU C++ç»‘å®šæ”¯æŒ
        EOF
        
    # æ‰“åŒ…ç»Ÿä¸€çš„Skiaæ„å»ºåŒ…
    - name: æ‰“åŒ…Skdn_Prebuilt.zip
      run: |
        zip -r "Skdn_Prebuilt.zip" Skdn/
        echo "âœ… Skdn_Prebuilt.zip ç»Ÿä¸€æ„å»ºåŒ…åˆ›å»ºå®Œæˆ"
        ls -lh Skdn_Prebuilt.zip
        
    # ä¸Šä¼ ç»Ÿä¸€æ„å»ºåŒ…
    - name: ä¸Šä¼ Skdnç»Ÿä¸€æ„å»ºåŒ…
      uses: actions/upload-artifact@v4
      with:
        name: Skdn_Prebuilt
        path: Skdn_Prebuilt.zip
        retention-days: 30
        compression-level: 0

    # åˆ›å»ºGitHub Releaseå‘å¸ƒç‰ˆæœ¬
    - name: åˆ›å»ºGitHub Release
      uses: softprops/action-gh-release@v2
      with:
        tag_name: ${{ steps.get_tag.outputs.tag }}
        name: ${{ steps.get_tag.outputs.name }}
        body: |
          # Skia + Dawn WebGPU å…¨å¹³å°é¢„ç¼–è¯‘åº“ï¼ˆä¿®å¤ç”Ÿæˆå¤´æ–‡ä»¶æ”¶é›†ï¼‰
          
          è¿™æ˜¯åŒ…å«å®Œæ•´Skiaå’ŒDawn WebGPUçš„å…¨å¹³å°é¢„ç¼–è¯‘åº“ï¼Œ**å·²å½»åº•ä¿®å¤Dawnç¼–è¯‘ç”Ÿæˆå¤´æ–‡ä»¶æ”¶é›†é—®é¢˜**ï¼Œç°åœ¨åŒ…å«äº†å®Œæ•´çš„webgpu_cpp.hç­‰å…³é”®ç”Ÿæˆå¤´æ–‡ä»¶ã€‚
          
          ## ğŸ”§ é‡è¦ä¿®å¤
          
          ### âœ… Dawnç”Ÿæˆå¤´æ–‡ä»¶æ”¶é›†é—®é¢˜å·²å½»åº•è§£å†³
          - **webgpu_cpp.hç¼ºå¤±é—®é¢˜** - ç°å·²å®Œå…¨ä¿®å¤ï¼Œæ­£ç¡®æ”¶é›†ç¼–è¯‘ç”Ÿæˆçš„C++ APIå¤´æ–‡ä»¶
          - **é€’å½’æ”¶é›†æœºåˆ¶** - å®ç°äº†å¯¹out/HeaderGen/genç›®å½•çš„å®Œæ•´é€’å½’æ”¶é›†
          - **å…³é”®æ–‡ä»¶ç‰¹åˆ«å¤„ç†** - ç‰¹åˆ«æœç´¢å’Œå¤åˆ¶webgpu_cpp.hã€dawn_proc.hç­‰é‡è¦æ–‡ä»¶
          - **ç›®å½•ç»“æ„ä¿æŒ** - æ­£ç¡®ä¿æŒç”Ÿæˆå¤´æ–‡ä»¶çš„ç›®å½•ç»“æ„å’ŒåŒ…å«å…³ç³»
          - **è¯¦ç»†éªŒè¯æœºåˆ¶** - å¢åŠ äº†å®Œæ•´çš„å¤´æ–‡ä»¶æ”¶é›†éªŒè¯å’Œç»Ÿè®¡
          
          ### ğŸš€ æ”¶é›†æµç¨‹ä¼˜åŒ–
          1. **é¢„ç¼–è¯‘Dawnç›®æ ‡** - å…ˆç¼–è¯‘Dawnç›¸å…³ç›®æ ‡ä»¥ç¡®ä¿ç”Ÿæˆæ‰€æœ‰å¤´æ–‡ä»¶
          2. **å¤šç›®æ ‡ç¼–è¯‘** - ç¼–è¯‘å¤šä¸ªDawnç›®æ ‡ç¡®ä¿å®Œæ•´æ€§
          3. **é€’å½’æ–‡ä»¶æ”¶é›†** - é€’å½’æ”¶é›†æ‰€æœ‰.hæ–‡ä»¶å¹¶ä¿æŒç›®å½•ç»“æ„
          4. **å…³é”®æ–‡ä»¶éªŒè¯** - éªŒè¯webgpu_cpp.hç­‰å…³é”®æ–‡ä»¶æ˜¯å¦æ­£ç¡®æ”¶é›†
          5. **ç»Ÿè®¡ä¿¡æ¯è¾“å‡º** - æä¾›è¯¦ç»†çš„æ”¶é›†ç»Ÿè®¡å’ŒéªŒè¯ç»“æœ
          
          ## ğŸ“¦ åŒ…å«å†…å®¹
          
          **Skdn_Prebuilt.zip** - å®Œæ•´é¢„ç¼–è¯‘åº“ï¼ˆç°åŒ…å«æ‰€æœ‰Dawnç”Ÿæˆå¤´æ–‡ä»¶ï¼‰
          
          ## âœ¨ ä¸»è¦ç‰¹æ€§
          
          ### ğŸ”§ å®Œæ•´Dawn WebGPUå¤´æ–‡ä»¶æ”¯æŒ
          - **åŸå§‹å¤´æ–‡ä»¶** - Dawn WebGPUæºç å¤´æ–‡ä»¶
          - **ç”Ÿæˆå¤´æ–‡ä»¶** - ç¼–è¯‘æ—¶ç”Ÿæˆçš„å®Œæ•´å¤´æ–‡ä»¶é›†åˆ
            - `webgpu_cpp.h` - C++ WebGPU APIç»‘å®šï¼ˆç°å·²ä¿®å¤ï¼‰
            - `webgpu.h` - C WebGPU API
            - `dawn_proc.h` - Dawnè¿‡ç¨‹è¡¨
            - `dawn_thread_dispatch_proc.h` - çº¿ç¨‹åˆ†å‘è¿‡ç¨‹è¡¨
            - `dawn_proc_table.h` - è¿‡ç¨‹è¡¨å®šä¹‰
            - æ‰€æœ‰å…¶ä»–ç”Ÿæˆçš„ç»‘å®šå¤´æ–‡ä»¶
          
          ### ğŸ® å¤šå›¾å½¢APIæ”¯æŒ
          - **Windows**: DirectX 11/12 + Vulkan + OpenGL
          - **Linux**: Vulkan + OpenGL + X11 + Wayland
          - **Android**: Vulkan + OpenGL ES + EGL
          
          ### ğŸš€ ç°ä»£æŠ€æœ¯æ ˆ
          - **C++20æ ‡å‡†** - å®Œæ•´çš„ç°ä»£C++ç‰¹æ€§æ”¯æŒ
          - **ä¸‰é‡GPUåç«¯** - Ganesh + Graphite + Dawn WebGPU
          - **æ™ºèƒ½CMakeé…ç½®** - è‡ªåŠ¨å¹³å°æ£€æµ‹å’Œåº“é“¾æ¥
          
          ## ğŸ“‹ å¿«é€Ÿå¼€å§‹
          
          ### 1. ä¸‹è½½å’Œè§£å‹
          ```bash
          # ä¸‹è½½Skdn_Prebuilt.zipå¹¶è§£å‹åˆ°é¡¹ç›®ç›®å½•
          unzip Skdn_Prebuilt.zip -d third_party/
          ```
          
          ### 2. CMakeé›†æˆ
          ```cmake
          cmake_minimum_required(VERSION 3.20)
          project(MyApp)
          
          # è®¾ç½®C++20æ ‡å‡†
          set(CMAKE_CXX_STANDARD 20)
          set(CMAKE_CXX_STANDARD_REQUIRED ON)
          
          # æ·»åŠ Skdnåº“
          add_subdirectory(third_party/Skdn)
          
          # åˆ›å»ºä½ çš„åº”ç”¨
          add_executable(MyApp src/main.cpp)
          
          # é“¾æ¥Skdnåº“ï¼ˆè‡ªåŠ¨åŒ…å«æ‰€æœ‰ä¾èµ–ï¼‰
          target_link_libraries(MyApp PRIVATE Skdn::Skdn)
          ```
          
          ### 3. å®Œæ•´ä½¿ç”¨ç¤ºä¾‹ï¼ˆç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œï¼‰
          ```cpp
          // Skiaæ ¸å¿ƒå¤´æ–‡ä»¶
          #include <include/core/SkCanvas.h>
          #include <include/core/SkSurface.h>
          #include <include/gpu/GrDirectContext.h>
          #include <include/gpu/graphite/Context.h>
          #include <include/gpu/graphite/Recorder.h>
          
          // Dawn WebGPUå¤´æ–‡ä»¶ï¼ˆç°åœ¨å®Œå…¨å¯ç”¨ï¼‰
          #include <webgpu/webgpu_cpp.h>    // ç”Ÿæˆçš„C++ API - ä¿®å¤å®Œæˆ
          #include <webgpu/webgpu.h>        // ç”Ÿæˆçš„C API
          #include <dawn/dawn_proc.h>       // ç”Ÿæˆçš„è¿‡ç¨‹è¡¨
          
          int main() {
              // è‡ªåŠ¨å¯ç”¨çš„å®å®šä¹‰æ£€æŸ¥
              static_assert(SK_GANESH == 1);
              static_assert(SK_GRAPHITE == 1);
              static_assert(SK_DAWN == 1);
              static_assert(WEBGPU_IMPLEMENTATION_DAWN == 1);
              
              // åˆå§‹åŒ–Dawnè¿‡ç¨‹è¡¨ï¼ˆç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œï¼‰
              dawnProcSetProcs(&dawn::native::GetProcs());
              
              // åˆ›å»ºWebGPUå®ä¾‹ï¼ˆC++ APIç°åœ¨å®Œå…¨å¯ç”¨ï¼‰
              wgpu::InstanceDescriptor instanceDesc = {};
              wgpu::Instance instance = wgpu::CreateInstance(&instanceDesc);
              
              // è¯·æ±‚é€‚é…å™¨
              wgpu::RequestAdapterOptions adapterOpts = {};
              instance.RequestAdapter(&adapterOpts, [](WGPURequestAdapterStatus status, 
                  WGPUAdapter adapter, char const* message, void* userdata) {
                  // é€‚é…å™¨å›è°ƒå¤„ç†
              }, nullptr);
              
              // åˆ›å»ºSkia Graphiteä¸Šä¸‹æ–‡
              // ä½ çš„æ¸²æŸ“ä»£ç ...
              
              return 0;
          }
          ```
          
          ## ğŸ”§ è‡ªåŠ¨åº“é“¾æ¥
          
          CMakeé…ç½®ä¼šæ ¹æ®å¹³å°è‡ªåŠ¨é“¾æ¥ï¼š
          
          ### Windowså¹³å°
          - **Skiaåº“**: `skia*.lib`, `*graphite*.lib`
          - **Dawnåº“**: `dawn*.lib`, `webgpu*.lib`
          - **DirectXåº“**: `d3d11.lib`, `d3d12.lib`, `dxgi.lib`, `dxcore.lib`
          - **OpenGLåº“**: `OpenGL32.lib`
          - **ç³»ç»Ÿåº“**: `Gdi32.lib`, `User32.lib`, `Kernel32.lib`ç­‰
          
          ### Linuxå¹³å°
          - **Skiaåº“**: `libskia*.a`, `*graphite*.a`
          - **Dawnåº“**: `libdawn*.a`, `libwebgpu*.a`
          - **Vulkanåº“**: `libvulkan.so`
          - **OpenGLåº“**: `libGL.so`
          - **X11åº“**: `libX11.so`, `libXrandr.so`ç­‰
          - **Waylandåº“**: `libwayland-client.so`ç­‰
          
          ### Androidå¹³å°
          - **Skiaåº“**: `libskia*.a`, `*graphite*.a`
          - **Dawnåº“**: `libdawn*.a`, `libwebgpu*.a`
          - **Vulkanåº“**: `libvulkan.so`
          - **OpenGL ESåº“**: `libGLESv2.so`, `libGLESv3.so`
          - **EGLåº“**: `libEGL.so`
          - **Androidç³»ç»Ÿåº“**: `libandroid.so`, `liblog.so`ç­‰
          
          ## ğŸ—ï¸ æ”¯æŒçš„å¹³å°
          
          | å¹³å° | æ¶æ„ | ç¼–è¯‘å™¨ | ç›®å½•è·¯å¾„ |
          |------|------|--------|----------|
          | Windows | x64 | MSVC 2022 | `bin/Win/x64/`, `lib/Win/x64/` |
          | Linux | x64 | GCC 13 | `bin/Linux/x64/`, `lib/Linux/x64/` |
          | Android | x64 | Clang 18 | `bin/Android/x64/`, `lib/Android/x64/` |
          | Android | ARM64 | Clang 18 | `bin/Android/arm64/`, `lib/Android/arm64/` |
          
          ## ğŸ“ ç›®å½•ç»“æ„
          
          ```
          Skdn/
          â”œâ”€â”€ bin/                   # äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæŒ‰å¹³å°ç»„ç»‡ï¼‰
          â”‚   â”œâ”€â”€ Win/x64/          # Windows x64
          â”‚   â”œâ”€â”€ Linux/x64/        # Linux x64  
          â”‚   â””â”€â”€ Android/          # Android x64/arm64
          â”œâ”€â”€ lib/                   # åº“æ–‡ä»¶ï¼ˆæŒ‰å¹³å°ç»„ç»‡ï¼‰
          â”‚   â”œâ”€â”€ Win/x64/          # Windows x64åº“æ–‡ä»¶
          â”‚   â”œâ”€â”€ Linux/x64/        # Linux x64åº“æ–‡ä»¶
          â”‚   â””â”€â”€ Android/          # Androidåº“æ–‡ä»¶
          â”œâ”€â”€ include/               # å…±äº«å¤´æ–‡ä»¶ç›®å½•
          â”‚   â”œâ”€â”€ include/          # Skiaå¤´æ–‡ä»¶
          â”‚   â”œâ”€â”€ dawn/             # Dawn WebGPUå¤´æ–‡ä»¶ï¼ˆå®Œæ•´ç”Ÿæˆæ–‡ä»¶ï¼‰
          â”‚   â”‚   â”œâ”€â”€ webgpu/       # WebGPUç›¸å…³ç”Ÿæˆå¤´æ–‡ä»¶
          â”‚   â”‚   â”œâ”€â”€ dawn/         # Dawnç›¸å…³ç”Ÿæˆå¤´æ–‡ä»¶
          â”‚   â”‚   â”œâ”€â”€ webgpu_cpp.h  # C++ APIç»‘å®šï¼ˆä¿®å¤å®Œæˆï¼‰
          â”‚   â”‚   â”œâ”€â”€ dawn_proc.h   # è¿‡ç¨‹è¡¨ï¼ˆä¿®å¤å®Œæˆï¼‰
          â”‚   â”‚   â””â”€â”€ ...           # å…¶ä»–ç”Ÿæˆå¤´æ–‡ä»¶
          â”‚   â””â”€â”€ modules/          # Skiaæ¨¡å—å¤´æ–‡ä»¶
          â””â”€â”€ CMakeLists.txt         # æ™ºèƒ½CMakeé…ç½®
          ```
          
          ## ğŸ¯ é‡è¦æ”¹è¿›å¯¹æ¯”
          
          | é—®é¢˜ | ä¿®å¤å‰çŠ¶æ€ | ä¿®å¤åçŠ¶æ€ |
          |------|------------|------------|
          | webgpu_cpp.hç¼ºå¤± | âŒ ç¼–è¯‘é”™è¯¯ | âœ… å®Œå…¨å¯ç”¨ |
          | dawn_proc.hç¼ºå¤± | âŒ é“¾æ¥é”™è¯¯ | âœ… å®Œå…¨å¯ç”¨ |
          | ç”Ÿæˆå¤´æ–‡ä»¶æ”¶é›† | âŒ ä¸å®Œæ•´ | âœ… é€’å½’å®Œæ•´æ”¶é›† |
          | å¤´æ–‡ä»¶éªŒè¯ | âŒ æ— éªŒè¯ | âœ… è¯¦ç»†éªŒè¯ç»Ÿè®¡ |
          | Dawn C++ API | âŒ æ— æ³•ä½¿ç”¨ | âœ… å®Œå…¨æ”¯æŒ |
          
          ## ğŸ’¡ ä½¿ç”¨æŠ€å·§
          
          ### Dawn WebGPUå®Œæ•´åˆå§‹åŒ–
          ```cpp
          // è®¾ç½®Dawnè¿‡ç¨‹è¡¨ï¼ˆç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œï¼‰
          dawnProcSetProjs(&dawn::native::GetProcs());
          
          // åˆ›å»ºWebGPUå®ä¾‹
          wgpu::Instance instance = wgpu::CreateInstance();
          
          // è¯·æ±‚é€‚é…å™¨ï¼ˆå¼‚æ­¥ï¼‰
          instance.RequestAdapter(&adapterOpts, [](WGPURequestAdapterStatus status,
              WGPUAdapter result, char const* message, void* userdata) {
              if (status == WGPURequestAdapterStatus_Success) {
                  // æˆåŠŸè·å–é€‚é…å™¨
                  wgpu::Adapter adapter = wgpu::Adapter::Acquire(result);
                  // ç»§ç»­è¯·æ±‚è®¾å¤‡...
              }
          }, nullptr);
          ```
          
          ### Skia Graphiteä¸Dawné›†æˆ
          ```cpp
          // åˆ›å»ºDawnåç«¯ä¸Šä¸‹æ–‡
          skgpu::graphite::DawnBackendContext dawnContext;
          dawnContext.fDevice = device.Get();
          dawnContext.fQueue = queue.Get();
          
          // åˆ›å»ºSkia Graphiteä¸Šä¸‹æ–‡ï¼ˆç°åœ¨å®Œå…¨æ”¯æŒï¼‰
          auto context = skgpu::graphite::ContextFactory::MakeDawn(dawnContext);
          auto recorder = context->makeRecorder();
          ```
          
          ## ğŸš€ éªŒè¯ä¿®å¤ç»“æœ
          
          æ„å»ºè¿‡ç¨‹ç°åœ¨åŒ…å«è¯¦ç»†çš„éªŒè¯ï¼š
          - âœ… Dawnå¤´æ–‡ä»¶æ€»æ•°ç»Ÿè®¡
          - âœ… å…³é”®å¤´æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥
          - âœ… ç›®å½•ç»“æ„å®Œæ•´æ€§éªŒè¯
          - âœ… æ”¶é›†è¿‡ç¨‹è¯¦ç»†æ—¥å¿—
          
          ---
          
          > **ğŸ‰ é‡å¤§ä¿®å¤**: Dawn WebGPUç”Ÿæˆå¤´æ–‡ä»¶æ”¶é›†é—®é¢˜å·²å½»åº•è§£å†³ï¼webgpu_cpp.hç­‰å…³é”®æ–‡ä»¶ç°åœ¨å®Œå…¨å¯ç”¨ï¼Œæ”¯æŒå®Œæ•´çš„Dawn WebGPU C++ APIå¼€å‘ã€‚
        files: |
          Skdn_Prebuilt.zip
        draft: false
        prerelease: false
        generate_release_notes: false
        make_latest: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
