# Skia å…¨å¹³å°æ„å»ºå·¥ä½œæµï¼ˆä»…Skia + Graphiteï¼Œä¸åŒ…å«Dawnï¼‰
name: ç¼–è¯‘ Skia å…¨å¹³å°æ„å»ºåŒ…

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´ä¸Šåˆ8ç‚¹ï¼ˆUTCæ—¶é—´0ç‚¹ï¼‰æ‰§è¡Œä¸€æ¬¡
    - cron: '0 0 * * *'

# è®¾ç½®å·¥ä½œæµæƒé™
permissions:
  contents: write
  packages: write
  actions: read

jobs:
  build-skia:
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        include:
          # Windows x64æ¶æ„
          - os: windows-latest
            platform: x64_windows
            arch: x64
            target_os: win
            target_cpu: x64
            
          # macOS x64æ¶æ„
          - os: macos-latest
            platform: x64_macos
            arch: x64
            target_os: mac
            target_cpu: x64
            
          # macOS ARM64æ¶æ„
          - os: macos-latest
            platform: arm64_macos
            arch: arm64
            target_os: mac
            target_cpu: arm64
            
          # Linux x64æ¶æ„
          - os: ubuntu-latest
            platform: x64_linux
            arch: x64
            target_os: linux
            target_cpu: x64
            
          # Android x64æ¶æ„
          - os: ubuntu-latest
            platform: x64_android
            arch: x64
            target_os: android
            target_cpu: x64
            android_api: 21
            
          # Android ARM64æ¶æ„
          - os: ubuntu-latest
            platform: arm64_android
            arch: arm64
            target_os: android
            target_cpu: arm64
            android_api: 21

    steps:
    # æ£€å‡ºä»£ç ä»“åº“
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # æ¸…ç†ç£ç›˜ç©ºé—´ï¼ˆä»…é™Linuxå’ŒAndroidæ„å»ºï¼‰
    - name: æ¸…ç†ç£ç›˜ç©ºé—´
      if: runner.os == 'Linux'
      run: |
        echo "=== æ¸…ç†å‰ç£ç›˜ä½¿ç”¨æƒ…å†µ ==="
        df -h
        
        # åˆ é™¤ä¸å¿…è¦çš„è½¯ä»¶åŒ…å’Œæ–‡ä»¶
        sudo apt-get autoremove -y
        sudo apt-get autoclean
        
        # åˆ é™¤å¤§å‹ä¸å¿…è¦çš„è½¯ä»¶
        sudo rm -rf /usr/share/dotnet
        sudo rm -rf /usr/local/lib/android
        sudo rm -rf /opt/ghc
        sudo rm -rf /opt/hostedtoolcache/CodeQL
        sudo rm -rf "$AGENT_TOOLSDIRECTORY"
        
        # æ¸…ç†Dockerç›¸å…³æ–‡ä»¶
        docker system prune -a -f || true
        
        # æ¸…ç†snapåŒ…
        sudo snap list | awk 'NR>1{print $1}' | xargs -r sudo snap remove || true
        
        echo "=== æ¸…ç†åç£ç›˜ä½¿ç”¨æƒ…å†µ ==="
        df -h
        
    # è®¾ç½®Pythonè¿è¡Œç¯å¢ƒ
    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
        
    # å®‰è£…Linuxç³»ç»Ÿä¾èµ–åŒ…ï¼ˆLinuxå’ŒAndroidæ„å»ºéœ€è¦ï¼‰
    - name: å®‰è£…Linuxç³»ç»Ÿä¾èµ–
      if: runner.os == 'Linux'
      run: |
        sudo apt-get update
        
        # å®‰è£…åŸºç¡€æ„å»ºå·¥å…·
        sudo apt-get install -y build-essential ninja-build
        
        # æ£€æŸ¥Ubuntuç‰ˆæœ¬
        echo "=== æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬ ==="
        lsb_release -a
        
        # åªå®‰è£…æ ¸å¿ƒç¼–è¯‘å™¨ï¼ˆé¿å…åŒ…å†²çªï¼‰
        sudo apt-get install -y gcc g++ clang clang++
        
        # å®‰è£…C++æ ‡å‡†åº“å¼€å‘åŒ…
        sudo apt-get install -y libc++-dev libc++abi-dev || echo "libc++ å®‰è£…å¤±è´¥ï¼Œç»§ç»­ä½¿ç”¨ libstdc++"
        
        # å®‰è£…å›¾å½¢å’Œå­—ä½“ç›¸å…³ä¾èµ–
        sudo apt-get install -y libfontconfig1-dev libfreetype6-dev libgl1-mesa-dev
        
        # å®‰è£…Vulkanå¼€å‘åº“
        sudo apt-get install -y libvulkan-dev vulkan-tools || echo "Vulkan å¼€å‘åº“å®‰è£…å¤±è´¥ï¼Œç»§ç»­æ„å»º"
        
        # å®‰è£…X11ç›¸å…³åº“
        sudo apt-get install -y libxrandr-dev libxinerama-dev libxcursor-dev libxi-dev
        
        # å®‰è£…ICUå’ŒHarfBuzz
        sudo apt-get install -y libicu-dev libharfbuzz-dev
        
        # å®‰è£…pkg-configå·¥å…·
        sudo apt-get install -y pkg-config
        
        # å®‰è£…Javaå¼€å‘ç¯å¢ƒï¼ˆAndroidæ„å»ºéœ€è¦ï¼‰
        sudo apt-get install -y openjdk-11-jdk
        
        # æ˜¾ç¤ºç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯
        echo "=== ç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯ ==="
        gcc --version | head -1
        g++ --version | head -1
        clang --version | head -1
        clang++ --version | head -1
        echo "======================"
        
    # å®‰è£…macOSç³»ç»Ÿä¾èµ–
    - name: å®‰è£…macOSç³»ç»Ÿä¾èµ–
      if: runner.os == 'macOS'
      run: |
        # å®‰è£…Xcodeå‘½ä»¤è¡Œå·¥å…·
        xcode-select --install 2>/dev/null || true
        # å®‰è£…ninjaæ„å»ºå·¥å…·
        brew install ninja || true
        # éªŒè¯Xcodeç‰ˆæœ¬å¹¶ç¡®ä¿æ”¯æŒC++20
        echo "=== macOSç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯ ==="
        xcodebuild -version
        clang --version | head -1
        echo "========================="
        
    # å®‰è£…Windowsç³»ç»Ÿä¾èµ–
    - name: å®‰è£…Windowsç³»ç»Ÿä¾èµ–
      if: runner.os == 'Windows'
      run: |
        # å®‰è£…ninjaæ„å»ºå·¥å…·
        choco install ninja -y
        
    # è®¾ç½®Android NDKç¯å¢ƒï¼ˆä»…é™Androidå¹³å°ï¼‰
    - name: è®¾ç½®Android NDK
      if: matrix.target_os == 'android'
      uses: nttld/setup-ndk@v1
      with:
        ndk-version: r25c
        
    # è·å–Googleçš„depot_toolså·¥å…·é›†
    - name: è·å–depot_tools
      run: |
        git clone --depth 1 https://chromium.googlesource.com/chromium/tools/depot_tools.git
        echo "${{ github.workspace }}/depot_tools" >> $GITHUB_PATH
      shell: bash
      
    # è®¾ç½®Windowsç³»ç»Ÿçš„depot_toolsç¯å¢ƒå˜é‡
    - name: è®¾ç½®depot_toolsç¯å¢ƒå˜é‡
      if: runner.os == 'Windows'
      run: |
        echo "${{ github.workspace }}\depot_tools" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append
        # ç¦ç”¨depot_toolsè‡ªåŠ¨ä¸‹è½½å·¥å…·é“¾
        echo "DEPOT_TOOLS_WIN_TOOLCHAIN=0" | Out-File -FilePath $env:GITHUB_ENV -Encoding utf8 -Append
        
    # è·å–Skiaæºä»£ç å¹¶åŒæ­¥ä¾èµ–
    - name: è·å–Skiaæºä»£ç 
      run: |
        # ä½¿ç”¨æµ…å…‹éš†å‡å°‘ä¸‹è½½å¤§å°
        git clone --depth 1 https://skia.googlesource.com/skia.git
        cd skia
        python tools/git-sync-deps
      shell: bash
      
    # æ£€æŸ¥ç£ç›˜ç©ºé—´
    - name: æ£€æŸ¥ç£ç›˜ç©ºé—´
      run: |
        echo "=== Skiaä¸‹è½½åç£ç›˜ä½¿ç”¨æƒ…å†µ ==="
        df -h
      shell: bash
      
    # é…ç½®Skiaæ„å»ºå‚æ•°ï¼ˆä»…åŒ…å«Graphiteï¼Œä¸åŒ…å«Dawnï¼‰
    - name: é…ç½®Skiaæ„å»ºå‚æ•°
      run: |
        cd skia
        
        # åŸºç¡€æ„å»ºå‚æ•°è®¾ç½® - å¯ç”¨å…¨é‡åŠŸèƒ½
        args="is_official_build=true"
        args="$args skia_use_system_expat=false"
        args="$args skia_use_system_icu=false"
        args="$args skia_use_system_libjpeg_turbo=false"
        args="$args skia_use_system_libpng=false"
        args="$args skia_use_system_libwebp=false"
        args="$args skia_use_system_zlib=false"
        
        # å¯ç”¨å…¨é‡åŠŸèƒ½æ”¯æŒï¼Œä½†ä½¿ç”¨å†…ç½®ä¾èµ–åº“
        args="$args skia_enable_pdf=true"
        args="$args skia_enable_skottie=true"
        args="$args skia_enable_skshaper=true"
        args="$args skia_enable_svg=true"
        args="$args skia_use_icu=true"
        
        # å¯ç”¨GPUåç«¯æ”¯æŒ - åŒ…å«Graphiteä½†ä¸åŒ…å«Dawn
        args="$args skia_enable_gpu=true"
        args="$args skia_enable_graphite=true"
        args="$args skia_use_gl=true"
        args="$args skia_use_vulkan=true"
        # æ³¨æ„ï¼šç¦ç”¨Dawn WebGPUï¼Œå°†é€šè¿‡å¤–éƒ¨CMakeé“¾æ¥
        args="$args skia_use_dawn=false"
        args="$args skia_enable_spirv_validation=false"
        
        # ç¦ç”¨å·¥å…·æ„å»ºä»¥é¿å…æµ‹è¯•å·¥å…·APIé—®é¢˜å’ŒèŠ‚çœç©ºé—´
        args="$args skia_enable_tools=false"
        args="$args skia_build_tests=false"
        
        # è®¾ç½®ç›®æ ‡å¹³å°å’Œæ¶æ„
        args="$args target_os=\"${{ matrix.target_os }}\""
        args="$args target_cpu=\"${{ matrix.target_cpu }}\""
        
        # æ ¹æ®ä¸åŒå¹³å°è®¾ç½®ç‰¹å®šå‚æ•°å’Œç¼–è¯‘é€‰é¡¹
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°ç‰¹å®šé…ç½® - ä½¿ç”¨MSVC 2022å’ŒC++20æ ‡å‡†
            args="$args skia_use_angle=true"
            args="$args skia_use_direct3d=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=false"
            args="$args skia_use_piex=false"
            # è®¾ç½®Windowsä½¿ç”¨/MDè¿è¡Œæ—¶å’ŒC++20æ ‡å‡†
            args="$args extra_cflags=[\"/MD\", \"/std:c++20\"]"
            args="$args extra_cflags_c=[\"/MD\"]"
            args="$args extra_cflags_cc=[\"/MD\", \"/std:c++20\"]"
            ;;
          "mac")
            # macOSå¹³å°ç‰¹å®šé…ç½® - ä½¿ç”¨æœ€æ–°Clangå’ŒC++20æ ‡å‡†
            args="$args skia_use_metal=true"
            args="$args skia_enable_skottie=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_fontconfig=false"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_pdf_subset_harfbuzz=true"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            # è®¾ç½®C++20æ ‡å‡†å’Œå…¼å®¹æ€§é€‰é¡¹
            args="$args extra_cflags_cc=[\"-std=c++20\", \"-stdlib=libc++\", \"-mmacosx-version-min=10.15\"]"
            args="$args extra_ldflags=[\"-stdlib=libc++\", \"-mmacosx-version-min=10.15\"]"
            ;;
          "linux")
            # Linuxå¹³å°ç‰¹å®šé…ç½® - ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ç¼–è¯‘å™¨å’ŒC++20æ ‡å‡†
            args="$args skia_use_x11=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_fontconfig=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            args="$args skia_use_system_freetype2=true"
            args="$args skia_use_system_harfbuzz=true"
            # æ£€æŸ¥æ˜¯å¦æœ‰libc++ï¼Œå¦‚æœæœ‰åˆ™ä½¿ç”¨ï¼Œå¦åˆ™ä½¿ç”¨libstdc++
            if command -v clang++ >/dev/null 2>&1 && pkg-config --exists libc++; then
              echo "ä½¿ç”¨ libc++ æ ‡å‡†åº“"
              args="$args extra_cflags_cc=[\"-std=c++20\", \"-stdlib=libc++\"]"
              args="$args extra_ldflags=[\"-stdlib=libc++\", \"-lc++abi\"]"
              args="$args cc=\"clang\""
              args="$args cxx=\"clang++\""
            else
              echo "ä½¿ç”¨ libstdc++ æ ‡å‡†åº“"
              args="$args extra_cflags_cc=[\"-std=c++20\"]"
              args="$args cc=\"gcc\""
              args="$args cxx=\"g++\""
            fi
            ;;
          "android")
            # Androidå¹³å°ç‰¹å®šé…ç½® - ä½¿ç”¨NDK Clangå’ŒC++20æ ‡å‡†
            args="$args ndk=\"$ANDROID_NDK_ROOT\""
            args="$args android_api_level=${{ matrix.android_api }}"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_freetype=true"
            args="$args skia_enable_fontmgr_android=true"
            args="$args skia_use_vulkan=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            # è®¾ç½®C++20æ ‡å‡†ï¼ˆAndroid NDK r25cæ”¯æŒC++20ï¼‰
            args="$args extra_cflags_cc=[\"-std=c++20\"]"
            ;;
        esac
        
        echo "BUILD_ARGS=$args" >> $GITHUB_ENV
      shell: bash
      
    # ä½¿ç”¨GNç”Ÿæˆæ„å»ºæ–‡ä»¶
    - name: ç”ŸæˆSkiaæ„å»ºæ–‡ä»¶
      run: |
        cd skia
        echo "æ­£åœ¨ä¸º ${{ matrix.target_os }} å¹³å°ç”Ÿæˆæ„å»ºæ–‡ä»¶..."
        bin/gn gen out/Release --args="$BUILD_ARGS"
        echo "æ„å»ºé…ç½®å®Œæˆ"
      shell: bash
      
    # ä½¿ç”¨Ninjaç¼–è¯‘Skia
    - name: ç¼–è¯‘Skia
      run: |
        cd skia
        echo "å¼€å§‹ç¼–è¯‘ ${{ matrix.target_os }} å¹³å°çš„Skia..."
        
        # æ£€æŸ¥ç¼–è¯‘å‰ç£ç›˜ç©ºé—´
        echo "=== ç¼–è¯‘å‰ç£ç›˜ä½¿ç”¨æƒ…å†µ ==="
        df -h
        
        # æ ¹æ®å¹³å°è®¾ç½®å¹¶è¡Œç¼–è¯‘çº¿ç¨‹æ•°ï¼ˆå‡å°‘å†…å­˜ä½¿ç”¨ï¼‰
        if [ "${{ matrix.target_os }}" = "android" ]; then
          # Androidæ„å»ºä½¿ç”¨4çº¿ç¨‹
          ninja -C out/Release -j4
        else
          # å…¶ä»–å¹³å°ä½¿ç”¨4çº¿ç¨‹
          ninja -C out/Release -j4
        fi
        echo "âœ… ${{ matrix.target_os }} å¹³å°Skiaç¼–è¯‘å®Œæˆ"
      shell: bash
      
    # æ¸…ç†ä¸­é—´æ–‡ä»¶ä»¥èŠ‚çœç©ºé—´
    - name: æ¸…ç†Skiaä¸­é—´æ–‡ä»¶
      run: |
        cd skia
        # åˆ é™¤ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ–‡ä»¶
        find out/Release -name "*.o" -delete 2>/dev/null || true
        find out/Release -name "*.obj" -delete 2>/dev/null || true
        find out/Release -name "*.pdb" -delete 2>/dev/null || true
        
        echo "=== Skiaç¼–è¯‘åç£ç›˜ä½¿ç”¨æƒ…å†µ ==="
        df -h
      shell: bash
      
    # åˆ›å»ºå‘å¸ƒåŒ…å¹¶æ•´ç†æ–‡ä»¶
    - name: åˆ›å»ºSkiaå‘å¸ƒåŒ…
      run: |
        cd skia
        
        # åˆ›å»ºSkiaç›®å½•ç»“æ„
        mkdir -p Skia/bin/${{ matrix.target_os }}/${{ matrix.target_cpu }}
        mkdir -p Skia/lib/${{ matrix.target_os }}/${{ matrix.target_cpu }}
        mkdir -p Skia/include
        mkdir -p Skia/modules
        mkdir -p Skia/examples
        
        # å¤åˆ¶å¤´æ–‡ä»¶
        cp -r include/* Skia/include/
        
        # å¤åˆ¶modulesç›®å½•
        if [ -d "modules" ]; then
          cp -r modules/* Skia/modules/ 2>/dev/null || true
        fi
        
        # å¤åˆ¶third_partyä¸­çš„å¿…è¦å¤´æ–‡ä»¶
        if [ -d "third_party" ]; then
          mkdir -p Skia/third_party
          find third_party -name "*.h" -o -name "*.hpp" | while read file; do
            dir=$(dirname "$file")
            mkdir -p "Skia/$dir"
            cp "$file" "Skia/$file" 2>/dev/null || true
          done
        fi
        
        # æ ¹æ®ä¸åŒå¹³å°å¤åˆ¶ç›¸åº”çš„åº“æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°æ–‡ä»¶å¤åˆ¶
            find out/Release -name "*.lib" -exec cp {} Skia/lib/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            find out/Release -name "*.dll" -exec cp {} Skia/bin/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            find out/Release -name "*.exe" -exec cp {} Skia/bin/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            ;;
          "mac")
            # macOSå¹³å°æ–‡ä»¶å¤åˆ¶
            find out/Release -name "*.a" -exec cp {} Skia/lib/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            find out/Release -name "*.dylib" -exec cp {} Skia/lib/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            find out/Release -type f -perm +111 -name "*" -not -name "*.so" -not -name "*.dylib" -exec cp {} Skia/bin/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            ;;
          "linux"|"android")
            # Linuxå’ŒAndroidå¹³å°æ–‡ä»¶å¤åˆ¶
            find out/Release -name "*.a" -exec cp {} Skia/lib/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            find out/Release -name "*.so" -exec cp {} Skia/lib/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            find out/Release -type f -perm +111 -name "*" -not -name "*.so" -exec cp {} Skia/bin/${{ matrix.target_os }}/${{ matrix.target_cpu }}/ \; 2>/dev/null || true
            ;;
        esac
        
        # å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶ï¼ˆåªå¤åˆ¶å°æ–‡ä»¶ï¼‰
        if [ -d "resources" ]; then
          mkdir -p Skia/examples
          find resources -type f -size -1M -exec cp {} Skia/examples/ \; 2>/dev/null || true
        fi
        
        # åˆ›å»ºæ„å»ºä¿¡æ¯æ–‡ä»¶
        cat > Skia/BUILD_INFO.txt << EOF
        Skia + Graphite å®Œæ•´æ„å»ºä¿¡æ¯
        ===========================
        å¹³å°: ${{ matrix.target_os }}
        æ¶æ„: ${{ matrix.target_cpu }}
        åŒ…å: ${{ matrix.platform }}
        æ„å»ºæ¨¡å¼: Release (å®˜æ–¹å®Œæ•´æ„å»º)
        C++æ ‡å‡†: C++20
        
        æ”¯æŒçš„åŠŸèƒ½:
        - GPUæ¸²æŸ“ (OpenGL + Vulkan)
        - Graphiteæ¸²æŸ“å¼•æ“
        - PDFå¯¼å‡º (å†…ç½®HarfBuzz)
        - SVGæ”¯æŒ
        - SkottieåŠ¨ç”»
        - æ–‡æœ¬æ•´å½¢ (å†…ç½®HarfBuzz)
        - å­—ä½“ç®¡ç† (å†…ç½®FreeType)
        - å›¾åƒç¼–è§£ç 
        - é¢œè‰²ç®¡ç† (skcmsæ¨¡å—)
        
        å›¾å½¢åç«¯:
        - OpenGL/OpenGL ES
        - Vulkan
        - Graphiteæ¸²æŸ“å¼•æ“
        - Metal (ä»…macOS)
        - Direct3D (ä»…Windows)
        
        ç¼–è¯‘å™¨é…ç½®:
        - Windows: MSVC 2022 with /MD runtime
        - macOS: æœ€æ–° Clang with libc++
        - Linux: GCC/Clang with libstdc++/libc++ï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
        - Android: NDK r25c Clang
        
        æ³¨æ„äº‹é¡¹:
        - æ­¤ç‰ˆæœ¬ä¸åŒ…å«Dawn WebGPU
        - Dawnéœ€è¦é€šè¿‡å¤–éƒ¨CMakeé¡¹ç›®é“¾æ¥
        - å¯ç”¨äº†Graphiteç°ä»£æ¸²æŸ“åç«¯
        EOF
        
        echo "=== æœ€ç»ˆç£ç›˜ä½¿ç”¨æƒ…å†µ ==="
        df -h
      shell: bash
      
    # ç”Ÿæˆç»Ÿä¸€çš„CMakeLists.txtæ–‡ä»¶ï¼ˆskdnæ¥å£ï¼Œä¸ºå¤–éƒ¨Dawné“¾æ¥åšå‡†å¤‡ï¼‰
    - name: ç”ŸæˆSkia CMakeLists.txt
      run: |
        cd skia/Skia
        
        # ç”ŸæˆCMakeLists.txtæ–‡ä»¶ï¼Œåˆ›å»ºskdnæ¥å£åº“ï¼Œä¸ºå¤–éƒ¨Dawné“¾æ¥åšå‡†å¤‡
        cat > CMakeLists.txt << 'EOF'
        # Skia + Graphite å›¾å½¢åº“çš„CMakeé…ç½®æ–‡ä»¶ï¼ˆå…¨å¹³å°æ”¯æŒï¼Œæ”¯æŒå¤–éƒ¨Dawné“¾æ¥ï¼‰
        cmake_minimum_required(VERSION 3.20)
        
        # è®¾ç½®é¡¹ç›®ä¿¡æ¯
        project(SkiaGraphitePrebuilt
            VERSION 1.0.0
            DESCRIPTION "å®Œæ•´é¢„ç¼–è¯‘çš„Skiaå›¾å½¢åº“ + Graphiteæ¸²æŸ“å¼•æ“"
            LANGUAGES CXX C
        )
        
        # è®¾ç½®C++20æ ‡å‡†
        set(CMAKE_CXX_STANDARD 20)
        set(CMAKE_CXX_STANDARD_REQUIRED ON)
        
        # è·å–å½“å‰ç›®å½•
        get_filename_component(SKDN_ROOT_DIR "${CMAKE_CURRENT_LIST_DIR}" ABSOLUTE)
        
        # æ£€æµ‹å½“å‰å¹³å°å’Œæ¶æ„
        if(WIN32)
            set(SKDN_PLATFORM "win")
            if(CMAKE_SIZEOF_VOID_P EQUAL 8)
                set(SKDN_ARCH "x64")
            else()
                set(SKDN_ARCH "x86")
            endif()
        elseif(APPLE)
            set(SKDN_PLATFORM "mac")
            if(CMAKE_SYSTEM_PROCESSOR MATCHES "arm64|aarch64")
                set(SKDN_ARCH "arm64")
            else()
                set(SKDN_ARCH "x64")
            endif()
        elseif(ANDROID)
            set(SKDN_PLATFORM "android")
            if(CMAKE_ANDROID_ARCH_ABI STREQUAL "arm64-v8a")
                set(SKDN_ARCH "arm64")
            else()
                set(SKDN_ARCH "x64")
            endif()
        else()
            set(SKDN_PLATFORM "linux")
            if(CMAKE_SIZEOF_VOID_P EQUAL 8)
                set(SKDN_ARCH "x64")
            else()
                set(SKDN_ARCH "x86")
            endif()
        endif()
        
        # è®¾ç½®åº“æ–‡ä»¶è·¯å¾„
        set(SKDN_LIB_DIR "${SKDN_ROOT_DIR}/lib/${SKDN_PLATFORM}/${SKDN_ARCH}")
        set(SKDN_BIN_DIR "${SKDN_ROOT_DIR}/bin/${SKDN_PLATFORM}/${SKDN_ARCH}")
        
        # åˆ›å»ºskdnæ¥å£åº“ï¼ˆç»Ÿä¸€çš„Skia + Graphiteæ¥å£ï¼‰
        add_library(skdn INTERFACE)
        add_library(skdn::skdn ALIAS skdn)
        
        # è®¾ç½®åŒ…å«ç›®å½•
        target_include_directories(skdn INTERFACE
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}>
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}/include>
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}/modules>
            $<BUILD_INTERFACE:${SKDN_ROOT_DIR}/third_party>
            $<INSTALL_INTERFACE:.>
            $<INSTALL_INTERFACE:include>
            $<INSTALL_INTERFACE:modules>
            $<INSTALL_INTERFACE:third_party>
        )
        
        # æŸ¥æ‰¾æ‰€æœ‰çš„åº“æ–‡ä»¶
        file(GLOB SKDN_LIBRARIES "${SKDN_LIB_DIR}/*")
        
        # å®šä¹‰é€‰é¡¹ï¼šæ˜¯å¦å¯ç”¨å¤–éƒ¨Dawnæ”¯æŒ
        option(SKDN_USE_DAWN "å¯ç”¨å¤–éƒ¨Dawn WebGPUæ”¯æŒ" OFF)
        
        # æ ¹æ®å¹³å°è®¾ç½®ç‰¹å®šçš„é“¾æ¥åº“å’Œç¼–è¯‘é€‰é¡¹
        if(WIN32)
            # Windowså¹³å°é…ç½® - æ”¯æŒC++20å’ŒGraphite
            target_compile_definitions(skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_WIN=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                UNICODE
                _UNICODE
            )
            
            # å¦‚æœå¯ç”¨äº†Dawnæ”¯æŒï¼Œæ·»åŠ ç›¸åº”å®šä¹‰
            if(SKDN_USE_DAWN)
                target_compile_definitions(skdn INTERFACE SK_DAWN=1)
            endif()
            
            # è®¾ç½®Windowsè¿è¡Œæ—¶å’ŒC++20
            target_compile_options(skdn INTERFACE
                $<$<CONFIG:Debug>:/MDd /std:c++20>
                $<$<CONFIG:Release>:/MD /std:c++20>
                $<$<CONFIG:RelWithDebInfo>:/MD /std:c++20>
                $<$<CONFIG:MinSizeRel>:/MD /std:c++20>
            )
            
            # æ·»åŠ Windowsç³»ç»Ÿåº“
            target_link_libraries(skdn INTERFACE
                ${SKDN_LIBRARIES}
                # OpenGLç›¸å…³
                OpenGL32
                # DirectXç›¸å…³
                d3d11
                dxgi
                d3dcompiler
                dxguid
                # ç³»ç»Ÿåº“
                Gdi32
                User32
                Kernel32
                Ole32
                OleAut32
                Uuid
                Advapi32
                Shell32
                # å­—ä½“å’Œæ–‡æœ¬
                Usp10
                # ç½‘ç»œ
                Ws2_32
            )
            
        elseif(APPLE)
            # macOSå¹³å°é…ç½® - æ”¯æŒC++20å’ŒGraphite
            target_compile_definitions(skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_METAL=1
                SK_GL=1
                SK_VULKAN=1
                SK_BUILD_FOR_MAC=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
            )
            
            # å¦‚æœå¯ç”¨äº†Dawnæ”¯æŒï¼Œæ·»åŠ ç›¸åº”å®šä¹‰
            if(SKDN_USE_DAWN)
                target_compile_definitions(skdn INTERFACE SK_DAWN=1)
            endif()
            
            # è®¾ç½®C++20æ ‡å‡†
            target_compile_options(skdn INTERFACE
                -std=c++20
                -stdlib=libc++
            )
            
            # æŸ¥æ‰¾macOSç³»ç»Ÿæ¡†æ¶
            find_library(FOUNDATION_FRAMEWORK Foundation)
            find_library(COREGRAPHICS_FRAMEWORK CoreGraphics)
            find_library(CORETEXT_FRAMEWORK CoreText)
            find_library(COREFOUNDATION_FRAMEWORK CoreFoundation)
            find_library(COCOA_FRAMEWORK Cocoa)
            find_library(METAL_FRAMEWORK Metal)
            find_library(METALKIT_FRAMEWORK MetalKit)
            find_library(OPENGL_FRAMEWORK OpenGL)
            find_library(QUARTZCORE_FRAMEWORK QuartzCore)
            find_library(IOSURFACE_FRAMEWORK IOSurface)
            
            target_link_libraries(skdn INTERFACE
                ${SKDN_LIBRARIES}
                ${FOUNDATION_FRAMEWORK}
                ${COREGRAPHICS_FRAMEWORK}
                ${CORETEXT_FRAMEWORK}
                ${COREFOUNDATION_FRAMEWORK}
                ${COCOA_FRAMEWORK}
                ${METAL_FRAMEWORK}
                ${METALKIT_FRAMEWORK}
                ${OPENGL_FRAMEWORK}
                ${QUARTZCORE_FRAMEWORK}
                ${IOSURFACE_FRAMEWORK}
            )
            
        elseif(ANDROID)
            # Androidå¹³å°é…ç½® - æ”¯æŒC++20å’ŒGraphite
            target_compile_definitions(skdn INTERFACE
                ANDROID
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_ANDROID=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                __ANDROID_API__=21
            )
            
            # å¦‚æœå¯ç”¨äº†Dawnæ”¯æŒï¼Œæ·»åŠ ç›¸åº”å®šä¹‰
            if(SKDN_USE_DAWN)
                target_compile_definitions(skdn INTERFACE SK_DAWN=1)
            endif()
            
            target_compile_options(skdn INTERFACE
                -std=c++20
                -fPIC
                -fno-rtti
                -fno-exceptions
            )
            
            target_link_libraries(skdn INTERFACE
                ${SKDN_LIBRARIES}
                # OpenGL ESç›¸å…³
                GLESv2
                EGL
                # Vulkanç›¸å…³
                vulkan
                # Androidç³»ç»Ÿåº“
                android
                log
                jnigraphics
                # åª’ä½“ç›¸å…³
                mediandk
                # ç³»ç»Ÿåº“
                dl
                m
                z
            )
            
            # Androidç‰¹å®šçš„é“¾æ¥é€‰é¡¹
            target_link_options(skdn INTERFACE
                -Wl,--gc-sections
                -Wl,--as-needed
            )
            
        else()
            # Linuxå¹³å°é…ç½® - æ”¯æŒC++20å’ŒGraphite
            target_compile_definitions(skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_VULKAN=1
                SK_GL=1
                SK_BUILD_FOR_UNIX=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
            )
            
            # å¦‚æœå¯ç”¨äº†Dawnæ”¯æŒï¼Œæ·»åŠ ç›¸åº”å®šä¹‰
            if(SKDN_USE_DAWN)
                target_compile_definitions(skdn INTERFACE SK_DAWN=1)
            endif()
            
            # è®¾ç½®C++20æ ‡å‡†ï¼ˆè‡ªé€‚åº”æ ‡å‡†åº“ï¼‰
            target_compile_options(skdn INTERFACE
                -std=c++20
            )
            
            # æŸ¥æ‰¾å¿…è¦çš„ç³»ç»Ÿåº“
            find_package(PkgConfig QUIET)
            if(PKG_CONFIG_FOUND)
                pkg_check_modules(FONTCONFIG QUIET fontconfig)
                pkg_check_modules(HARFBUZZ QUIET harfbuzz)
            endif()
            
            # æŸ¥æ‰¾Vulkan
            find_package(Vulkan QUIET)
            
            # æŸ¥æ‰¾X11ç›¸å…³åº“
            find_package(X11 QUIET)
            
            target_link_libraries(skdn INTERFACE
                ${SKDN_LIBRARIES}
                # OpenGL
                GL
                # ç³»ç»Ÿåº“
                pthread
                dl
                m
            )
            
            # æ£€æµ‹å¹¶ä½¿ç”¨åˆé€‚çš„C++æ ‡å‡†åº“
            include(CheckCXXSourceCompiles)
            set(CMAKE_REQUIRED_FLAGS "-std=c++20")
            check_cxx_source_compiles("
                #include <memory>
                int main() { return 0; }
            " HAVE_WORKING_CXX20)
            
            if(HAVE_WORKING_CXX20)
                message(STATUS "C++20æ”¯æŒæ£€æµ‹é€šè¿‡ï¼Œä½¿ç”¨ç³»ç»Ÿé»˜è®¤æ ‡å‡†åº“")
            endif()
            
            # FontConfigæ”¯æŒ
            if(FONTCONFIG_FOUND)
                target_link_libraries(skdn INTERFACE ${FONTCONFIG_LIBRARIES})
                target_include_directories(skdn INTERFACE ${FONTCONFIG_INCLUDE_DIRS})
            endif()
            
            # HarfBuzzæ”¯æŒ
            if(HARFBUZZ_FOUND)
                target_link_libraries(skdn INTERFACE ${HARFBUZZ_LIBRARIES})
                target_include_directories(skdn INTERFACE ${HARFBUZZ_INCLUDE_DIRS})
            endif()
            
            # æ·»åŠ Vulkanæ”¯æŒ
            if(Vulkan_FOUND)
                target_link_libraries(skdn INTERFACE ${Vulkan_LIBRARIES})
                target_include_directories(skdn INTERFACE ${Vulkan_INCLUDE_DIRS})
            endif()
            
            # æ·»åŠ X11æ”¯æŒ
            if(X11_FOUND)
                target_link_libraries(skdn INTERFACE
                    ${X11_LIBRARIES}
                    ${X11_Xrandr_LIB}
                    ${X11_Xinerama_LIB}
                    ${X11_Xcursor_LIB}
                    ${X11_Xi_LIB}
                )
                target_include_directories(skdn INTERFACE ${X11_INCLUDE_DIR})
            endif()
        endif()
        
        # å¦‚æœå¯ç”¨äº†Dawnæ”¯æŒï¼Œå°è¯•æŸ¥æ‰¾Dawnåº“
        if(SKDN_USE_DAWN)
            find_package(Dawn QUIET)
            if(Dawn_FOUND)
                target_link_libraries(skdn INTERFACE Dawn::Dawn)
                message(STATUS "æ‰¾åˆ°å¤–éƒ¨Dawnåº“ï¼Œå·²è‡ªåŠ¨é“¾æ¥")
            else()
                message(WARNING "å¯ç”¨äº†Dawnæ”¯æŒä½†æœªæ‰¾åˆ°Dawnåº“ï¼Œè¯·ç¡®ä¿Dawnåº“å·²æ­£ç¡®å®‰è£…")
            endif()
        endif()
        
        # è®¾ç½®ç¼–è¯‘ç‰¹æ€§
        target_compile_features(skdn INTERFACE cxx_std_20)
        
        # ä¼˜åŒ–è®¾ç½®
        target_compile_options(skdn INTERFACE
            $<$<CONFIG:Debug>:-g -O0>
            $<$<CONFIG:Release>:-O3 -DNDEBUG>
            $<$<CONFIG:RelWithDebInfo>:-O2 -g -DNDEBUG>
        )
        
        # è®¾ç½®é¢„å¤„ç†å™¨å®šä¹‰
        target_compile_definitions(skdn INTERFACE
            $<$<CONFIG:Debug>:SK_DEBUG>
            $<$<CONFIG:Release>:SK_RELEASE>
        )
        
        # æ˜¾ç¤ºé…ç½®ä¿¡æ¯
        message(STATUS "SKDNé…ç½®ä¿¡æ¯:")
        message(STATUS "  å¹³å°: ${SKDN_PLATFORM}")
        message(STATUS "  æ¶æ„: ${SKDN_ARCH}")
        message(STATUS "  åº“ç›®å½•: ${SKDN_LIB_DIR}")
        message(STATUS "  äºŒè¿›åˆ¶ç›®å½•: ${SKDN_BIN_DIR}")
        message(STATUS "  C++æ ‡å‡†: C++20")
        message(STATUS "  æ”¯æŒåŠŸèƒ½: Skia + Graphiteæ¸²æŸ“å¼•æ“")
        message(STATUS "  Dawnæ”¯æŒ: ${SKDN_USE_DAWN}")
        
        # åˆ›å»ºè¾…åŠ©å‡½æ•°ç”¨äºç®€åŒ–Dawnçš„é“¾æ¥
        function(SkdnLinkDawn target)
            if(NOT TARGET ${target})
                message(FATAL_ERROR "ç›®æ ‡ ${target} ä¸å­˜åœ¨")
            endif()
            
            # é“¾æ¥skdnåº“
            target_link_libraries(${target} PRIVATE skdn::skdn)
            
            # å¦‚æœç”¨æˆ·ä¼ é€’äº†Dawnåº“ï¼Œåˆ™é“¾æ¥å®ƒ
            if(ARGC GREATER 1)
                target_link_libraries(${target} PRIVATE ${ARGV1})
                target_compile_definitions(${target} PRIVATE SK_DAWN=1)
                message(STATUS "ä¸ºç›®æ ‡ ${target} é“¾æ¥äº†Dawnåº“: ${ARGV1}")
            endif()
        endfunction()
        
        # æä¾›ä½¿ç”¨ç¤ºä¾‹çš„æ¶ˆæ¯
        if(NOT SKDN_QUIET)
            message(STATUS "")
            message(STATUS "=== SKDNä½¿ç”¨ç¤ºä¾‹ ===")
            message(STATUS "åŸºç¡€ä½¿ç”¨ï¼ˆä»…Skia + Graphiteï¼‰:")
            message(STATUS "  target_link_libraries(your_target skdn::skdn)")
            message(STATUS "")
            message(STATUS "ä½¿ç”¨å¤–éƒ¨Dawnåº“:")
            message(STATUS "  set(SKDN_USE_DAWN ON)")
            message(STATUS "  find_package(Dawn REQUIRED)")
            message(STATUS "  target_link_libraries(your_target skdn::skdn Dawn::Dawn)")
            message(STATUS "")
            message(STATUS "æˆ–ä½¿ç”¨è¾…åŠ©å‡½æ•°:")
            message(STATUS "  SkdnLinkDawn(your_target Dawn::Dawn)")
            message(STATUS "==================")
            message(STATUS "")
        endif()
        EOF
        
      shell: bash
      
    # æ‰“åŒ…æ„å»ºäº§ç‰©ä¸ºZIPæ–‡ä»¶
    - name: æ‰“åŒ…Skiaæ„å»ºäº§ç‰©
      run: |
        cd skia
        
        # æ ¹æ®è¿è¡Œå¹³å°é€‰æ‹©åˆé€‚çš„æ‰“åŒ…æ–¹å¼
        if [ "${{ runner.os }}" = "Windows" ]; then
          # Windowsç³»ç»Ÿä½¿ç”¨PowerShellçš„Compress-Archive
          powershell "Compress-Archive -Path Skia -DestinationPath Skia_Prebuilt_${{ matrix.platform }}.zip"
        else
          # Unixç³»ç»Ÿä½¿ç”¨zipå‘½ä»¤æ‰“åŒ…
          zip -r "Skia_Prebuilt_${{ matrix.platform }}.zip" Skia
        fi
        
        echo "âœ… Skia_Prebuilt_${{ matrix.platform }}.zip æ„å»ºåŒ…åˆ›å»ºå®Œæˆ"
        
        # æ˜¾ç¤ºæœ€ç»ˆæ–‡ä»¶å¤§å°
        ls -lh "Skia_Prebuilt_${{ matrix.platform }}.zip"
      shell: bash
      
    # ä¸Šä¼ æ„å»ºäº§ç‰©åˆ°GitHub Actions
    - name: ä¸Šä¼ Skiaæ„å»ºäº§ç‰©
      uses: actions/upload-artifact@v4
      with:
        name: Skia_Prebuilt_${{ matrix.platform }}
        path: skia/Skia_Prebuilt_${{ matrix.platform }}.zip
        retention-days: 30
        compression-level: 0
        
  # åˆ›å»ºGitHub Releaseå‘å¸ƒï¼ˆä»…åœ¨æ¨é€åˆ°ä¸»åˆ†æ”¯æˆ–å®šæ—¶ä»»åŠ¡æ—¶ï¼‰
  create-release:
    needs: build-skia
    runs-on: ubuntu-latest
    if: |
      (github.event_name == 'push' && (github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master')) ||
      github.event_name == 'schedule'
    
    permissions:
      contents: write
      packages: write
    
    steps:
    # æ£€å‡ºä»£ç ä»¥è®¿é—®ä»“åº“ä¿¡æ¯
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # ä¸‹è½½æ‰€æœ‰æ„å»ºäº§ç‰©
    - name: ä¸‹è½½æ‰€æœ‰Skiaæ„å»ºäº§ç‰©
      uses: actions/download-artifact@v4
      with:
        path: artifacts
        
    # è·å–å‘å¸ƒæ ‡ç­¾
    - name: è·å–å‘å¸ƒæ ‡ç­¾
      id: get_tag
      run: |
        if [ "${{ github.event_name }}" = "schedule" ]; then
          echo "tag=skia-graphite-daily-$(date +%Y%m%d)" >> $GITHUB_OUTPUT
          echo "name=Skia+Graphiteå…¨å¹³å°æ¯æ—¥æ„å»ºåŒ… $(date +%Y-%m-%d)" >> $GITHUB_OUTPUT
        else
          echo "tag=skia-graphite-build-${{ github.run_number }}" >> $GITHUB_OUTPUT
          echo "name=Skia+Graphiteå…¨å¹³å°æ„å»ºåŒ… v${{ github.run_number }}" >> $GITHUB_OUTPUT
        fi
        
    # åˆ›å»ºGitHub Releaseå‘å¸ƒç‰ˆæœ¬
    - name: åˆ›å»ºGitHub Release
      uses: softprops/action-gh-release@v2
      with:
        tag_name: ${{ steps.get_tag.outputs.tag }}
        name: ${{ steps.get_tag.outputs.name }}
        body: |
          # Skia + Graphite å…¨å¹³å°æ„å»ºåŒ…
          
          è¿™ä¸ªå‘å¸ƒåŒ…åŒ…å«äº†Skiaå›¾å½¢åº“å’ŒGraphiteæ¸²æŸ“å¼•æ“åœ¨å¤šä¸ªå¹³å°çš„å®Œæ•´é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼Œæ”¯æŒå¤–éƒ¨Dawn WebGPUé“¾æ¥ã€‚
          
          ## åŒ…å«çš„å¹³å°
          
          ### æ¡Œé¢å¹³å°
          - **Skia_Prebuilt_x64_windows.zip** - Windows x64æ¶æ„
            - GPUåç«¯: Direct3D + OpenGL + Vulkan + Graphite
            - ç¼–è¯‘å™¨: MSVC 2022 with /MD runtime
            - C++æ ‡å‡†: C++20
          
          - **Skia_Prebuilt_x64_macos.zip** - macOS Intel x64æ¶æ„
          - **Skia_Prebuilt_arm64_macos.zip** - macOS Apple Silicon ARM64æ¶æ„
            - GPUåç«¯: Metal + OpenGL + Vulkan + Graphite
            - ç¼–è¯‘å™¨: æœ€æ–° Clang with libc++
            - C++æ ‡å‡†: C++20
          
          - **Skia_Prebuilt_x64_linux.zip** - Linux x64æ¶æ„
            - GPUåç«¯: OpenGL + Vulkan + Graphite
            - ç¼–è¯‘å™¨: GCC/Clangï¼ˆè‡ªåŠ¨é€‰æ‹©æœ€ä½³ï¼‰
            - C++æ ‡å‡†: C++20
          
          ### ç§»åŠ¨å¹³å°
          - **Skia_Prebuilt_x64_android.zip** - Android x64æ¶æ„
          - **Skia_Prebuilt_arm64_android.zip** - Android ARM64æ¶æ„
            - GPUåç«¯: OpenGL ES + Vulkan + Graphite
            - ç¼–è¯‘å™¨: NDK r25c Clang
            - Android APIçº§åˆ«: 21+
            - C++æ ‡å‡†: C++20
          
          ## CMakeä½¿ç”¨æ–¹æ³•
          
          ### åŸºç¡€ä½¿ç”¨ï¼ˆä»…Skia + Graphiteï¼‰
          
          ```cmake
          # è®¾ç½®C++20æ ‡å‡†
          set(CMAKE_CXX_STANDARD 20)
          set(CMAKE_CXX_STANDARD_REQUIRED ON)
          
          # æ·»åŠ Skiaå­ç›®å½•
          add_subdirectory(path/to/Skia)
          
          # é“¾æ¥skdnæ¥å£åº“
          target_link_libraries(your_target skdn::skdn)
          ```
          
          ### ä½¿ç”¨å¤–éƒ¨Dawn WebGPU
          
          ```cmake
          # è®¾ç½®C++20æ ‡å‡†
          set(CMAKE_CXX_STANDARD 20)
          set(CMAKE_CXX_STANDARD_REQUIRED ON)
          
          # å¯ç”¨Dawnæ”¯æŒ
          set(SKDN_USE_DAWN ON)
          
          # æ·»åŠ Skiaå­ç›®å½•
          add_subdirectory(path/to/Skia)
          
          # æŸ¥æ‰¾å¹¶é“¾æ¥Dawn
          find_package(Dawn REQUIRED)
          target_link_libraries(your_target skdn::skdn Dawn::Dawn)
          
          # æˆ–ä½¿ç”¨è¾…åŠ©å‡½æ•°
          SkdnLinkDawn(your_target Dawn::Dawn)
          ```
          
          ## ä¸»è¦ç‰¹æ€§
          
          - âœ… **å®Œæ•´çš„Skiaæ ¸å¿ƒåŠŸèƒ½**
          - âœ… **Graphiteç°ä»£æ¸²æŸ“å¼•æ“**
          - âœ… **GPUåŠ é€Ÿæ¸²æŸ“**ï¼ˆOpenGL/Vulkan/Metal/Direct3Dï¼‰
          - âœ… **PDF/SVG/åŠ¨ç”»æ”¯æŒ**
          - âœ… **å†…ç½®å­—ä½“å’Œæ–‡æœ¬å¤„ç†**
          - âœ… **å›¾åƒç¼–è§£ç æ”¯æŒ**
          - âœ… **é¢œè‰²ç®¡ç†** (skcmsæ¨¡å—)
          - âœ… **C++20æ ‡å‡†ç¼–è¯‘**
          - âœ… **ç»Ÿä¸€æ¥å£åº“** (skdn)
          - âœ… **å¤–éƒ¨Dawn WebGPUæ”¯æŒ**
          - âœ… **å…¨å¹³å°æ”¯æŒ**
          - âœ… **ç”Ÿäº§ç¯å¢ƒå°±ç»ª**
          
          ## æ¶æ„è¯´æ˜
          
          - æ­¤ç‰ˆæœ¬ä¸“æ³¨äºSkiaæ ¸å¿ƒåŠŸèƒ½å’ŒGraphiteæ¸²æŸ“å¼•æ“
          - Dawn WebGPUä½œä¸ºå¯é€‰çš„å¤–éƒ¨ä¾èµ–ï¼Œå¯é€šè¿‡CMakeé“¾æ¥
          - æä¾›äº†ä¾¿æ·çš„CMakeå‡½æ•°æ¥ç®€åŒ–Dawnçš„é›†æˆ
          - æ”¯æŒåŠ¨æ€å¯ç”¨/ç¦ç”¨DawnåŠŸèƒ½
          
          ## ç‰ˆæœ¬ä¼˜åŠ¿
          
          - âš¡ **æ›´å°çš„ä½“ç§¯**: ä¸åŒ…å«Dawnå‡å°‘äº†åŒ…å¤§å°
          - ğŸ”§ **çµæ´»çš„é›†æˆ**: å¯é€‰æ‹©æ€§åœ°é“¾æ¥Dawn
          - ğŸ¯ **ä¸“æ³¨æ ¸å¿ƒ**: ä¸“æ³¨äºSkiaå’ŒGraphiteçš„ç¨³å®šæ€§
          - ğŸ“¦ **æ˜“äºç®¡ç†**: ç®€åŒ–çš„ä¾èµ–å…³ç³»
        files: |
          artifacts/*/**.zip
        draft: false
        prerelease: false
        generate_release_notes: false
        make_latest: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
