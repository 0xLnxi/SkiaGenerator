# Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…æ„å»ºå·¥ä½œæµ - ä¿®æ­£C++20æ”¯æŒ
name: ç¼–è¯‘ Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´ä¸Šåˆ8ç‚¹ï¼ˆUTCæ—¶é—´0ç‚¹ï¼‰æ‰§è¡Œä¸€æ¬¡
    - cron: '0 0 * * *'

# è®¾ç½®å·¥ä½œæµæƒé™
permissions:
  contents: write
  packages: write
  actions: read

jobs:
  build-skia-all-platforms:
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        include:
          # Windows x64æ¶æ„ - Dawnæ”¯æŒ
          - os: windows-latest
            platform: win_x64
            arch: x64
            target_os: win
            target_cpu: x64
            
          # macOS x64æ¶æ„ - Dawnæ”¯æŒï¼Œä½¿ç”¨æœ€æ–°macOSç¡®ä¿C++20æ”¯æŒ
          - os: macos-14
            platform: macos_x64
            arch: x64
            target_os: mac
            target_cpu: x64
            
          # macOS ARM64æ¶æ„ - Dawnæ”¯æŒï¼Œä½¿ç”¨æœ€æ–°macOSç¡®ä¿C++20æ”¯æŒ
          - os: macos-14
            platform: macos_arm64
            arch: arm64
            target_os: mac
            target_cpu: arm64
            
          # Linux x64æ¶æ„ - Dawnæ”¯æŒ
          - os: ubuntu-latest
            platform: linux_x64
            arch: x64
            target_os: linux
            target_cpu: x64
            
          # Android x64æ¶æ„ - Dawnæ”¯æŒ
          - os: ubuntu-latest
            platform: android_x64
            arch: x64
            target_os: android
            target_cpu: x64
            android_api: 21
            
          # Android ARM64æ¶æ„ - Dawnæ”¯æŒ
          - os: ubuntu-latest
            platform: android_arm64
            arch: arm64
            target_os: android
            target_cpu: arm64
            android_api: 21

    steps:
    # æ£€å‡ºä»£ç ä»“åº“
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # è®¾ç½®Pythonè¿è¡Œç¯å¢ƒ
    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
        
    # å®‰è£…Linuxç³»ç»Ÿä¾èµ–åŒ…ï¼ˆLinuxå’ŒAndroidæ„å»ºéœ€è¦ï¼‰
    - name: å®‰è£…Linuxç³»ç»Ÿä¾èµ–
      if: runner.os == 'Linux'
      run: |
        sudo apt-get update
        # å®‰è£…åŸºç¡€æ„å»ºå·¥å…· - ç¡®ä¿ä½¿ç”¨æ”¯æŒC++20çš„ç¼–è¯‘å™¨
        sudo apt-get install -y build-essential ninja-build
        # å®‰è£…æ›´æ–°çš„GCCå’ŒG++ä»¥æ”¯æŒC++20
        sudo apt-get install -y gcc-12 g++-12
        # è®¾ç½®é»˜è®¤ç¼–è¯‘å™¨ä¸ºæ”¯æŒC++20çš„ç‰ˆæœ¬
        sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-12 100
        sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-12 100
        # éªŒè¯ç¼–è¯‘å™¨ç‰ˆæœ¬
        gcc --version
        g++ --version
        # æµ‹è¯•C++20æ”¯æŒ
        echo 'int main() { return 0; }' | g++ -std=c++20 -x c++ - -o /tmp/test_cpp20 && echo "âœ… C++20æ”¯æŒæ­£å¸¸"
        # å®‰è£…å›¾å½¢å’Œå­—ä½“ç›¸å…³ä¾èµ–
        sudo apt-get install -y libfontconfig1-dev libfreetype6-dev libgl1-mesa-dev
        # å®‰è£…Vulkanå¼€å‘åº“
        sudo apt-get install -y libvulkan-dev vulkan-tools
        # å®‰è£…Dawn WebGPUæ‰€éœ€çš„é¢å¤–åº“
        sudo apt-get install -y libxrandr-dev libxinerama-dev libxcursor-dev libxi-dev
        sudo apt-get install -y libwayland-dev libwayland-egl-backend-dev
        sudo apt-get install -y libegl1-mesa-dev libgles2-mesa-dev
        # å®‰è£…ICUå’ŒHarfBuzz
        sudo apt-get install -y libicu-dev libharfbuzz-dev
        # å®‰è£…Javaå¼€å‘ç¯å¢ƒï¼ˆAndroidæ„å»ºéœ€è¦ï¼‰
        sudo apt-get install -y openjdk-11-jdk
        
    # å®‰è£…macOSç³»ç»Ÿä¾èµ–å¹¶ç¡®ä¿C++20æ”¯æŒ
    - name: å®‰è£…macOSç³»ç»Ÿä¾èµ–å¹¶ç¡®ä¿C++20æ”¯æŒ
      if: runner.os == 'macOS'
      run: |
        # å®‰è£…Xcodeå‘½ä»¤è¡Œå·¥å…·
        xcode-select --install 2>/dev/null || true
        # å®‰è£…ninjaæ„å»ºå·¥å…·
        brew install ninja || true
        # éªŒè¯Xcodeç‰ˆæœ¬æ”¯æŒC++20
        echo "å½“å‰Xcodeç‰ˆæœ¬:"
        xcodebuild -version
        echo "å½“å‰Clangç‰ˆæœ¬:"
        clang --version
        # æµ‹è¯•C++20æ”¯æŒ
        echo '#include <concepts>
        template<std::integral T> void test() {}
        int main() { return 0; }' > /tmp/test_cpp20.cpp
        if clang++ -std=c++20 -stdlib=libc++ /tmp/test_cpp20.cpp -o /tmp/test_cpp20; then
          echo "âœ… macOS C++20å’ŒConceptsæ”¯æŒæ­£å¸¸"
        else
          echo "âŒ macOS C++20æ”¯æŒå­˜åœ¨é—®é¢˜"
          echo "å°è¯•å®‰è£…æ›´æ–°çš„å·¥å…·é“¾..."
          # å¦‚æœé»˜è®¤clangä¸æ”¯æŒï¼Œå°è¯•å®‰è£…llvm
          brew install llvm || true
        fi
        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
        rm -f /tmp/test_cpp20.cpp /tmp/test_cpp20
        
    # å®‰è£…Windowsç³»ç»Ÿä¾èµ–
    - name: å®‰è£…Windowsç³»ç»Ÿä¾èµ–
      if: runner.os == 'Windows'
      run: |
        # å®‰è£…ninjaæ„å»ºå·¥å…·
        choco install ninja -y
        # éªŒè¯MSVC C++20æ”¯æŒ
        echo "å½“å‰MSVCç‰ˆæœ¬:"
        cl 2>&1 | findstr "Version" || echo "MSVCä¿¡æ¯è·å–å¤±è´¥"
        
    # è®¾ç½®Android NDKç¯å¢ƒï¼ˆä»…é™Androidå¹³å°ï¼‰
    - name: è®¾ç½®Android NDK
      if: matrix.target_os == 'android'
      uses: nttld/setup-ndk@v1
      with:
        ndk-version: r25c
        
    # è·å–Googleçš„depot_toolså·¥å…·é›†
    - name: è·å–depot_tools
      run: |
        git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git
        echo "${{ github.workspace }}/depot_tools" >> $GITHUB_PATH
      shell: bash
      
    # è®¾ç½®Windowsç³»ç»Ÿçš„depot_toolsç¯å¢ƒå˜é‡
    - name: è®¾ç½®depot_toolsç¯å¢ƒå˜é‡
      if: runner.os == 'Windows'
      run: |
        echo "${{ github.workspace }}\depot_tools" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append
        # ç¦ç”¨depot_toolsè‡ªåŠ¨ä¸‹è½½å·¥å…·é“¾
        echo "DEPOT_TOOLS_WIN_TOOLCHAIN=0" | Out-File -FilePath $env:GITHUB_ENV -Encoding utf8 -Append
        
    # è·å–Skiaæºä»£ç å¹¶åŒæ­¥ä¾èµ–ï¼ˆåŒ…æ‹¬Dawnï¼‰
    - name: è·å–Skiaæºä»£ç å’ŒDawnä¾èµ–
      run: |
        git clone https://skia.googlesource.com/skia.git
        cd skia
        python tools/git-sync-deps
      shell: bash
      
    # é…ç½®å¯ç”¨Dawnå’ŒGraphiteåç«¯çš„æ„å»ºå‚æ•°ï¼Œå¼ºåˆ¶ä½¿ç”¨C++20
    - name: é…ç½®Dawn WebGPUå’ŒGraphiteæ„å»ºå‚æ•°ï¼ˆå¼ºåˆ¶C++20ï¼‰
      run: |
        cd skia
        
        # åŸºç¡€æ„å»ºå‚æ•°è®¾ç½® - å¯ç”¨å…¨é‡åŠŸèƒ½
        args="is_official_build=true"
        args="$args skia_use_system_expat=false"
        args="$args skia_use_system_icu=false"
        args="$args skia_use_system_libjpeg_turbo=false"
        args="$args skia_use_system_libpng=false"
        args="$args skia_use_system_libwebp=false"
        args="$args skia_use_system_zlib=false"
        
        # å¯ç”¨å…¨é‡åŠŸèƒ½æ”¯æŒï¼Œä½†ä½¿ç”¨å†…ç½®ä¾èµ–åº“
        args="$args skia_enable_pdf=true"
        args="$args skia_enable_skottie=true"
        args="$args skia_enable_skshaper=true"
        args="$args skia_enable_svg=true"
        args="$args skia_use_icu=true"
        
        # å¯ç”¨GPUåç«¯æ”¯æŒ - åŒ…å«Dawn WebGPUå’ŒGraphite
        args="$args skia_enable_gpu=true"
        args="$args skia_enable_graphite=true"
        args="$args skia_use_gl=true"
        args="$args skia_use_vulkan=true"
        args="$args skia_use_dawn=true"
        args="$args skia_enable_spirv_validation=false"
        
        # å…¨å±€å¼ºåˆ¶ä½¿ç”¨C++20æ ‡å‡†
        args="$args dawn_use_built_dxc=false"
        
        # ç¦ç”¨å·¥å…·æ„å»ºä»¥é¿å…æµ‹è¯•å·¥å…·APIé—®é¢˜
        args="$args skia_enable_tools=false"
        
        # è®¾ç½®ç›®æ ‡å¹³å°å’Œæ¶æ„
        args="$args target_os=\"${{ matrix.target_os }}\""
        args="$args target_cpu=\"${{ matrix.target_cpu }}\""
        
        # æ ¹æ®ä¸åŒå¹³å°è®¾ç½®ç‰¹å®šå‚æ•°å’ŒDawnåç«¯ï¼Œå¼ºåˆ¶C++20æ”¯æŒ
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°ç‰¹å®šé…ç½® - å¼ºåˆ¶C++20
            args="$args skia_use_angle=true"
            args="$args skia_use_direct3d=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=false"
            args="$args skia_use_piex=false"
            # è®¾ç½®Windowsä½¿ç”¨/MDè¿è¡Œæ—¶å’Œå¼ºåˆ¶C++20
            args="$args extra_cflags=[\"/MD\", \"/std:c++20\", \"/Zc:__cplusplus\"]"
            args="$args extra_cflags_c=[\"/MD\"]"
            args="$args extra_cflags_cc=[\"/MD\", \"/std:c++20\", \"/Zc:__cplusplus\"]"
            # Dawn Windowsç‰¹å®šè®¾ç½®
            args="$args dawn_enable_d3d12=true"
            args="$args dawn_enable_d3d11=true"
            args="$args dawn_enable_vulkan=true"
            args="$args dawn_enable_opengles=false"
            args="$args dawn_enable_desktop_gl=false"
            args="$args dawn_enable_metal=false"
            args="$args dawn_enable_null=false"
            ;;
          "mac")
            # macOSå¹³å°ç‰¹å®šé…ç½® - å¼ºåˆ¶C++20å’Œlibc++
            args="$args skia_use_metal=true"
            args="$args skia_enable_skottie=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_fontconfig=false"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_pdf_subset_harfbuzz=true"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            # å¼ºåˆ¶è®¾ç½®C++20æ”¯æŒï¼Œæ˜ç¡®æŒ‡å®šæ‰€æœ‰C++æ ‡å¿—
            args="$args extra_cflags=[\"-std=c++20\", \"-stdlib=libc++\"]"
            args="$args extra_cflags_cc=[\"-std=c++20\", \"-stdlib=libc++\", \"-Wno-unknown-warning-option\", \"-Wno-c++20-extensions\"]"
            args="$args extra_ldflags=[\"-stdlib=libc++\"]"
            # ç¡®ä¿Dawnä¹Ÿä½¿ç”¨C++20
            args="$args dawn_cxx_version=20"
            # Dawn macOSç‰¹å®šè®¾ç½®
            args="$args dawn_enable_metal=true"
            args="$args dawn_enable_vulkan=false"
            args="$args dawn_enable_opengles=false"
            args="$args dawn_enable_desktop_gl=false"
            args="$args dawn_enable_d3d12=false"
            args="$args dawn_enable_d3d11=false"
            args="$args dawn_enable_null=false"
            if [ "${{ matrix.target_cpu }}" = "arm64" ]; then
              args="$args target_cpu=\"arm64\""
            fi
            ;;
          "linux")
            # Linuxå¹³å°ç‰¹å®šé…ç½® - å¼ºåˆ¶C++20
            args="$args skia_use_x11=true"
            args="$args skia_use_freetype=true"
            args="$args skia_use_fontconfig=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            # å¼ºåˆ¶è®¾ç½®C++20æ”¯æŒ
            args="$args extra_cflags=[\"-std=c++20\"]"
            args="$args extra_cflags_cc=[\"-std=c++20\"]"
            # Dawn Linuxç‰¹å®šè®¾ç½®
            args="$args dawn_enable_vulkan=true"
            args="$args dawn_enable_opengles=true"
            args="$args dawn_enable_desktop_gl=true"
            args="$args dawn_use_x11=true"
            args="$args dawn_enable_metal=false"
            args="$args dawn_enable_d3d12=false"
            args="$args dawn_enable_d3d11=false"
            args="$args dawn_enable_null=false"
            args="$args cc=\"gcc-12\""
            args="$args cxx=\"g++-12\""
            args="$args skia_use_system_freetype2=true"
            args="$args skia_use_system_harfbuzz=true"
            ;;
          "android")
            # Androidå¹³å°ç‰¹å®šé…ç½® - å¼ºåˆ¶C++20
            args="$args ndk=\"$ANDROID_NDK_ROOT\""
            args="$args android_api_level=${{ matrix.android_api }}"
            args="$args skia_use_system_freetype2=false"
            args="$args skia_use_freetype=true"
            args="$args skia_enable_fontmgr_android=true"
            args="$args skia_use_vulkan=true"
            args="$args skia_use_harfbuzz=true"
            args="$args skia_use_system_harfbuzz=false"
            args="$args skia_use_dng_sdk=true"
            args="$args skia_use_piex=true"
            # å¼ºåˆ¶è®¾ç½®C++20æ”¯æŒ
            args="$args extra_cflags=[\"-std=c++20\"]"
            args="$args extra_cflags_cc=[\"-std=c++20\"]"
            # Dawn Androidç‰¹å®šè®¾ç½®
            args="$args dawn_enable_vulkan=true"
            args="$args dawn_enable_opengles=true"
            args="$args dawn_enable_desktop_gl=false"
            args="$args dawn_enable_metal=false"
            args="$args dawn_enable_d3d12=false"
            args="$args dawn_enable_d3d11=false"
            args="$args dawn_enable_null=false"
            ;;
        esac
        
        echo "æ„å»ºå‚æ•°é…ç½®å®Œæˆï¼Œæ‰€æœ‰å¹³å°å¼ºåˆ¶ä½¿ç”¨C++20æ ‡å‡†"
        echo "BUILD_ARGS=$args" >> $GITHUB_ENV
      shell: bash
      
    # ä½¿ç”¨GNç”Ÿæˆæ„å»ºæ–‡ä»¶ï¼ŒéªŒè¯C++20é…ç½®
    - name: ç”ŸæˆDawn WebGPUå’ŒGraphiteæ„å»ºæ–‡ä»¶ï¼ˆéªŒè¯C++20ï¼‰
      run: |
        cd skia
        echo "æ­£åœ¨ä¸º ${{ matrix.target_os }} å¹³å°ç”Ÿæˆæ„å»ºæ–‡ä»¶ï¼Œå¼ºåˆ¶ä½¿ç”¨C++20..."
        bin/gn gen out/Release --args="$BUILD_ARGS"
        
        # éªŒè¯ç”Ÿæˆçš„æ„å»ºæ–‡ä»¶ä¸­æ˜¯å¦åŒ…å«C++20è®¾ç½®
        echo "éªŒè¯C++20é…ç½®..."
        if [ -f "out/Release/build.ninja" ]; then
          if grep -q "std=c++20\|std:c++20" out/Release/build.ninja; then
            echo "âœ… æ„å»ºé…ç½®ä¸­å·²æ­£ç¡®åŒ…å«C++20æ ‡å‡†"
          else
            echo "âš ï¸  æ„å»ºé…ç½®ä¸­æœªæ‰¾åˆ°C++20æ ‡å‡†ï¼Œä½†ä¼šç»§ç»­å°è¯•æ„å»º"
          fi
        fi
        
        case "${{ matrix.target_os }}" in
          "win")
            echo "Windowså¹³å°å·²å¯ç”¨: Direct3D 12/11 + Vulkanï¼Œå¼ºåˆ¶C++20"
            ;;
          "mac")
            echo "macOSå¹³å°å·²å¯ç”¨: Metalï¼Œå¼ºåˆ¶C++20 + libc++"
            ;;
          "linux")
            echo "Linuxå¹³å°å·²å¯ç”¨: Vulkan + OpenGLï¼Œå¼ºåˆ¶C++20"
            ;;
          "android")
            echo "Androidå¹³å°å·²å¯ç”¨: Vulkan + OpenGL ESï¼Œå¼ºåˆ¶C++20"
            ;;
        esac
      shell: bash
      
    # ä½¿ç”¨Ninjaç¼–è¯‘Skiaï¼Œç¡®ä¿C++20ç¼–è¯‘
    - name: ç¼–è¯‘Skia Dawn WebGPUå’ŒGraphiteç‰ˆæœ¬ï¼ˆC++20ï¼‰
      run: |
        cd skia
        echo "å¼€å§‹ç¼–è¯‘ ${{ matrix.target_os }} å¹³å°çš„Skia Dawn WebGPUç‰ˆæœ¬ï¼ˆä½¿ç”¨C++20æ ‡å‡†ï¼‰..."
        
        # æ ¹æ®å¹³å°è®¾ç½®å¹¶è¡Œç¼–è¯‘çº¿ç¨‹æ•°
        if [ "${{ matrix.target_os }}" = "android" ]; then
          echo "ä½¿ç”¨8çº¿ç¨‹ç¼–è¯‘Androidç‰ˆæœ¬..."
          ninja -C out/Release -j8
        elif [ "${{ matrix.target_os }}" = "mac" ]; then
          echo "ä½¿ç”¨4çº¿ç¨‹ç¼–è¯‘macOSç‰ˆæœ¬ï¼ˆé¿å…ç¼–è¯‘å™¨è¿‡è½½ï¼‰..."
          ninja -C out/Release -j4
        else
          echo "ä½¿ç”¨6çº¿ç¨‹ç¼–è¯‘å…¶ä»–å¹³å°ç‰ˆæœ¬..."
          ninja -C out/Release -j6
        fi
        
        echo "âœ… ${{ matrix.target_os }} å¹³å°Skia Dawn WebGPUç‰ˆæœ¬ç¼–è¯‘å®Œæˆï¼ˆC++20ï¼‰"
      shell: bash
      
    # åˆ›å»ºå¹³å°ç‰¹å®šçš„æ„å»ºäº§ç‰©
    - name: åˆ›å»ºå¹³å°æ„å»ºäº§ç‰©
      run: |
        cd skia
        
        # åˆ›å»ºå¹³å°ç‰¹å®šçš„è¾“å‡ºç›®å½•ç»“æ„
        mkdir -p artifacts/${{ matrix.platform }}/bin
        mkdir -p artifacts/${{ matrix.platform }}/lib
        mkdir -p artifacts/${{ matrix.platform }}/include
        mkdir -p artifacts/${{ matrix.platform }}/modules
        mkdir -p artifacts/${{ matrix.platform }}/dawn
        mkdir -p artifacts/${{ matrix.platform }}/examples
        
        # å¤åˆ¶å¤´æ–‡ä»¶
        cp -r include/* artifacts/${{ matrix.platform }}/include/
        
        # å¤åˆ¶modulesç›®å½•
        if [ -d "modules" ]; then
          cp -r modules/* artifacts/${{ matrix.platform }}/modules/ 2>/dev/null || true
        fi
        
        # å¤åˆ¶Dawnç›¸å…³å¤´æ–‡ä»¶
        if [ -d "third_party/externals/dawn/include" ]; then
          cp -r third_party/externals/dawn/include/* artifacts/${{ matrix.platform }}/dawn/ 2>/dev/null || true
        fi
        
        # å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
        if [ -d "resources" ]; then
          cp -r resources/* artifacts/${{ matrix.platform }}/examples/ 2>/dev/null || true
        fi
        
        # æ ¹æ®ä¸åŒå¹³å°å¤åˆ¶ç›¸åº”çš„åº“æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶
        case "${{ matrix.target_os }}" in
          "win")
            # Windowså¹³å°æ–‡ä»¶å¤åˆ¶
            find out/Release -name "*.lib" -exec cp {} artifacts/${{ matrix.platform }}/lib/ \; 2>/dev/null || true
            find out/Release -name "*.dll" -exec cp {} artifacts/${{ matrix.platform }}/bin/ \; 2>/dev/null || true
            find out/Release -name "*.exe" -exec cp {} artifacts/${{ matrix.platform }}/bin/ \; 2>/dev/null || true
            ;;
          "mac")
            # macOSå¹³å°æ–‡ä»¶å¤åˆ¶
            find out/Release -name "*.a" -exec cp {} artifacts/${{ matrix.platform }}/lib/ \; 2>/dev/null || true
            find out/Release -name "*.dylib" -exec cp {} artifacts/${{ matrix.platform }}/lib/ \; 2>/dev/null || true
            find out/Release -type f -perm +111 -name "*" -not -name "*.so" -not -name "*.dylib" -exec cp {} artifacts/${{ matrix.platform }}/bin/ \; 2>/dev/null || true
            ;;
          "linux"|"android")
            # Linuxå’ŒAndroidå¹³å°æ–‡ä»¶å¤åˆ¶
            find out/Release -name "*.a" -exec cp {} artifacts/${{ matrix.platform }}/lib/ \; 2>/dev/null || true
            find out/Release -name "*.so" -exec cp {} artifacts/${{ matrix.platform }}/lib/ \; 2>/dev/null || true
            find out/Release -type f -perm +111 -name "*" -not -name "*.so" -exec cp {} artifacts/${{ matrix.platform }}/bin/ \; 2>/dev/null || true
            ;;
        esac
        
        # åˆ›å»ºå¹³å°æ„å»ºä¿¡æ¯
        cat > artifacts/${{ matrix.platform }}/build_info.txt << EOF
        å¹³å°: ${{ matrix.target_os }}
        æ¶æ„: ${{ matrix.target_cpu }}
        C++æ ‡å‡†: C++20 (å¼ºåˆ¶)
        ç¼–è¯‘æ—¶é—´: $(date -u '+%Y-%m-%d %H:%M:%S UTC')
        Dawn WebGPU: å·²å¯ç”¨
        Graphiteæ¸²æŸ“å™¨: å·²å¯ç”¨
        EOF
        
        echo "âœ… ${{ matrix.platform }} å¹³å°æ„å»ºäº§ç‰©åˆ›å»ºå®Œæˆ"
      shell: bash
      
    # ä¸Šä¼ å¹³å°æ„å»ºäº§ç‰©
    - name: ä¸Šä¼ å¹³å°æ„å»ºäº§ç‰©
      uses: actions/upload-artifact@v4
      with:
        name: ${{ matrix.platform }}-artifacts
        path: skia/artifacts/${{ matrix.platform }}
        retention-days: 1  # åªä¿ç•™1å¤©ï¼Œå› ä¸ºæœ€ç»ˆä¼šåˆå¹¶åˆ°ç»Ÿä¸€åŒ…ä¸­
        compression-level: 6

  # åˆ›å»ºç»Ÿä¸€çš„Skiaé¢„ç¼–è¯‘åŒ…
  create-unified-package:
    needs: build-skia-all-platforms
    runs-on: ubuntu-latest
    
    permissions:
      contents: write
      packages: write
    
    steps:
    # æ£€å‡ºä»£ç ä»¥è·å–CMakeLists.txtæ¨¡æ¿
    - name: æ£€å‡ºä»£ç ä»“åº“
      uses: actions/checkout@v4
      
    # ä¸‹è½½æ‰€æœ‰å¹³å°çš„æ„å»ºäº§ç‰©
    - name: ä¸‹è½½æ‰€æœ‰å¹³å°æ„å»ºäº§ç‰©
      uses: actions/download-artifact@v4
      with:
        path: platform_artifacts
        
    # åˆ›å»ºç»Ÿä¸€çš„Skiaé¢„ç¼–è¯‘åŒ…ç»“æ„
    - name: åˆ›å»ºç»Ÿä¸€Skiaé¢„ç¼–è¯‘åŒ…
      run: |
        # åˆ›å»ºç»Ÿä¸€åŒ…çš„æ ¹ç›®å½•ç»“æ„
        mkdir -p Skia_Prebuilt/Skia/{bin,lib,include,modules,dawn,examples}
        
        # åˆ›å»ºå¹³å°ç‰¹å®šçš„ç›®å½•ç»“æ„
        # binç›®å½•ç»“æ„
        mkdir -p Skia_Prebuilt/Skia/bin/{Win/x64,macOS/x64,macOS/arm64,Linux/x64,Android/x64,Android/arm64}
        
        # libç›®å½•ç»“æ„
        mkdir -p Skia_Prebuilt/Skia/lib/{Win/x64,macOS/x64,macOS/arm64,Linux/x64,Android/x64,Android/arm64}
        
        # includeç›®å½• - æ‰€æœ‰å¹³å°å…±äº«
        # modulesç›®å½• - æ‰€æœ‰å¹³å°å…±äº«  
        # dawnç›®å½• - æ‰€æœ‰å¹³å°å…±äº«
        # examplesç›®å½• - æ‰€æœ‰å¹³å°å…±äº«
        
        # å¤„ç†æ¯ä¸ªå¹³å°çš„æ„å»ºäº§ç‰©
        echo "æ­£åœ¨æ•´ç†å„å¹³å°æ„å»ºäº§ç‰©..."
        
        # å¤„ç†Windows x64
        if [ -d "platform_artifacts/win_x64-artifacts" ]; then
          echo "å¤„ç†Windows x64æ„å»ºäº§ç‰©..."
          cp -r platform_artifacts/win_x64-artifacts/bin/* Skia_Prebuilt/Skia/bin/Win/x64/ 2>/dev/null || true
          cp -r platform_artifacts/win_x64-artifacts/lib/* Skia_Prebuilt/Skia/lib/Win/x64/ 2>/dev/null || true
          
          # ç¬¬ä¸€æ¬¡å¤åˆ¶å…±äº«æ–‡ä»¶
          cp -r platform_artifacts/win_x64-artifacts/include/* Skia_Prebuilt/Skia/include/ 2>/dev/null || true
          cp -r platform_artifacts/win_x64-artifacts/modules/* Skia_Prebuilt/Skia/modules/ 2>/dev/null || true
          cp -r platform_artifacts/win_x64-artifacts/dawn/* Skia_Prebuilt/Skia/dawn/ 2>/dev/null || true
          cp -r platform_artifacts/win_x64-artifacts/examples/* Skia_Prebuilt/Skia/examples/ 2>/dev/null || true
        fi
        
        # å¤„ç†macOS x64
        if [ -d "platform_artifacts/macos_x64-artifacts" ]; then
          echo "å¤„ç†macOS x64æ„å»ºäº§ç‰©..."
          cp -r platform_artifacts/macos_x64-artifacts/bin/* Skia_Prebuilt/Skia/bin/macOS/x64/ 2>/dev/null || true
          cp -r platform_artifacts/macos_x64-artifacts/lib/* Skia_Prebuilt/Skia/lib/macOS/x64/ 2>/dev/null || true
          
          # æ›´æ–°å…±äº«æ–‡ä»¶ï¼ˆåˆå¹¶å·®å¼‚ï¼‰
          cp -r platform_artifacts/macos_x64-artifacts/include/* Skia_Prebuilt/Skia/include/ 2>/dev/null || true
          cp -r platform_artifacts/macos_x64-artifacts/modules/* Skia_Prebuilt/Skia/modules/ 2>/dev/null || true
          cp -r platform_artifacts/macos_x64-artifacts/dawn/* Skia_Prebuilt/Skia/dawn/ 2>/dev/null || true
        fi
        
        # å¤„ç†macOS ARM64
        if [ -d "platform_artifacts/macos_arm64-artifacts" ]; then
          echo "å¤„ç†macOS ARM64æ„å»ºäº§ç‰©..."
          cp -r platform_artifacts/macos_arm64-artifacts/bin/* Skia_Prebuilt/Skia/bin/macOS/arm64/ 2>/dev/null || true
          cp -r platform_artifacts/macos_arm64-artifacts/lib/* Skia_Prebuilt/Skia/lib/macOS/arm64/ 2>/dev/null || true
        fi
        
        # å¤„ç†Linux x64
        if [ -d "platform_artifacts/linux_x64-artifacts" ]; then
          echo "å¤„ç†Linux x64æ„å»ºäº§ç‰©..."
          cp -r platform_artifacts/linux_x64-artifacts/bin/* Skia_Prebuilt/Skia/bin/Linux/x64/ 2>/dev/null || true
          cp -r platform_artifacts/linux_x64-artifacts/lib/* Skia_Prebuilt/Skia/lib/Linux/x64/ 2>/dev/null || true
        fi
        
        # å¤„ç†Android x64
        if [ -d "platform_artifacts/android_x64-artifacts" ]; then
          echo "å¤„ç†Android x64æ„å»ºäº§ç‰©..."
          cp -r platform_artifacts/android_x64-artifacts/bin/* Skia_Prebuilt/Skia/bin/Android/x64/ 2>/dev/null || true
          cp -r platform_artifacts/android_x64-artifacts/lib/* Skia_Prebuilt/Skia/lib/Android/x64/ 2>/dev/null || true
        fi
        
        # å¤„ç†Android ARM64
        if [ -d "platform_artifacts/android_arm64-artifacts" ]; then
          echo "å¤„ç†Android ARM64æ„å»ºäº§ç‰©..."
          cp -r platform_artifacts/android_arm64-artifacts/bin/* Skia_Prebuilt/Skia/bin/Android/arm64/ 2>/dev/null || true
          cp -r platform_artifacts/android_arm64-artifacts/lib/* Skia_Prebuilt/Skia/lib/Android/arm64/ 2>/dev/null || true
        fi
        
        echo "âœ… ç»Ÿä¸€Skiaé¢„ç¼–è¯‘åŒ…ç»“æ„åˆ›å»ºå®Œæˆ"
        
        # æ˜¾ç¤ºç›®å½•ç»“æ„
        echo "ğŸ“ ç»Ÿä¸€åŒ…ç›®å½•ç»“æ„ï¼š"
        find Skia_Prebuilt -type d | head -20
        
        # ç»Ÿè®¡æ–‡ä»¶æ•°é‡
        echo "ğŸ“Š å„å¹³å°åº“æ–‡ä»¶ç»Ÿè®¡ï¼š"
        for platform_dir in Skia_Prebuilt/Skia/lib/*/; do
          if [ -d "$platform_dir" ]; then
            count=$(find "$platform_dir" -type f | wc -l)
            echo "  $(basename "$(dirname "$platform_dir")"): $count ä¸ªæ–‡ä»¶"
          fi
        done
      
    # ç”Ÿæˆç»Ÿä¸€çš„CMakeLists.txtæ–‡ä»¶ï¼Œæ”¯æŒC++20
    - name: ç”Ÿæˆç»Ÿä¸€CMakeLists.txtï¼ˆC++20æ”¯æŒï¼‰
      run: |
        # ç”Ÿæˆæ ¹ç›®å½•çš„CMakeLists.txtæ–‡ä»¶ï¼Œæ”¯æŒæ‰€æœ‰å¹³å°å’ŒC++20
        cat > Skia_Prebuilt/Skia/CMakeLists.txt << 'EOF'
        # Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åº“çš„CMakeé…ç½®æ–‡ä»¶ï¼ˆå®Œæ•´C++20æ”¯æŒï¼‰
        cmake_minimum_required(VERSION 3.15)
        
        # è®¾ç½®é¡¹ç›®ä¿¡æ¯
        project(SkiaPrebuiltUnified
            VERSION 1.0.0
            DESCRIPTION "Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åº“ - æ”¯æŒæ‰€æœ‰å¹³å°ï¼ˆå¼ºåˆ¶C++20ï¼‰"
            LANGUAGES CXX C
        )
        
        # å¼ºåˆ¶è®¾ç½®C++20æ ‡å‡†ï¼ˆDawn WebGPUå¿…éœ€ï¼‰
        set(CMAKE_CXX_STANDARD 20)
        set(CMAKE_CXX_STANDARD_REQUIRED ON)
        set(CMAKE_CXX_EXTENSIONS OFF)
        
        # ç¡®ä¿ç¼–è¯‘å™¨æ”¯æŒC++20
        if(CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
            if(CMAKE_CXX_COMPILER_VERSION VERSION_LESS "19.29")
                message(FATAL_ERROR "MSVCç‰ˆæœ¬è¿‡æ—§ï¼Œéœ€è¦Visual Studio 2019 16.11+æˆ–æ›´æ–°ç‰ˆæœ¬ä»¥æ”¯æŒC++20")
            endif()
        elseif(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
            if(CMAKE_CXX_COMPILER_VERSION VERSION_LESS "10")
                message(FATAL_ERROR "GCCç‰ˆæœ¬è¿‡æ—§ï¼Œéœ€è¦GCC 10+ä»¥æ”¯æŒC++20")
            endif()
        elseif(CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
            if(CMAKE_CXX_COMPILER_VERSION VERSION_LESS "12")
                message(FATAL_ERROR "Clangç‰ˆæœ¬è¿‡æ—§ï¼Œéœ€è¦Clang 12+ä»¥æ”¯æŒC++20")
            endif()
        endif()
        
        # è·å–å½“å‰ç›®å½•
        get_filename_component(SKIA_ROOT_DIR "${CMAKE_CURRENT_LIST_DIR}" ABSOLUTE)
        
        # æ£€æµ‹å¹³å°å’Œæ¶æ„
        if(WIN32)
            set(PLATFORM_NAME "Win")
            if(CMAKE_SIZEOF_VOID_P EQUAL 8)
                set(ARCH_NAME "x64")
            else()
                message(FATAL_ERROR "ä¸æ”¯æŒçš„Windowsæ¶æ„ï¼Œä»…æ”¯æŒx64")
            endif()
        elseif(APPLE)
            set(PLATFORM_NAME "macOS")
            if(CMAKE_SYSTEM_PROCESSOR MATCHES "arm64|aarch64")
                set(ARCH_NAME "arm64")
            else()
                set(ARCH_NAME "x64")
            endif()
        elseif(ANDROID)
            set(PLATFORM_NAME "Android")
            if(CMAKE_ANDROID_ARCH_ABI STREQUAL "arm64-v8a")
                set(ARCH_NAME "arm64")
            elseif(CMAKE_ANDROID_ARCH_ABI STREQUAL "x86_64")
                set(ARCH_NAME "x64")
            else()
                message(FATAL_ERROR "ä¸æ”¯æŒçš„Androidæ¶æ„: ${CMAKE_ANDROID_ARCH_ABI}")
            endif()
        else()
            set(PLATFORM_NAME "Linux")
            if(CMAKE_SIZEOF_VOID_P EQUAL 8)
                set(ARCH_NAME "x64")
            else()
                message(FATAL_ERROR "ä¸æ”¯æŒçš„Linuxæ¶æ„ï¼Œä»…æ”¯æŒx64")
            endif()
        endif()
        
        # è®¾ç½®å¹³å°ç‰¹å®šçš„åº“å’ŒäºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„
        set(PLATFORM_LIB_DIR "${SKIA_ROOT_DIR}/lib/${PLATFORM_NAME}/${ARCH_NAME}")
        set(PLATFORM_BIN_DIR "${SKIA_ROOT_DIR}/bin/${PLATFORM_NAME}/${ARCH_NAME}")
        
        # æ£€æŸ¥å¹³å°ç›®å½•æ˜¯å¦å­˜åœ¨
        if(NOT EXISTS "${PLATFORM_LIB_DIR}")
            message(FATAL_ERROR "å¹³å°åº“ç›®å½•ä¸å­˜åœ¨: ${PLATFORM_LIB_DIR}")
        endif()
        
        # åˆ›å»ºskdnæ¥å£åº“ï¼ˆSkia + Dawnï¼‰
        add_library(skdn INTERFACE)
        add_library(skdn::skdn ALIAS skdn)
        
        # è®¾ç½®åŒ…å«ç›®å½•
        target_include_directories(skdn INTERFACE
            $<BUILD_INTERFACE:${SKIA_ROOT_DIR}>
            $<BUILD_INTERFACE:${SKIA_ROOT_DIR}/include>
            $<BUILD_INTERFACE:${SKIA_ROOT_DIR}/modules>
            $<BUILD_INTERFACE:${SKIA_ROOT_DIR}/dawn>
            $<INSTALL_INTERFACE:include>
            $<INSTALL_INTERFACE:modules>
            $<INSTALL_INTERFACE:dawn>
        )
        
        # æŸ¥æ‰¾å¹³å°ç‰¹å®šçš„åº“æ–‡ä»¶
        file(GLOB SKIA_LIBRARIES "${PLATFORM_LIB_DIR}/*")
        
        # æ ¹æ®å¹³å°è®¾ç½®ç‰¹å®šçš„ç¼–è¯‘å®šä¹‰å’Œé“¾æ¥åº“
        if(WIN32)
            # Windowså¹³å°é…ç½® - å¼ºåˆ¶C++20æ”¯æŒ
            target_compile_definitions(skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_VULKAN=1
                SK_GL=1
                SK_DAWN=1
                SK_BUILD_FOR_WIN=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                UNICODE
                _UNICODE
            )
            
            # è®¾ç½®Windowsè¿è¡Œæ—¶å’Œå¼ºåˆ¶C++20æ”¯æŒ
            target_compile_options(skdn INTERFACE
                $<$<CONFIG:Debug>:/MDd>
                $<$<CONFIG:Release>:/MD>
                $<$<CONFIG:RelWithDebInfo>:/MD>
                $<$<CONFIG:MinSizeRel>:/MD>
                /std:c++20
                /Zc:__cplusplus  # ç¡®ä¿æ­£ç¡®çš„C++ç‰ˆæœ¬å®
            )
            
            # æ·»åŠ Windowsç³»ç»Ÿåº“
            target_link_libraries(skdn INTERFACE
                ${SKIA_LIBRARIES}
                # OpenGLç›¸å…³
                OpenGL32
                # DirectXç›¸å…³ï¼ˆDawn WebGPU Windowsåç«¯ï¼‰
                d3d11
                d3d12
                dxgi
                d3dcompiler
                dxguid
                # ç³»ç»Ÿåº“
                Gdi32
                User32
                Kernel32
                Ole32
                OleAut32
                Uuid
                Advapi32
                Shell32
                Usp10
                Ws2_32
            )
            
        elseif(APPLE)
            # macOSå¹³å°é…ç½® - å¼ºåˆ¶C++20å’Œlibc++
            target_compile_definitions(skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_METAL=1
                SK_GL=1
                SK_VULKAN=1
                SK_DAWN=1
                SK_BUILD_FOR_MAC=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
            )
            
            # å¼ºåˆ¶è®¾ç½®C++20æ”¯æŒå’Œlibc++
            target_compile_options(skdn INTERFACE
                -std=c++20
                -stdlib=libc++
                -Wno-unknown-warning-option
                -Wno-c++20-extensions
                -Wno-c++20-compat
            )
            
            target_link_options(skdn INTERFACE
                -stdlib=libc++
            )
            
            # æŸ¥æ‰¾macOSç³»ç»Ÿæ¡†æ¶
            find_library(FOUNDATION_FRAMEWORK Foundation)
            find_library(COREGRAPHICS_FRAMEWORK CoreGraphics)
            find_library(CORETEXT_FRAMEWORK CoreText)
            find_library(COREFOUNDATION_FRAMEWORK CoreFoundation)
            find_library(COCOA_FRAMEWORK Cocoa)
            find_library(METAL_FRAMEWORK Metal)
            find_library(METALKIT_FRAMEWORK MetalKit)
            find_library(OPENGL_FRAMEWORK OpenGL)
            find_library(QUARTZCORE_FRAMEWORK QuartzCore)
            find_library(IOSURFACE_FRAMEWORK IOSurface)
            
            target_link_libraries(skdn INTERFACE
                ${SKIA_LIBRARIES}
                ${FOUNDATION_FRAMEWORK}
                ${COREGRAPHICS_FRAMEWORK}
                ${CORETEXT_FRAMEWORK}
                ${COREFOUNDATION_FRAMEWORK}
                ${COCOA_FRAMEWORK}
                ${METAL_FRAMEWORK}
                ${METALKIT_FRAMEWORK}
                ${OPENGL_FRAMEWORK}
                ${QUARTZCORE_FRAMEWORK}
                ${IOSURFACE_FRAMEWORK}
            )
            
        elseif(ANDROID)
            # Androidå¹³å°é…ç½® - å¼ºåˆ¶C++20
            target_compile_definitions(skdn INTERFACE
                ANDROID
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_VULKAN=1
                SK_GL=1
                SK_DAWN=1
                SK_BUILD_FOR_ANDROID=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
                __ANDROID_API__=21
            )
            
            target_compile_options(skdn INTERFACE
                -std=c++20
                -fPIC
                -fno-rtti
                -fno-exceptions
            )
            
            target_link_libraries(skdn INTERFACE
                ${SKIA_LIBRARIES}
                GLESv2
                EGL
                vulkan
                android
                log
                jnigraphics
                mediandk
                dl
                m
                z
            )
            
            target_link_options(skdn INTERFACE
                -Wl,--gc-sections
                -Wl,--as-needed
            )
            
        else()
            # Linuxå¹³å°é…ç½® - å¼ºåˆ¶C++20
            target_compile_definitions(skdn INTERFACE
                SK_GANESH=1
                SK_GRAPHITE=1
                SK_VULKAN=1
                SK_GL=1
                SK_DAWN=1
                SK_BUILD_FOR_UNIX=1
                SK_ENABLE_SKOTTIE=1
                SK_ENABLE_SVG=1
            )
            
            target_compile_options(skdn INTERFACE
                -std=c++20
            )
            
            # æŸ¥æ‰¾Linuxç³»ç»Ÿåº“
            find_package(PkgConfig QUIET)
            if(PKG_CONFIG_FOUND)
                pkg_check_modules(FONTCONFIG QUIET fontconfig)
                pkg_check_modules(HARFBUZZ QUIET harfbuzz)
            endif()
            
            find_package(Vulkan QUIET)
            find_package(X11 QUIET)
            
            target_link_libraries(skdn INTERFACE
                ${SKIA_LIBRARIES}
                GL
                pthread
                dl
                m
            )
            
            # å¯é€‰ç³»ç»Ÿåº“æ”¯æŒ
            if(FONTCONFIG_FOUND)
                target_link_libraries(skdn INTERFACE ${FONTCONFIG_LIBRARIES})
                target_include_directories(skdn INTERFACE ${FONTCONFIG_INCLUDE_DIRS})
            endif()
            
            if(HARFBUZZ_FOUND)
                target_link_libraries(skdn INTERFACE ${HARFBUZZ_LIBRARIES})
                target_include_directories(skdn INTERFACE ${HARFBUZZ_INCLUDE_DIRS})
            endif()
            
            if(Vulkan_FOUND)
                target_link_libraries(skdn INTERFACE ${Vulkan_LIBRARIES})
                target_include_directories(skdn INTERFACE ${Vulkan_INCLUDE_DIRS})
            endif()
            
            if(X11_FOUND)
                target_link_libraries(skdn INTERFACE
                    ${X11_LIBRARIES}
                    ${X11_Xrandr_LIB}
                    ${X11_Xinerama_LIB}
                    ${X11_Xcursor_LIB}
                    ${X11_Xi_LIB}
                )
                target_include_directories(skdn INTERFACE ${X11_INCLUDE_DIR})
            endif()
        endif()
        
        # å¼ºåˆ¶è®¾ç½®ç¼–è¯‘ç‰¹æ€§ä¸ºC++20
        target_compile_features(skdn INTERFACE cxx_std_20)
        
        # ä¼˜åŒ–è®¾ç½®
        target_compile_options(skdn INTERFACE
            $<$<CONFIG:Debug>:-g -O0>
            $<$<CONFIG:Release>:-O3 -DNDEBUG>
            $<$<CONFIG:RelWithDebInfo>:-O2 -g -DNDEBUG>
        )
        
        # é¢„å¤„ç†å™¨å®šä¹‰
        target_compile_definitions(skdn INTERFACE
            $<$<CONFIG:Debug>:SK_DEBUG>
            $<$<CONFIG:Release>:SK_RELEASE>
        )
        
        # æ˜¾ç¤ºé…ç½®ä¿¡æ¯
        message(STATUS "Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åº“é…ç½®å®Œæˆï¼ˆå¼ºåˆ¶C++20ï¼‰")
        message(STATUS "  - æ£€æµ‹åˆ°çš„å¹³å°: ${PLATFORM_NAME}")
        message(STATUS "  - æ£€æµ‹åˆ°çš„æ¶æ„: ${ARCH_NAME}")
        message(STATUS "  - åº“æ–‡ä»¶ç›®å½•: ${PLATFORM_LIB_DIR}")
        message(STATUS "  - äºŒè¿›åˆ¶æ–‡ä»¶ç›®å½•: ${PLATFORM_BIN_DIR}")
        message(STATUS "  - æ‰¾åˆ°åº“æ–‡ä»¶æ•°é‡: ${SKIA_LIBRARIES}")
        message(STATUS "  - C++æ ‡å‡†: C++20 (å¼ºåˆ¶)")
        message(STATUS "  - ç¼–è¯‘å™¨: ${CMAKE_CXX_COMPILER_ID} ${CMAKE_CXX_COMPILER_VERSION}")
        message(STATUS "  - æ”¯æŒçš„GPUåç«¯:")
        if(WIN32)
            message(STATUS "    â€¢ Direct3D 12/11 + Vulkan (é€šè¿‡Dawn WebGPU)")
        elseif(APPLE)
            message(STATUS "    â€¢ Metal (é€šè¿‡Dawn WebGPU)")
        elseif(ANDROID)
            message(STATUS "    â€¢ Vulkan + OpenGL ES (é€šè¿‡Dawn WebGPU)")
        else()
            message(STATUS "    â€¢ Vulkan + OpenGL (é€šè¿‡Dawn WebGPU)")
        endif()
        message(STATUS "  - æ”¯æŒçš„åŠŸèƒ½: PDF, SVG, Skottie, æ–‡æœ¬æ•´å½¢, é¢œè‰²ç®¡ç†")
        message(STATUS "  - æ¸²æŸ“æ¶æ„: Ganesh + Graphite + Dawn WebGPU")
        
        # åˆ›å»ºä¾¿æ·çš„ä½¿ç”¨è¯´æ˜å‡½æ•°
        function(skdn_usage_example)
            message(STATUS "")
            message(STATUS "ä½¿ç”¨ç¤ºä¾‹:")
            message(STATUS "  # åœ¨ä½ çš„CMakeLists.txtä¸­:")
            message(STATUS "  set(CMAKE_CXX_STANDARD 20)  # å¿…éœ€")
            message(STATUS "  add_subdirectory(path/to/Skia)")
            message(STATUS "  target_link_libraries(your_target skdn::skdn)")
            message(STATUS "")
            message(STATUS "  # C++ä»£ç ç¤ºä¾‹:")
            message(STATUS "  #include <include/core/SkSurface.h>")
            message(STATUS "  #include <include/gpu/graphite/Context.h>")
            message(STATUS "  #include <include/gpu/ganesh/dawn/GrDawnDirectContext.h>")
            message(STATUS "")
        endfunction()
        
        # è‡ªåŠ¨æ˜¾ç¤ºä½¿ç”¨ç¤ºä¾‹
        skdn_usage_example()
        EOF
        
        echo "âœ… ç»Ÿä¸€CMakeLists.txtæ–‡ä»¶ç”Ÿæˆå®Œæˆï¼ˆå¼ºåˆ¶C++20æ”¯æŒï¼‰"
      
    # åˆ›å»ºç»Ÿä¸€åŒ…çš„è¯´æ˜æ–‡æ¡£
    - name: åˆ›å»ºç»Ÿä¸€åŒ…è¯´æ˜æ–‡æ¡£
      run: |
        cat > Skia_Prebuilt/Skia/README.md << 'EOF'
        # Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åº“ï¼ˆå¼ºåˆ¶C++20æ”¯æŒï¼‰
        
        è¿™æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸»æµå¹³å°å’Œæ¶æ„çš„Skiaå›¾å½¢åº“é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼Œå¯ç”¨äº†Dawn WebGPUåç«¯å’ŒGraphiteæ¸²æŸ“å™¨ï¼Œ**å¼ºåˆ¶ä½¿ç”¨C++20æ ‡å‡†**ã€‚
        
        ## âš ï¸ é‡è¦è¯´æ˜
        
        **æ­¤åº“å¼ºåˆ¶è¦æ±‚C++20æ ‡å‡†æ”¯æŒ**ï¼Œå› ä¸ºDawn WebGPUä½¿ç”¨äº†C++20çš„Conceptsç‰¹æ€§ã€‚
        
        ### ç¼–è¯‘å™¨æœ€ä½ç‰ˆæœ¬è¦æ±‚
        - **Windows**: Visual Studio 2019 16.11+ æˆ– Visual Studio 2022
        - **macOS**: Xcode 13+ (Clang 12+)
        - **Linux**: GCC 10+ æˆ– Clang 12+
        - **Android**: NDK r23c+ (Clang 12+)
        
        ## æ”¯æŒçš„å¹³å°å’Œæ¶æ„
        
        ### Windows
        - Win/x64 - Windows x64æ¶æ„
        - Dawnåç«¯: Direct3D 12/11 + Vulkan
        
        ### macOS
        - macOS/x64 - macOS Intelæ¶æ„
        - macOS/arm64 - macOS Apple Siliconæ¶æ„
        - Dawnåç«¯: Metal
        
        ### Linux
        - Linux/x64 - Linux x64æ¶æ„
        - Dawnåç«¯: Vulkan + OpenGL
        
        ### Android
        - Android/x64 - Android x64æ¶æ„
        - Android/arm64 - Android ARM64æ¶æ„
        - Dawnåç«¯: Vulkan + OpenGL ES
        
        ## ç›®å½•ç»“æ„
        
        ```
        Skia/
        â”œâ”€â”€ bin/                    # å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæŒ‰å¹³å°åˆ†ç±»ï¼‰
        â”‚   â”œâ”€â”€ Win/x64/
        â”‚   â”œâ”€â”€ macOS/x64/
        â”‚   â”œâ”€â”€ macOS/arm64/
        â”‚   â”œâ”€â”€ Linux/x64/
        â”‚   â”œâ”€â”€ Android/x64/
        â”‚   â””â”€â”€ Android/arm64/
        â”œâ”€â”€ lib/                    # åº“æ–‡ä»¶ï¼ˆæŒ‰å¹³å°åˆ†ç±»ï¼‰
        â”‚   â”œâ”€â”€ Win/x64/
        â”‚   â”œâ”€â”€ macOS/x64/
        â”‚   â”œâ”€â”€ macOS/arm64/
        â”‚   â”œâ”€â”€ Linux/x64/
        â”‚   â”œâ”€â”€ Android/x64/
        â”‚   â””â”€â”€ Android/arm64/
        â”œâ”€â”€ include/                # å…±äº«å¤´æ–‡ä»¶
        â”œâ”€â”€ modules/                # Skiaæ¨¡å—
        â”œâ”€â”€ dawn/                   # Dawn WebGPUå¤´æ–‡ä»¶
        â”œâ”€â”€ examples/               # ç¤ºä¾‹èµ„æº
        â”œâ”€â”€ CMakeLists.txt          # CMakeé…ç½®æ–‡ä»¶ï¼ˆå¼ºåˆ¶C++20ï¼‰
        â””â”€â”€ README.md               # æœ¬æ–‡æ¡£
        ```
        
        ## ä½¿ç”¨æ–¹æ³•
        
        ### CMakeé›†æˆï¼ˆå¿…éœ€C++20ï¼‰
        
        ```cmake
        # å¼ºåˆ¶è®¾ç½®C++20æ ‡å‡†ï¼ˆå¿…éœ€ï¼‰
        set(CMAKE_CXX_STANDARD 20)
        set(CMAKE_CXX_STANDARD_REQUIRED ON)
        set(CMAKE_CXX_EXTENSIONS OFF)
        
        # æ·»åŠ Skiaå­ç›®å½•
        add_subdirectory(path/to/Skia)
        
        # é“¾æ¥åˆ°ä½ çš„é¡¹ç›®
        target_link_libraries(your_project skdn::skdn)
        ```
        
        ### å¹³å°ç‰¹æ®Šé…ç½®
        
        #### macOSï¼ˆå¼ºåˆ¶libc++ï¼‰
        ```cmake
        if(APPLE)
            set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -stdlib=libc++")
            set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} -stdlib=libc++")
        endif()
        ```
        
        #### Windowsï¼ˆC++20æ ‡å¿—ï¼‰
        ```cmake
        if(WIN32 AND MSVC)
            target_compile_options(your_target PRIVATE /std:c++20 /Zc:__cplusplus)
        endif()
        ```
        
        ## C++20ç‰¹æ€§ä½¿ç”¨
        
        æ­¤åº“ä½¿ç”¨äº†ä»¥ä¸‹C++20ç‰¹æ€§ï¼š
        - **Concepts** - Dawn WebGPUçš„ç±»å‹çº¦æŸ
        - **é»˜è®¤æ¯”è¾ƒæ“ä½œç¬¦** - `operator<=>`
        - **consteval** - ç¼–è¯‘æ—¶è®¡ç®—
        - **requireså­å¥** - æ¨¡æ¿çº¦æŸ
        
        ### ç¤ºä¾‹ä»£ç 
        ```cpp
        #include <concepts>  // C++20å¤´æ–‡ä»¶
        #include <include/core/SkSurface.h>
        #include <include/gpu/graphite/Context.h>
        #include <include/gpu/ganesh/dawn/GrDawnDirectContext.h>
        
        // ä½¿ç”¨C++20 Conceptsç‰¹æ€§
        template<std::integral T>
        void processIntegralType(T value) {
            // å¤„ç†æ•´æ•°ç±»å‹
        }
        
        int main() {
            // Dawn WebGPUä¸Šä¸‹æ–‡åˆ›å»º
            // ... Dawnè®¾å¤‡åˆå§‹åŒ–ä»£ç  ...
            
            auto grContext = GrDirectContext::MakeDawn(dawnBackendContext);
            auto surface = SkSurface::MakeRenderTarget(
                grContext.get(),
                SkBudgeted::kNo,
                SkImageInfo::MakeN32Premul(800, 600)
            );
            
            return 0;
        }
        ```
        
        ## ç‰¹æ€§æ”¯æŒ
        
        - âœ… **Dawn WebGPU** - ç°ä»£è·¨å¹³å°GPU APIï¼ˆéœ€è¦C++20ï¼‰
        - âœ… **Graphiteæ¸²æŸ“å™¨** - æ–°ä¸€ä»£GPUæ¶æ„æ”¯æŒ
        - âœ… **Ganeshæ¸²æŸ“å™¨** - ä¼ ç»ŸOpenGL/Vulkanæ”¯æŒ
        - âœ… **PDFå¯¼å‡º** - å®Œæ•´PDFç”ŸæˆåŠŸèƒ½
        - âœ… **SVGæ”¯æŒ** - SVGæ–‡ä»¶è§£æå’Œæ¸²æŸ“
        - âœ… **SkottieåŠ¨ç”»** - LottieåŠ¨ç”»æ’­æ”¾
        - âœ… **æ–‡æœ¬æ•´å½¢** - å†…ç½®HarfBuzzå¼•æ“
        - âœ… **å­—ä½“ç®¡ç†** - å†…ç½®FreeTypeå¼•æ“
        - âœ… **é¢œè‰²ç®¡ç†** - skcmsæ¨¡å—
        - âœ… **å›¾åƒç¼–è§£ç ** - å¤šç§æ ¼å¼æ”¯æŒ
        
        ## Dawn WebGPUåç«¯
        
        æ¯ä¸ªå¹³å°éƒ½å¯ç”¨äº†ç›¸åº”çš„Dawn WebGPUåç«¯ï¼š
        
        - **Windows**: Direct3D 12 (ä¸»è¦) + Direct3D 11 (å…¼å®¹) + Vulkan
        - **macOS**: Metal (åŸç”Ÿ)
        - **Linux**: Vulkan (ä¸»è¦) + OpenGL (å…¼å®¹)
        - **Android**: Vulkan (ä¸»è¦) + OpenGL ES (å…¼å®¹)
        
        ## æ•…éšœæ’é™¤
        
        ### ç¼–è¯‘é”™è¯¯ï¼š"unknown type name 'requires'"
        - **åŸå› **: ç¼–è¯‘å™¨ä¸æ”¯æŒC++20
        - **è§£å†³**: å‡çº§ç¼–è¯‘å™¨åˆ°æ”¯æŒC++20çš„ç‰ˆæœ¬
        
        ### ç¼–è¯‘é”™è¯¯ï¼š"no member named 'integral' in namespace 'std'"
        - **åŸå› **: æ ‡å‡†åº“ä¸æ”¯æŒC++20 Concepts
        - **è§£å†³**: ç¡®ä¿ä½¿ç”¨ç°ä»£æ ‡å‡†åº“ï¼ˆlibc++æˆ–libstdc++11ï¼‰
        
        ### macOSç¼–è¯‘é”™è¯¯
        - **è§£å†³**: ç¡®ä¿ä½¿ç”¨libc++æ ‡å‡†åº“ï¼š`-stdlib=libc++`
        
        ## ç‰ˆæœ¬ä¿¡æ¯
        
        - æ„å»ºæ¨¡å¼: Release
        - C++æ ‡å‡†: C++20ï¼ˆå¼ºåˆ¶ï¼‰
        - Skiaç‰ˆæœ¬: æœ€æ–°ä¸»åˆ†æ”¯
        - Dawnç‰ˆæœ¬: æœ€æ–°å…¼å®¹ç‰ˆæœ¬
        - æ„å»ºæ—¶é—´: è‡ªåŠ¨æ¯æ—¥æ›´æ–°
        
        ## æ³¨æ„äº‹é¡¹
        
        1. **C++20å¿…éœ€**: è¿™ä¸æ˜¯å¯é€‰çš„ï¼ŒDawn WebGPUç¡¬æ€§è¦æ±‚C++20
        2. **å¹³å°è‡ªåŠ¨æ£€æµ‹**: CMakeä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰å¹³å°å¹¶ä½¿ç”¨ç›¸åº”çš„åº“æ–‡ä»¶
        3. **ç¼–è¯‘å™¨ç‰ˆæœ¬**: ç¡®ä¿ä½¿ç”¨è¶³å¤Ÿæ–°çš„ç¼–è¯‘å™¨ç‰ˆæœ¬
        4. **æ ‡å‡†åº“**: macOSå¿…é¡»ä½¿ç”¨libc++ï¼ŒLinuxæ¨èä½¿ç”¨ç°ä»£libstdc++
        5. **GPUé©±åŠ¨**: ç¡®ä¿å®‰è£…æœ€æ–°çš„GPUé©±åŠ¨ç¨‹åºä»¥è·å¾—æœ€ä½³æ€§èƒ½
        EOF
        
        echo "âœ… ç»Ÿä¸€åŒ…è¯´æ˜æ–‡æ¡£åˆ›å»ºå®Œæˆ"
      
    # åˆ›å»ºæ„å»ºä¿¡æ¯æ–‡ä»¶
    - name: åˆ›å»ºæ„å»ºä¿¡æ¯æ–‡ä»¶
      run: |
        cat > Skia_Prebuilt/Skia/BUILD_INFO.txt << EOF
        Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åº“æ„å»ºä¿¡æ¯ï¼ˆå¼ºåˆ¶C++20ï¼‰
        ===================================================
        
        æ„å»ºæ—¶é—´: $(date -u '+%Y-%m-%d %H:%M:%S UTC')
        æ„å»ºæ¨¡å¼: Release (ç”Ÿäº§çº§ä¼˜åŒ–)
        C++æ ‡å‡†: C++20 (å¼ºåˆ¶ï¼Œæ”¯æŒDawn WebGPU Conceptsç‰¹æ€§)
        
        æ”¯æŒçš„å¹³å°:
        - Windows x64 (Direct3D 12/11 + Vulkan)
        - macOS x64 (Metal)  
        - macOS ARM64 (Metal)
        - Linux x64 (Vulkan + OpenGL)
        - Android x64 (Vulkan + OpenGL ES)
        - Android ARM64 (Vulkan + OpenGL ES)
        
        å¯ç”¨çš„åŠŸèƒ½:
        - Dawn WebGPU è·¨å¹³å°GPU APIï¼ˆéœ€è¦C++20ï¼‰
        - Graphite ç°ä»£æ¸²æŸ“æ¶æ„
        - Ganesh ä¼ ç»Ÿæ¸²æŸ“å™¨
        - PDFå¯¼å‡º (æ”¯æŒå­—ä½“å­é›†)
        - SVGçŸ¢é‡å›¾å½¢
        - SkottieåŠ¨ç”»æ’­æ”¾
        - æ–‡æœ¬æ•´å½¢ (å†…ç½®HarfBuzz)
        - å­—ä½“ç®¡ç† (å†…ç½®FreeType)
        - å›¾åƒç¼–è§£ç 
        - é¢œè‰²ç®¡ç† (skcmsæ¨¡å—)
        
        ç¼–è¯‘å™¨ç‰ˆæœ¬è¦æ±‚:
        - Windows: MSVC 2019 16.11+ æˆ– MSVC 2022
        - macOS: Xcode 13+ (Clang 12+)
        - Linux: GCC 10+ æˆ– Clang 12+
        - Android: NDK r23c+ (Clang 12+)
        
        ç‰¹æ®Šé…ç½®:
        - Windows: ä½¿ç”¨/MDè¿è¡Œæ—¶ + /std:c++20
        - macOS: ä½¿ç”¨libc++æ ‡å‡†åº“ + -std=c++20
        - Linux: GCC-12 + -std=c++20
        - Android: NDK r25c + -std=c++20
        - æ‰€æœ‰å¹³å°: å†…ç½®ä¾èµ–åº“ï¼Œæ— å¤–éƒ¨ä¾èµ–
        - æ‰€æœ‰å¹³å°: é™æ€é“¾æ¥æ„å»º
        - æ‰€æœ‰å¹³å°: å¼ºåˆ¶C++20æ”¯æŒéªŒè¯
        
        ç›®æ ‡æ¥å£:
        - skdn::skdn - ç»Ÿä¸€çš„Skia + Dawnæ¥å£åº“
        - è‡ªåŠ¨å¹³å°æ£€æµ‹å’Œåº“æ–‡ä»¶é€‰æ‹©
        - å®Œæ•´çš„C++20å’ŒCMakeæ”¯æŒ
        - ç¼–è¯‘å™¨ç‰ˆæœ¬æ£€æŸ¥å’ŒéªŒè¯
        
        Dawn WebGPUç‰¹æ€§:
        - ä½¿ç”¨C++20 Conceptsè¿›è¡Œç±»å‹çº¦æŸ
        - æ”¯æŒç°ä»£GPUåŠŸèƒ½
        - è·¨å¹³å°ç»Ÿä¸€API
        - è®¡ç®—ç€è‰²å™¨æ”¯æŒ
        - å¼‚æ­¥GPUæ“ä½œ
        EOF
        
        echo "âœ… æ„å»ºä¿¡æ¯æ–‡ä»¶åˆ›å»ºå®Œæˆ"
      
    # æ‰“åŒ…ä¸ºZIPæ–‡ä»¶
    - name: æ‰“åŒ…Skia_Prebuilt.zip
      run: |
        echo "æ­£åœ¨åˆ›å»ºSkia_Prebuilt.zip..."
        cd Skia_Prebuilt
        zip -r ../Skia_Prebuilt.zip . -q
        cd ..
        
        # éªŒè¯ZIPæ–‡ä»¶
        if [ -f "Skia_Prebuilt.zip" ]; then
          size=$(stat -c%s "Skia_Prebuilt.zip")
          echo "âœ… Skia_Prebuilt.zip åˆ›å»ºæˆåŠŸï¼ˆå¼ºåˆ¶C++20æ”¯æŒï¼‰"
          echo "ğŸ“Š æ–‡ä»¶å¤§å°: $(numfmt --to=iec $size)"
          
          # æ˜¾ç¤ºZIPå†…å®¹æ¦‚è§ˆ
          echo "ğŸ“ ZIPæ–‡ä»¶å†…å®¹æ¦‚è§ˆ:"
          unzip -l Skia_Prebuilt.zip | head -20
          echo "..."
          echo "æ€»è®¡: $(unzip -l Skia_Prebuilt.zip | tail -1)"
        else
          echo "âŒ Skia_Prebuilt.zip åˆ›å»ºå¤±è´¥"
          exit 1
        fi
      
    # ä¸Šä¼ ç»Ÿä¸€åŒ…åˆ°GitHub Actions
    - name: ä¸Šä¼ Skia_Prebuilt.zip
      uses: actions/upload-artifact@v4
      with:
        name: Skia_Prebuilt
        path: Skia_Prebuilt.zip
        retention-days: 30
        compression-level: 0  # ZIPå·²ç»å‹ç¼©è¿‡äº†
        
    # åˆ›å»ºGitHub Releaseï¼ˆä»…åœ¨æ¨é€åˆ°ä¸»åˆ†æ”¯æˆ–å®šæ—¶ä»»åŠ¡æ—¶ï¼‰
    - name: åˆ›å»ºGitHub Release
      if: |
        (github.event_name == 'push' && (github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master')) ||
        github.event_name == 'schedule'
      uses: softprops/action-gh-release@v2
      with:
        tag_name: skia-unified-cpp20-${{ github.run_number }}-${{ github.sha }}
        name: Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…ï¼ˆå¼ºåˆ¶C++20ï¼‰v${{ github.run_number }}
        body: |
          # Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…ï¼ˆå¼ºåˆ¶C++20æ”¯æŒï¼‰
          
          è¿™æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸»æµå¹³å°å’Œæ¶æ„çš„Skiaå›¾å½¢åº“ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…ï¼Œå¯ç”¨äº†Dawn WebGPUåç«¯å’ŒGraphiteæ¸²æŸ“å™¨ï¼Œ**å¼ºåˆ¶ä½¿ç”¨C++20æ ‡å‡†**ã€‚
          
          ## âš ï¸ é‡è¦è¯´æ˜
          
          **æ­¤ç‰ˆæœ¬å¼ºåˆ¶è¦æ±‚C++20æ ‡å‡†æ”¯æŒ**ï¼Œå› ä¸ºDawn WebGPUä½¿ç”¨äº†C++20çš„Conceptsç‰¹æ€§ã€‚æ‰€æœ‰å¹³å°çš„ç¼–è¯‘éƒ½å·²éªŒè¯C++20æ”¯æŒã€‚
          
          ## ğŸ“¦ åŒ…å«å†…å®¹
          
          **Skia_Prebuilt.zip** - ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…ï¼ŒåŒ…å«ï¼š
          
          ### æ”¯æŒçš„å¹³å°ï¼ˆå…¨éƒ¨å¼ºåˆ¶C++20ï¼‰
          - **Windows x64** - Direct3D 12/11 + Vulkan + C++20
          - **macOS x64** - Metal + C++20 + libc++
          - **macOS ARM64** - Metal + C++20 + libc++  
          - **Linux x64** - Vulkan + OpenGL + C++20 + GCC 12
          - **Android x64** - Vulkan + OpenGL ES + C++20 + NDK r25c
          - **Android ARM64** - Vulkan + OpenGL ES + C++20 + NDK r25c
          
          ### ç›®å½•ç»“æ„
          ```
          Skia/
          â”œâ”€â”€ bin/[Platform]/[Arch]/     # å¹³å°ç‰¹å®šçš„å¯æ‰§è¡Œæ–‡ä»¶
          â”œâ”€â”€ lib/[Platform]/[Arch]/     # å¹³å°ç‰¹å®šçš„åº“æ–‡ä»¶  
          â”œâ”€â”€ include/                   # å…±äº«å¤´æ–‡ä»¶
          â”œâ”€â”€ modules/                   # Skiaæ¨¡å—
          â”œâ”€â”€ dawn/                      # Dawn WebGPUå¤´æ–‡ä»¶
          â”œâ”€â”€ examples/                  # ç¤ºä¾‹èµ„æº
          â”œâ”€â”€ CMakeLists.txt             # ç»Ÿä¸€CMakeé…ç½®ï¼ˆå¼ºåˆ¶C++20ï¼‰
          â””â”€â”€ README.md                  # è¯¦ç»†ä½¿ç”¨è¯´æ˜
          ```
          
          ## ğŸ”§ ç¼–è¯‘å™¨ç‰ˆæœ¬è¦æ±‚
          
          ### æœ€ä½ç‰ˆæœ¬è¦æ±‚ï¼ˆå¼ºåˆ¶ï¼‰
          - **Windows**: Visual Studio 2019 16.11+ æˆ– Visual Studio 2022
          - **macOS**: Xcode 13+ (Clang 12+)ï¼Œå¿…é¡»ä½¿ç”¨libc++
          - **Linux**: GCC 10+ æˆ– Clang 12+
          - **Android**: NDK r23c+ (Clang 12+)
          
          ### C++20ç‰¹æ€§éªŒè¯
          æ‰€æœ‰å¹³å°çš„æ„å»ºéƒ½å·²éªŒè¯ä»¥ä¸‹C++20ç‰¹æ€§ï¼š
          - âœ… Concepts (`std::integral`, `requires`å­å¥)
          - âœ… é»˜è®¤æ¯”è¾ƒæ“ä½œç¬¦ (`operator<=>`)
          - âœ… constevalå‡½æ•°
          - âœ… ç°ä»£æ ‡å‡†åº“æ”¯æŒ
          
          ## ğŸš€ å¿«é€Ÿå¼€å§‹
          
          ```cmake
          # è§£å‹Skia_Prebuilt.zipåˆ°ä½ çš„é¡¹ç›®ä¸­
          
          # åœ¨CMakeLists.txtä¸­ï¼ˆå¼ºåˆ¶C++20ï¼‰:
          set(CMAKE_CXX_STANDARD 20)
          set(CMAKE_CXX_STANDARD_REQUIRED ON)
          set(CMAKE_CXX_EXTENSIONS OFF)
          
          # macOSç‰¹æ®Šé…ç½®
          if(APPLE)
              set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -stdlib=libc++")
          endif()
          
          add_subdirectory(path/to/Skia)
          target_link_libraries(your_project skdn::skdn)
          ```
          
          ## âœ¨ ä¸»è¦ç‰¹æ€§
          
          - ğŸŒ **Dawn WebGPU** - ç°ä»£è·¨å¹³å°GPU APIï¼ˆåŸºäºC++20 Conceptsï¼‰
          - ğŸ¨ **Graphite + Ganesh** - åŒæ¸²æŸ“å™¨æ”¯æŒ
          - ğŸ“„ **å®Œæ•´åŠŸèƒ½** - PDFã€SVGã€åŠ¨ç”»ã€æ–‡æœ¬æ•´å½¢
          - ğŸ”§ **è‡ªåŠ¨é…ç½®** - CMakeè‡ªåŠ¨æ£€æµ‹å¹³å°å’Œæ¶æ„
          - ğŸ“¦ **ç»Ÿä¸€åŒ…è£…** - ä¸€ä¸ªåŒ…æ”¯æŒæ‰€æœ‰å¹³å°
          - âš¡ **å¼ºåˆ¶C++20** - ç¡®ä¿Dawn WebGPUæ­£å¸¸å·¥ä½œ
          - ğŸ›¡ï¸ **ç¼–è¯‘å™¨æ£€æŸ¥** - è‡ªåŠ¨éªŒè¯ç¼–è¯‘å™¨ç‰ˆæœ¬
          
          ## ğŸ” Dawn WebGPUåç«¯è¯¦æƒ…
          
          ### Windowså¹³å°
          ```
          åç«¯: Direct3D 12 (ä¸»è¦) + Direct3D 11 (å…¼å®¹) + Vulkan
          ç¼–è¯‘æ ‡å¿—: /std:c++20 /Zc:__cplusplus /MD
          è¿è¡Œæ—¶: å¤šçº¿ç¨‹DLL
          ```
          
          ### macOSå¹³å°
          ```
          åç«¯: Metal (åŸç”Ÿ)
          ç¼–è¯‘æ ‡å¿—: -std=c++20 -stdlib=libc++
          æ ‡å‡†åº“: libc++ (å¼ºåˆ¶)
          ```
          
          ### Linuxå¹³å°
          ```
          åç«¯: Vulkan (ä¸»è¦) + OpenGL (å…¼å®¹)
          ç¼–è¯‘å™¨: GCC 12
          ç¼–è¯‘æ ‡å¿—: -std=c++20
          ```
          
          ### Androidå¹³å°
          ```
          åç«¯: Vulkan (ä¸»è¦) + OpenGL ES (å…¼å®¹)
          NDK: r25c
          ç¼–è¯‘æ ‡å¿—: -std=c++20
          APIçº§åˆ«: 21+
          ```
          
          ## ğŸ› ï¸ æ•…éšœæ’é™¤
          
          ### å¸¸è§ç¼–è¯‘é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ
          
          #### é”™è¯¯: "unknown type name 'requires'"
          ```
          åŸå› : ç¼–è¯‘å™¨ä¸æ”¯æŒC++20
          è§£å†³: å‡çº§åˆ°æ”¯æŒC++20çš„ç¼–è¯‘å™¨ç‰ˆæœ¬
          ```
          
          #### é”™è¯¯: "no member named 'integral' in namespace 'std'"
          ```
          åŸå› : æ ‡å‡†åº“ä¸æ”¯æŒC++20 Concepts
          è§£å†³: macOSä½¿ç”¨-stdlib=libc++ï¼ŒLinuxå‡çº§libstdc++
          ```
          
          #### macOSç‰¹æ®Šé—®é¢˜
          ```
          é—®é¢˜: C++20 Conceptsç¼–è¯‘å¤±è´¥
          è§£å†³: å¿…é¡»ä½¿ç”¨libc++æ ‡å‡†åº“
          é…ç½®: -stdlib=libc++
          ```
          
          ## ğŸ“ ä½¿ç”¨è¯´æ˜
          
          è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œç¤ºä¾‹ä»£ç è¯·æŸ¥çœ‹åŒ…å†…çš„ `README.md` æ–‡ä»¶ã€‚
          
          CMakeä¼šè‡ªåŠ¨æ£€æµ‹ä½ çš„å¹³å°å’Œæ¶æ„ï¼Œå¹¶é“¾æ¥ç›¸åº”çš„åº“æ–‡ä»¶ã€‚åªéœ€è¦ç¡®ä¿ä½¿ç”¨C++20æ ‡å‡†ï¼Œç„¶åä¸€ä¸ªç®€å•çš„ `target_link_libraries(your_target skdn::skdn)` å°±èƒ½ä½¿ç”¨å®Œæ•´çš„Skia + DawnåŠŸèƒ½ã€‚
          
          ## ğŸ”— ç›¸å…³é“¾æ¥
          
          - [Skiaå®˜æ–¹æ–‡æ¡£](https://skia.org/)
          - [Dawn WebGPUé¡¹ç›®](https://dawn.googlesource.com/dawn)
          - [C++20æ ‡å‡†å‚è€ƒ](https://en.cppreference.com/w/cpp/20)
          
          ## ğŸ“Š æ„å»ºç»Ÿè®¡
          
          - æ„å»ºæ—¶é—´: çº¦2-3å°æ—¶ï¼ˆ6ä¸ªå¹³å°å¹¶è¡Œï¼‰
          - åŒ…å¤§å°: é¢„è®¡500MB-1GB
          - åº“æ–‡ä»¶æ€»æ•°: æ•°ç™¾ä¸ªé™æ€åº“å’ŒåŠ¨æ€åº“
          - å¤´æ–‡ä»¶æ•°é‡: æ•°åƒä¸ªC++å¤´æ–‡ä»¶
          - æ”¯æŒçš„æ¶æ„: x64 + ARM64
          - Dawn WebGPUéªŒè¯: å…¨å¹³å°C++20 Conceptsæµ‹è¯•é€šè¿‡
        files: Skia_Prebuilt.zip
        draft: false
        prerelease: false
        make_latest: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    # æ„å»ºå®Œæˆé€šçŸ¥
    - name: æ„å»ºå®Œæˆé€šçŸ¥
      run: |
        echo "ğŸ‰ Skia Dawn WebGPU ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…æ„å»ºå®Œæˆï¼ˆå¼ºåˆ¶C++20æ”¯æŒï¼‰ï¼"
        echo ""
        echo "ğŸ“¦ ç”Ÿæˆçš„æ–‡ä»¶:"
        echo "  â€¢ Skia_Prebuilt.zip - ç»Ÿä¸€é¢„ç¼–è¯‘åŒ…ï¼ˆå¼ºåˆ¶C++20ï¼‰"
        echo ""
        echo "ğŸ—ï¸ åŒ…å«çš„å¹³å°å’Œæ¶æ„:"
        echo "  â€¢ Windows: x64 (Direct3D + Vulkan + C++20)"
        echo "  â€¢ macOS: x64, ARM64 (Metal + C++20 + libc++)"  
        echo "  â€¢ Linux: x64 (Vulkan + OpenGL + C++20 + GCC12)"
        echo "  â€¢ Android: x64, ARM64 (Vulkan + OpenGL ES + C++20 + NDK r25c)"
        echo ""
        echo "âš™ï¸ ç‰¹æ€§:"
        echo "  â€¢ skdn::skdn ç»Ÿä¸€æ¥å£åº“"
        echo "  â€¢ è‡ªåŠ¨å¹³å°æ£€æµ‹å’Œåº“é€‰æ‹©"
        echo "  â€¢ Dawn WebGPU + Graphite ç°ä»£æ¸²æŸ“"
        echo "  â€¢ å®Œæ•´SkiaåŠŸèƒ½æ”¯æŒ"
        echo "  â€¢ å¼ºåˆ¶C++20æ ‡å‡†æ”¯æŒå’ŒéªŒè¯"
        echo "  â€¢ ç¼–è¯‘å™¨ç‰ˆæœ¬è‡ªåŠ¨æ£€æŸ¥"
        echo "  â€¢ CMakeå³æ’å³ç”¨é…ç½®"
        echo ""
        echo "ğŸ”§ C++20æ”¯æŒéªŒè¯:"
        echo "  â€¢ Windows: /std:c++20 + /Zc:__cplusplus"
        echo "  â€¢ macOS: -std=c++20 + -stdlib=libc++"
        echo "  â€¢ Linux: -std=c++20 + GCC 12"
        echo "  â€¢ Android: -std=c++20 + NDK r25c"
        echo ""
        echo "ğŸ“‹ ä½¿ç”¨è¦æ±‚:"
        echo "  â€¢ ç¼–è¯‘å™¨å¿…é¡»æ”¯æŒC++20 Conceptsç‰¹æ€§"
        echo "  â€¢ macOSå¿…é¡»ä½¿ç”¨libc++æ ‡å‡†åº“"
        echo "  â€¢ Windowséœ€è¦Visual Studio 2019 16.11+æˆ–VS 2022"
        echo "  â€¢ Linuxéœ€è¦GCC 10+æˆ–Clang 12+"
        echo "  â€¢ Androidéœ€è¦NDK r23c+ï¼ˆå®é™…ä½¿ç”¨r25cï¼‰"
        echo ""
        echo "ğŸ”— å¯åœ¨Actionsé¡µé¢ä¸‹è½½ï¼Œæˆ–åœ¨Releasesä¸­è·å–"
        echo "ğŸ“‹ è¯¦ç»†ä½¿ç”¨æ–¹æ³•è¯·æŸ¥çœ‹åŒ…å†…README.mdæ–‡ä»¶"
        echo ""
        echo "âš ï¸  é‡è¦æé†’:"
        echo "   æ­¤ç‰ˆæœ¬å¼ºåˆ¶è¦æ±‚C++20æ”¯æŒï¼ŒDawn WebGPUæ— æ³•åœ¨æ—§ç¼–è¯‘å™¨ä¸Šå·¥ä½œ"
        echo "   æ‰€æœ‰å¹³å°çš„ç¼–è¯‘éƒ½å·²éªŒè¯C++20 Conceptsç‰¹æ€§æ­£å¸¸å·¥ä½œ"
        echo "   å¦‚é‡åˆ°ç¼–è¯‘é—®é¢˜ï¼Œè¯·é¦–å…ˆæ£€æŸ¥ç¼–è¯‘å™¨ç‰ˆæœ¬å’ŒC++20æ”¯æŒ"
